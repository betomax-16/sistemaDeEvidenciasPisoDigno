if (self.CavalryLogger) { CavalryLogger.start_js(["85t2c"]); }

__d("PhotosUploadWaterfallErrorCodes",[],(function a(b,c,d,e,f,g){f.exports={SECURITY:1,FILE_IO:2,IMAGE_IO:3,UPLOAD_IO:4,INVALID_SERVER_RESULT:5,RESIZE_FAILURE:6,ENCODE_FAILURE:7,INVALID_DOMAIN:8,BAD_JPEG_MARKERS:9,BAD_SERVER_RESPONSE:10,EXTERNAL_INTERFACE_UNAVAILABLE:11,JS_CALL_FAILED:12,UNCAUGHT_ERROR:13,UPLOAD_SWF_FAILED_LOAD:14,FILE_IO_TIMEOUT:15,IMAGE_SECURITY:16,BAD_IMAGE_FILE:17,IMAGE_IO_TIMEOUT:18,BLACK_PHOTO:19,EMPTY_FILE_LOADED:20,FILE_READ_DISABLED:21,BAD_NETWORK:22,FLASH_LOAD_TIMEOUT:23,FLASH_LOAD_FAILURE:24,FLASH_UPGRADE_REQUIRED:25,SPHERICAL_CHECK_FAILED:26,SPHERICAL_CHECK_TIMEOUT:27};}),null);
__d('BandicootSession',[],(function a(b,c,d,e,f,g){'use strict';var h={ACTIVE:'ACTIVE',INACTIVE:'INACTIVE',CLOSED:'CLOSED'},i=10*60*1000,j=14*24*60*60*1000;function k(p){return Date.now()-p.lastUpdated;}function l(p){return !!(typeof p==='object'&&p&&p.lastUpdated&&p.status);}function m(p){if(p.status===h.CLOSED){return false;}else if(p.status===h.INACTIVE&&k(p)>i)return false;return true;}function n(p){return (p.status===h.ACTIVE&&k(p)>i);}function o(p){return (k(p)>j);}f.exports={Status:h,isValidSession:l,isTrackedSession:m,isOrphanSession:o,isCrashedSession:n};}),null);
__d('Bandicoot',['invariant','BandicootSession'],(function a(b,c,d,e,f,g,h){'use strict';var i=5*1000,j=i*2,k='Bandicoot:',l=c('BandicootSession').Status,m=c('BandicootSession').isValidSession,n=c('BandicootSession').isTrackedSession,o=c('BandicootSession').isCrashedSession,p=c('BandicootSession').isOrphanSession;function q(){try{var u=window.localStorage;if(u){var v='__test'+Date.now();u.setItem(v,'');u.removeItem(v);}return u;}catch(t){return null;}}var r=q();function s(t){'use strict';this.$Bandicoot5=k+t;this.$Bandicoot4={};this.$Bandicoot1=this.$Bandicoot7.bind(this);this.sessionID=null;this.sessionStartTime=null;this.storage=r;}s.prototype.getCrashTimeData=function(){'use strict';var t=window.performance&&window.performance.memory||{},u=this.sessionStartTime;return {duration:u?Date.now()-u:0,tabs:Object.keys(this.$Bandicoot8()).length,jsHeapSizeLimit:t.jsHeapSizeLimit,totalJSHeapSize:t.totalJSHeapSize,usedJSHeapSize:t.usedJSHeapSize,elementsInDOM:document.getElementsByTagName('*').length,uri:window.location.href};};s.prototype.getLogTimeData=function(){'use strict';return {userAgent:window.navigator.userAgent};};s.prototype.logCrash=function(t,u,v){'use strict';var w=Object.assign({sessionID:t},u,v);};s.prototype.logBrowserUnsupported=function(){'use strict';};s.prototype.logTrackingError=function(){'use strict';};s.prototype.startSession=function(){'use strict';if(!this.storage){this.logBrowserUnsupported();return;}if(this.$Bandicoot2)return;if(!this.sessionID)this.sessionID=Math.random().toString(36).slice(2,9);if(!this.sessionStartTime)this.sessionStartTime=Date.now();this.$Bandicoot2=setInterval(function(){this.$Bandicoot9();}.bind(this),i);this.$Bandicoot9();if(document.addEventListener)document.addEventListener('visibilitychange',this.$Bandicoot1);this.$Bandicoot10();};s.prototype.endSession=function(){'use strict';if(!this.storage)return;if(!this.$Bandicoot2)return;clearInterval(this.$Bandicoot2);this.$Bandicoot2=null;if(!this.$Bandicoot3)this.$Bandicoot11({status:l.CLOSED});this.sessionID=null;this.sessionStartTime=null;if(document.removeEventListener)document.removeEventListener('visibilitychange',this.$Bandicoot1);};s.prototype.logKnownCrashes=function(){'use strict';if(!this.storage)return;if(!this.$Bandicoot2){var t=this.$Bandicoot8();t=this.$Bandicoot12(t,function(u,v){if(o(u)){this.logCrash(v,u,this.getLogTimeData());return null;}else return u;}.bind(this));this.$Bandicoot13(t);}};s.prototype.$Bandicoot14=function(){'use strict';var t=this.sessionID;t||h(0);return t;};s.prototype.$Bandicoot9=function(){'use strict';var t=this.$Bandicoot8();this.$Bandicoot15(t);t=this.$Bandicoot16(t);this.$Bandicoot13(t);};s.prototype.$Bandicoot15=function(t){'use strict';var u=this.$Bandicoot14(),v=t[u]?t[u]:{};t[u]=babelHelpers['extends']({},v,this.getCrashTimeData(),{lastUpdated:Date.now(),status:this.$Bandicoot17()});};s.prototype.$Bandicoot12=function(t,u){'use strict';var v={};Object.keys(t).forEach(function(w){var x=t[w];if(m(x)&&n(x)&&!p(x)){var y=u(x,w);if(y)v[w]=y;}});return v;};s.prototype.$Bandicoot16=function(t){'use strict';return this.$Bandicoot12(t,function(u,v){if(o(u)){var w=u.loggerReportTime||0;if(Date.now()-w>j){u.loggerReportTime=Date.now();u.loggerReportSession=this.$Bandicoot14();}else if(u.loggerReportSession==this.$Bandicoot14()){this.logCrash(v,u,this.getLogTimeData());this.$Bandicoot4[v]=true;return null;}}return u;}.bind(this));};s.prototype.$Bandicoot8=function(t){'use strict';t=t||this.$Bandicoot5;var u=this.storage.getItem(t)||'{}';try{u=JSON.parse(u);}catch(v){u={};this.storage.removeItem(t);}return u;};s.prototype.$Bandicoot11=function(t){'use strict';t.lastUpdated=Date.now();var u=this.$Bandicoot8(),v=this.sessionID;if(v&&u[v]){Object.assign(u[v],t);this.$Bandicoot13(u);}};s.prototype.$Bandicoot13=function(t){'use strict';var u=JSON.stringify(t);try{this.storage.setItem(this.$Bandicoot5,u);}catch(v){var w=this.$Bandicoot6,x=Date.now();if(!w||x>w+i){this.logTrackingError();this.$Bandicoot6=x;}try{this.storage.removeItem(this.$Bandicoot5);}catch(y){this.$Bandicoot3=true;this.endSession();}}};s.prototype.$Bandicoot10=function(){'use strict';for(var t=0;t<this.storage.length;++t){var u=this.storage.key(t);if(u.indexOf(k)===0&&u!==this.$Bandicoot5){var v=this.$Bandicoot8(u),w=Object.keys(v).every(function(x){var y=v[x];return !m(y)||p(y);});if(w)this.storage.removeItem(u);}}};s.prototype.$Bandicoot7=function(){'use strict';this.$Bandicoot11({status:this.$Bandicoot17()});};s.prototype.$Bandicoot17=function(){'use strict';return document.hidden?l.INACTIVE:l.ACTIVE;};f.exports=s;}),null);
__d('XUIDialogHeader.react',['cx','fbt','React','XUICardHeader.react','XUICloseButton.react','joinClasses'],(function a(b,c,d,e,f,g,h,i){var j,k,l=c('React').PropTypes;j=babelHelpers.inherits(m,c('React').Component);k=j&&j.prototype;m.prototype.render=function(){'use strict';var n=null;if(this.props.showCloseButton)n=c('React').createElement(c('XUICloseButton.react'),{label:this.props.closeButtonText,className:"layerCancel _51-t"});return (c('React').createElement(c('XUICardHeader.react'),babelHelpers['extends']({},this.props,{className:c('joinClasses')(this.props.className,"_4-i0"),link:n,type:'primary'}),this.props.children));};function m(){'use strict';j.apply(this,arguments);}m.propTypes={closeButtonText:l.string,showCloseButton:l.bool,activeTabKey:l.string,defaultActiveTabKey:l.string,onTabClick:l.func};m.defaultProps={closeButtonText:i._("Cerrar"),onTabClick:function n(){return true;},showCloseButton:true};f.exports=m;}),null);
__d('FileHasher',['WebWorker','fileSliceName','emptyFunction','FileHashWorkerResource'],(function a(b,c,d,e,f,g){h.isSupported=function(){'use strict';return c('WebWorker').isSupported();};function h(){'use strict';var i=c('FileHashWorkerResource');c('WebWorker').prepareResource(i);this.$FileHasher1=new (c('WebWorker'))(i).setMessageHandler(function(j){this.$FileHasher2(j);}.bind(this)).execute();}h.prototype.hash=function(i,j){'use strict';this.$FileHasher2=j;this.$FileHasher1.postMessage({file:i,fileSliceName:c('fileSliceName')});return this;};h.prototype.destroy=function(){'use strict';this.$FileHasher2=c('emptyFunction');this.$FileHasher1.terminate();};f.exports=h;}),null);
__d('PhotoEditorSaveStates',['requireWeak','Map'],(function a(b,c,d,e,f,g){var h;c('requireWeak')('PhotoEditorGraphic',function(l){h=l.Sticker;});var i=new (c('Map'))(),j=new (c('Map'))(),k={setState:function l(m,n){i.set(m,n);},getState:function l(m){return i.get(m);},setLoggingData:function l(m,n){j.set(m,n);},getLoggingData:function l(m){return j.get(m);},getTotalNumOfStickersOnPhoto:function l(m){if(i.get(m))return i.get(m).graphics.filter(function(n){return h&&n.type===h;}).length;return 0;}};f.exports=k;}),null);
__d('ReactComposerPhotoActions',['ReactComposerPhotoActionType','ReactComposerDispatcher','ReactComposerPhotoStore'],(function a(b,c,d,e,f,g){c('ReactComposerPhotoStore');var h={startRecognizing:function i(j,k){c('ReactComposerDispatcher').dispatch({composerID:j,photoID:k,type:c('ReactComposerPhotoActionType').PHOTO_RECOGNITION_STARTED});},finishRecognizingPhoto:function i(j,k){c('ReactComposerDispatcher').dispatch({composerID:j,type:c('ReactComposerPhotoActionType').PHOTO_RECOGNITION_FINISHED,photoID:k});},finishRecognizing:function i(j,k,l){c('ReactComposerDispatcher').dispatch({composerID:j,type:c('ReactComposerPhotoActionType').PHOTO_RECOGNITION_ALL_FINISHED,photos:k,facerecWaterfallEvent:l});},addFacebox:function i(j,k,l){c('ReactComposerDispatcher').dispatch({composerID:j,type:c('ReactComposerPhotoActionType').PHOTO_ADD_FACEBOX,photoID:k,facebox:l});},tagXY:function i(j,k,l,m,n,o,p){c('ReactComposerDispatcher').dispatch({composerID:j,type:c('ReactComposerPhotoActionType').PHOTO_TAG_XY,value:l,photoID:k,source:m,subject:n,x:o,y:p});},tagXYProduct:function i(j,k,l,m,n,o,p){c('ReactComposerDispatcher').dispatch({composerID:j,type:c('ReactComposerPhotoActionType').PHOTO_TAG_XY_PRODUCT,value:l,photoID:k,source:m,subject:n,x:o,y:p});},tagFacebox:function i(j,k,l,m,n){c('ReactComposerDispatcher').dispatch({composerID:j,type:c('ReactComposerPhotoActionType').PHOTO_TAG_FACEBOX,photoID:k,faceboxID:l,subjectID:m,value:n});},untagFacebox:function i(j,k,l,m){c('ReactComposerDispatcher').dispatch({composerID:j,type:c('ReactComposerPhotoActionType').PHOTO_UNTAG_FACEBOX,photoID:k,faceboxID:l,subjectID:m});},removePhoto:function i(j,k,l){c('ReactComposerDispatcher').dispatch({composerID:j,type:c('ReactComposerPhotoActionType').PHOTO_REMOVE,photoID:k,uploadID:l});},untagSubjectFromAllPhotos:function i(j,k){c('ReactComposerDispatcher').dispatch({composerID:j,type:c('ReactComposerPhotoActionType').PHOTO_UNTAG_SUBJECT_FROM_ALL_PHOTOS,subjectID:k});},untagAllForPhoto:function i(j,k){c('ReactComposerDispatcher').dispatch({composerID:j,type:c('ReactComposerPhotoActionType').PHOTO_UNTAG_ALL,photoID:k});},startPhotoEdit:function i(j,k){c('ReactComposerDispatcher').dispatch({composerID:j,photoID:k,type:c('ReactComposerPhotoActionType').PHOTO_EDIT_STARTED});},finishPhotoEdit:function i(j){c('ReactComposerDispatcher').dispatch({composerID:j,type:c('ReactComposerPhotoActionType').PHOTO_EDIT_FINISHED});},setPhotoBeingTagged:function i(j,k){c('ReactComposerDispatcher').dispatch({composerID:j,photoID:k,type:c('ReactComposerPhotoActionType').PHOTO_SET_BEING_TAGGED});},finishLoadingPhotoEdit:function i(j,k){c('ReactComposerDispatcher').dispatch({composerID:j,type:c('ReactComposerPhotoActionType').PHOTO_LOADING_EDIT_FINISHED,photoID:k});},changeSphericalPhotoUpdateStatus:function i(j,k){c('ReactComposerDispatcher').dispatch({composerID:j,type:c('ReactComposerPhotoActionType').PHOTO_SPHERICAL_UPDATING,isSphericalPhotoUpdating:k});}};f.exports=h;}),null);
__d('ReactComposerPhotoUploadState',[],(function a(b,c,d,e,f,g){f.exports={PHOTO_UPLOAD_ENQUEUED:'PHOTO_UPLOAD_ENQUEUED',PHOTO_UPLOAD_RESIZE_STARTED:'PHOTO_UPLOAD_RESIZE_STARTED',PHOTO_UPLOAD_RESIZE_DONE:'PHOTO_UPLOAD_RESIZE_DONE',PHOTO_UPLOAD_RESIZE_FAILED:'PHOTO_UPLOAD_RESIZE_FAILED',PHOTO_UPLOAD_UPLOADING:'PHOTO_UPLOAD_UPLOADING',PHOTO_UPLOAD_DONE:'PHOTO_UPLOAD_DONE',PHOTO_UPLOAD_FAILED:'PHOTO_UPLOAD_FAILED'};}),null);
__d('ReactComposerMediaUploadActions',['ReactComposerDispatcher','ReactComposerMediaUploadType','ReactComposerMediaPrefillConfig','ReactComposerPhotoActions','ReactComposerPhotoUploadState','ReactComposerMediaUploadActionType','immutable','ReactComposerMediaUploadStore','ReactComposerPhotoStore'],(function a(b,c,d,e,f,g){c('ReactComposerMediaUploadStore');c('ReactComposerPhotoStore');var h={enqueue:function i(j,k,l,m,n,o,p){var q=arguments.length<=7||arguments[7]===undefined?[]:arguments[7],r=arguments.length<=8||arguments[8]===undefined?false:arguments[8];c('ReactComposerDispatcher').dispatch({composerID:j,mediaType:o,uploadID:k,type:n,filename:l,fileURL:p?p:'',index:m,xyTags:q,isSpherical:r});},startResizing:function i(j,k,l){c('ReactComposerDispatcher').dispatch({composerID:j,loggingData:l,uploadID:k,type:c('ReactComposerMediaUploadActionType').PHOTO_UPLOAD_RESIZE_STARTED});},progressResizing:function i(j,k,l){c('ReactComposerDispatcher').dispatch({composerID:j,uploadID:k,type:c('ReactComposerMediaUploadActionType').PHOTO_UPLOAD_RESIZE_PROGRESS,progress:l});},doneResizing:function i(j,k,l){c('ReactComposerDispatcher').dispatch({composerID:j,loggingData:l,uploadID:k,type:c('ReactComposerMediaUploadActionType').PHOTO_UPLOAD_RESIZE_DONE});},failResizing:function i(j,k,l){c('ReactComposerDispatcher').dispatch({composerID:j,loggingData:l,uploadID:k,type:c('ReactComposerMediaUploadActionType').PHOTO_UPLOAD_RESIZE_FAILED});},doneSphericalCheck:function i(j,k,l){var m=arguments.length<=3||arguments[3]===undefined?false:arguments[3];c('ReactComposerDispatcher').dispatch({composerID:j,loggingData:l,uploadID:k,type:c('ReactComposerMediaUploadActionType').SPHERICAL_PHOTO_CHECK_DONE,isExperimental:m});},failSphericalCheck:function i(j,k,l){var m=arguments.length<=3||arguments[3]===undefined?false:arguments[3];c('ReactComposerDispatcher').dispatch({composerID:j,loggingData:l,uploadID:k,type:c('ReactComposerMediaUploadActionType').SPHERICAL_PHOTO_CHECK_FAILED,isExperimental:m});},startUploading:function i(j,k,l,m){c('ReactComposerDispatcher').dispatch({composerID:j,uploadID:k,type:m,fileUpload:l});},progressUploading:function i(j,k,l){c('ReactComposerDispatcher').dispatch({composerID:j,uploadID:k,type:c('ReactComposerMediaUploadActionType').MEDIA_UPLOAD_PROGRESS,progress:l});},isSpherical:function i(j,k,l,m){c('ReactComposerDispatcher').dispatch({composerID:j,uploadID:k,type:c('ReactComposerMediaUploadActionType').PHOTO_UPLOAD_IS_SPHERICAL,isSpherical:l,projectionType:m});},doneUploading:function i(j,k,l,m,n,o,p,q,r,s,t,u,v,w){c('ReactComposerDispatcher').dispatch({composerID:j,uploadID:k,fileUpload:m,mediaLocation:s,timeToUpload:n,type:l,photoID:o,sphericalPhotoID:p,thumbSrc:q,originalPhotoID:r,cubestripURI:t,imageSrc:u,width:v,height:w});},doneUploadingExtra:function i(j,k,l,m,n,o,p,q){c('ReactComposerDispatcher').dispatch({type:c('ReactComposerMediaUploadActionType').PHOTO_UPLOAD_EXTRA_DONE,composerID:j,uploadID:k,photoID:l,thumbSrc:m,cubestripURI:n,imageSrc:o,width:p,height:q});},failUploading:function i(j,k,l,m,n,o){c('ReactComposerDispatcher').dispatch({composerID:j,uploadID:k,type:o,error:n,fileUpload:l,timeToUpload:m});},removeAllPhotoUploads:function i(j,k){k.forEach(function(l){return this.removePhotoAndPhotoUpload(j,l);}.bind(this));},removePhotoAndPhotoUpload:function i(j,k){if(k.state===c('ReactComposerPhotoUploadState').PHOTO_UPLOAD_DONE){c('ReactComposerPhotoActions').removePhoto(j,k.photoID,k.id);}else this.removeMediaUpload(j,k.id);},removeMediaUpload:function i(j,k){c('ReactComposerDispatcher').dispatch({composerID:j,type:c('ReactComposerMediaUploadActionType').MEDIA_UPLOAD_REMOVE,uploadID:k});},mediaMoved:function i(j,k,l){c('ReactComposerDispatcher').dispatch({composerID:j,type:c('ReactComposerMediaUploadActionType').MEDIA_UPLOAD_MOVED,from:k,to:l});},resizerUnavailable:function i(j){c('ReactComposerDispatcher').dispatch({composerID:j,type:c('ReactComposerMediaUploadActionType').PHOTO_UPLOAD_RESIZER_UNAVAILABLE});},photosSelect:function i(j,k,l){c('ReactComposerDispatcher').dispatch({composerID:j,method:l,numPhotos:k,type:c('ReactComposerMediaUploadActionType').PHOTOS_SELECT});},retryMediaUpload:function i(j,k){c('ReactComposerDispatcher').dispatch({composerID:j,type:k});},reorderMedias:function i(j,k){c('ReactComposerDispatcher').dispatch({composerID:j,mediaIDs:k,type:c('ReactComposerMediaUploadActionType').REORDER_MEDIAS});},prefillMedias:function i(j,k){c('ReactComposerDispatcher').dispatch({composerID:j,medias:k,type:c('ReactComposerMediaUploadActionType').PREFILL_MEDIAS});},setVideoThumbnail:function i(j,k,l){c('ReactComposerDispatcher').dispatch({composerID:j,type:c('ReactComposerMediaUploadActionType').VIDEO_SET_THUMBNAIL,thumbSrc:l,uploadID:k});},addPhotoUpload:function i(j,k,l,m){c('ReactComposerDispatcher').dispatch({type:c('ReactComposerMediaUploadActionType').PHOTO_ADD_UPLOAD,composerID:j,index:k,photo:m,upload:l});}};f.exports=h;}),null);
__d('ReactComposerPhotoUpload',['immutable'],(function a(b,c,d,e,f,g){f.exports=c('immutable').Record({id:null,error:{},filename:null,fileSize:null,fileUpload:null,fileURL:null,flatPhotoID:null,photoID:null,sphericalPhotoID:null,originalPhotoID:null,progress:null,state:null,xyTags:[],mediaType:null,isSpherical:false,projectionType:null,canShowSphericalSingletonNux:false,thumbSrc:null,width:null,height:null});}),null);
__d('ReactComposerMediaUploadStore',['invariant','ReactComposerAttachmentStore','ReactComposerAttachmentType','ReactComposerDispatcher','ReactComposerMediaUploadType','ReactComposerStoreBase','ReactComposerMediaUploadActionType','ReactComposerPhotoUploadState','ReactComposerPhotoActionType','ReactComposerPhotoStore','ReactComposerPhotoUpload','ReactComposerVideoXUploader','immutable','PhotoEditorSaveStates','SphericalPhotoConfig'],(function a(b,c,d,e,f,g,h){var i,j;i=babelHelpers.inherits(k,c('ReactComposerStoreBase'));j=i&&i.prototype;function k(){'use strict';var l;j.constructor.call(this,function(){return {removedIDs:c('immutable').Set(),uploads:c('immutable').List(),uploadsByID:c('immutable').Map(),videoUploader:null};},function(m){if(l&&l.$ReactComposerMediaUploadStore1(m))return;switch(m.type){case c('ReactComposerMediaUploadActionType').PHOTO_UPLOAD_ENQUEUED:case c('ReactComposerMediaUploadActionType').VIDEO_UPLOAD_ENQUEUED:l&&l.$ReactComposerMediaUploadStore2(m);break;case c('ReactComposerMediaUploadActionType').PHOTO_UPLOAD_RESIZE_STARTED:l&&l.$ReactComposerMediaUploadStore3(m);break;case c('ReactComposerMediaUploadActionType').PHOTO_UPLOAD_RESIZE_PROGRESS:l&&l.$ReactComposerMediaUploadStore4(m);break;case c('ReactComposerMediaUploadActionType').PHOTO_UPLOAD_RESIZE_DONE:l&&l.$ReactComposerMediaUploadStore5(m,c('ReactComposerPhotoUploadState').PHOTO_UPLOAD_RESIZE_DONE);break;case c('ReactComposerMediaUploadActionType').PHOTO_UPLOAD_RESIZE_FAILED:l&&l.$ReactComposerMediaUploadStore5(m,c('ReactComposerPhotoUploadState').PHOTO_UPLOAD_RESIZE_FAILED);break;case c('ReactComposerMediaUploadActionType').PHOTO_UPLOAD_UPLOADING:case c('ReactComposerMediaUploadActionType').VIDEO_UPLOAD_UPLOADING:l&&l.$ReactComposerMediaUploadStore6(m);break;case c('ReactComposerMediaUploadActionType').PHOTO_UPLOAD_IS_SPHERICAL:l&&l.$ReactComposerMediaUploadStore7(m);break;case c('ReactComposerMediaUploadActionType').VIDEO_SET_THUMBNAIL:l&&l.$ReactComposerMediaUploadStore8(m);break;case c('ReactComposerMediaUploadActionType').MEDIA_UPLOAD_PROGRESS:l&&l.$ReactComposerMediaUploadStore4(m);break;case c('ReactComposerMediaUploadActionType').PHOTO_UPLOAD_DONE:case c('ReactComposerMediaUploadActionType').VIDEO_UPLOAD_DONE:c('ReactComposerDispatcher').waitFor([c('ReactComposerPhotoStore').getDispatchToken()]);l&&l.$ReactComposerMediaUploadStore9(m);break;case c('ReactComposerMediaUploadActionType').PHOTO_UPLOAD_EXTRA_DONE:c('ReactComposerDispatcher').waitFor([c('ReactComposerPhotoStore').getDispatchToken()]);l&&l.$ReactComposerMediaUploadStore10(m);break;case c('ReactComposerMediaUploadActionType').PHOTO_UPLOAD_FAILED:case c('ReactComposerMediaUploadActionType').VIDEO_UPLOAD_FAILED:l&&l.$ReactComposerMediaUploadStore11(m);break;case c('ReactComposerMediaUploadActionType').MEDIA_UPLOAD_REMOVE:case c('ReactComposerPhotoActionType').PHOTO_REMOVE:l&&l.$ReactComposerMediaUploadStore12(m);break;case c('ReactComposerMediaUploadActionType').MEDIA_UPLOAD_MOVED:l&&l.$ReactComposerMediaUploadStore13(m);break;case c('ReactComposerMediaUploadActionType').PREFILL_MEDIAS:l&&l.$ReactComposerMediaUploadStore14(m);break;case c('ReactComposerMediaUploadActionType').REORDER_MEDIAS:l&&l.$ReactComposerMediaUploadStore15(m);break;case c('ReactComposerMediaUploadActionType').PHOTO_ADD_UPLOAD:l&&l.$ReactComposerMediaUploadStore16(m);break;default:}});l=this;}k.prototype.getMediaUploadExists=function(l,m){'use strict';var n=this.getComposerData(l);return n.uploadsByID.get(m)!==undefined;};k.prototype.getMediaUpload=function(l,m){'use strict';return this.$ReactComposerMediaUploadStore17(this.getComposerData(l),m);};k.prototype.getUploadIndex=function(l,m){'use strict';return this.$ReactComposerMediaUploadStore18(this.getComposerData(l),m);};k.prototype.getUploads=function(l){'use strict';return this.getComposerData(l).uploads;};k.prototype.getUploadsOfType=function(l,m){'use strict';var n=this.getComposerData(l).uploads.filter(function(o){return (o.mediaType===m);});return n;};k.prototype.getUploadsCount=function(l,m){'use strict';if(!m)return this.getComposerData(l).uploads.size;return this.getComposerData(l).uploads.filter(function(n){return n.mediaType===m;}).size;};k.prototype.getSphericalPhotoCount=function(l){'use strict';return this.getUploadsOfType(l,c('ReactComposerMediaUploadType').PHOTO).filter(function(m){return (m.isSpherical);}).size;};k.prototype.getNonsphericalPhotoCount=function(l){'use strict';return this.getUploadsOfType(l,c('ReactComposerMediaUploadType').PHOTO).filter(function(m){return (!m.isSpherical);}).size;};k.prototype.getHasUploadBeenRemoved=function(l,m){'use strict';var n=this.getComposerData(l);return n.removedIDs.has(m);};k.prototype.isUploading=function(l){'use strict';return this.getComposerData(l).uploads.some(function(m){return (m.state!==c('ReactComposerPhotoUploadState').PHOTO_UPLOAD_RESIZE_FAILED&&m.state!==c('ReactComposerPhotoUploadState').PHOTO_UPLOAD_DONE&&m.state!==c('ReactComposerPhotoUploadState').PHOTO_UPLOAD_FAILED);});};k.prototype.getTotalNumberOfStickersOnPhotos=function(l){'use strict';var m=0;this.getComposerData(l).uploads.forEach(function(n){var o=n.get('originalPhotoID');if(o)m+=c('PhotoEditorSaveStates').getTotalNumOfStickersOnPhoto(o);});return m;};k.prototype.getVideoUploader=function(l,m){'use strict';var n=this.getComposerData(l);if(!n.videoUploader){var o=new (c('ReactComposerVideoXUploader'))({composerID:l,uploaderParams:m});n.videoUploader=o;}return n.videoUploader;};k.prototype.$ReactComposerMediaUploadStore2=function(l){'use strict';var m=this.validateAction(l,['composerID','mediaType','uploadID','filename','fileURL','index','xyTags','isSpherical']),n=m[0],o=m[1],p=m[2],q=m[3],r=m[4],s=m[5],t=m[6],u=m[7];this.$ReactComposerMediaUploadStore19(n,s,new (c('ReactComposerPhotoUpload'))({id:p,mediaType:o,state:c('ReactComposerPhotoUploadState').PHOTO_UPLOAD_ENQUEUED,filename:q,fileURL:r,xyTags:t,isSpherical:u}));this.emitChange(n);};k.prototype.$ReactComposerMediaUploadStore3=function(l){'use strict';var m=this.validateAction(l,['composerID','uploadID']),n=m[0],o=m[1],p=this.getComposerData(n);this.$ReactComposerMediaUploadStore20(p,o,function(q){return q.withMutations(function(r){return r.set('state',c('ReactComposerPhotoUploadState').PHOTO_UPLOAD_RESIZE_STARTED).set('progress',0);});});this.emitChange(n);};k.prototype.$ReactComposerMediaUploadStore6=function(l){'use strict';var m=this.validateAction(l,['composerID','uploadID','fileUpload']),n=m[0],o=m[1],p=m[2],q=this.getComposerData(n),r=p&&p.getFile&&p.getFile().size;this.$ReactComposerMediaUploadStore20(q,o,function(s){return s.withMutations(function(t){return t.set('state',c('ReactComposerPhotoUploadState').PHOTO_UPLOAD_UPLOADING).set('progress',0).set('fileUpload',p).set('fileSize',r||null);});});this.emitChange(n);};k.prototype.$ReactComposerMediaUploadStore4=function(l){'use strict';var m=this.validateAction(l,['composerID','uploadID','progress']),n=m[0],o=m[1],p=m[2],q=this.getComposerData(n);this.$ReactComposerMediaUploadStore20(q,o,function(r){return r.set('progress',p);});this.emitChange(n);};k.prototype.$ReactComposerMediaUploadStore9=function(l){'use strict';var m=this.validateAction(l,['composerID','uploadID','photoID']),n=m[0],o=m[1],p=m[2],q=this.getComposerData(n);this.$ReactComposerMediaUploadStore20(q,o,function(r){return r.withMutations(function(s){return s.set('state',c('ReactComposerPhotoUploadState').PHOTO_UPLOAD_DONE).set('photoID',p).set('sphericalPhotoID',l.sphericalPhotoID).set('originalPhotoID',l.originalPhotoID||p).set('progress',100).remove('fileUpload');});});if(!l.cubestripURI)this.$ReactComposerMediaUploadStore20(q,o,function(r){return r.set('isSpherical',false);});this.emitChange(n);};k.prototype.$ReactComposerMediaUploadStore10=function(l){'use strict';var m=this.validateAction(l,['composerID','uploadID','photoID','cubestripURI']),n=m[0],o=m[1],p=m[2],q=m[3],r=this.getUploadsCount(n);this.$ReactComposerMediaUploadStore19(n,r,new (c('ReactComposerPhotoUpload'))({id:o,photoID:p,mediaType:c('ReactComposerMediaUploadType').PHOTO,originalPhotoID:p,state:c('ReactComposerPhotoUploadState').PHOTO_UPLOAD_DONE,isSpherical:Boolean(q)}));this.emitChange(n);};k.prototype.$ReactComposerMediaUploadStore7=function(l){'use strict';var m=this.validateAction(l,['composerID','uploadID','isSpherical']),n=m[0],o=m[1],p=m[2];this.$ReactComposerMediaUploadStore20(this.getComposerData(n),o,function(q){return q.withMutations(function(r){return r.set('isSpherical',p).set('projectionType',l.projectionType);});});};k.prototype.$ReactComposerMediaUploadStore11=function(l){'use strict';var m=this.validateAction(l,['composerID','uploadID']),n=m[0],o=m[1],p=this.getComposerData(n);this.$ReactComposerMediaUploadStore20(p,o,function(q){return q.withMutations(function(r){return r.set('state',c('ReactComposerPhotoUploadState').PHOTO_UPLOAD_FAILED).set('error',l.error);});});this.emitChange(n);};k.prototype.$ReactComposerMediaUploadStore12=function(l){'use strict';var m=this.validateAction(l,['composerID','uploadID']),n=m[0],o=m[1],p=this.getComposerData(n),q=this.$ReactComposerMediaUploadStore18(p,o),r=p.uploads.get(q);if(r.mediaType==c('ReactComposerMediaUploadType').VIDEO)if(r.state===c('ReactComposerPhotoUploadState').PHOTO_UPLOAD_UPLOADING){p.videoUploader.cancelUpload(o);}else{if(!p.videoUploader){var s=c('ReactComposerAttachmentStore').getAttachmentsConfig(n,c('ReactComposerAttachmentType').MEDIA);s||h(0);this.getVideoUploader(n,s.videoUploadParams);}p.videoUploader.deleteUpload(o);}p.uploads=p.uploads['delete'](q);p.uploadsByID=p.uploadsByID['delete'](o);for(var t=q;t<p.uploads.size;t++){var u=p.uploads.get(t).id;p.uploadsByID=p.uploadsByID.set(u,t);}p.removedIDs=p.removedIDs.add(o);this.emitChange(n);};k.prototype.$ReactComposerMediaUploadStore8=function(l){'use strict';var m=this.validateAction(l,['composerID','uploadID','thumbSrc']),n=m[0],o=m[1],p=m[2],q=this.getComposerData(n);this.$ReactComposerMediaUploadStore20(q,o,function(r){return r.set('thumbSrc',p);});this.emitChange(n);};k.prototype.$ReactComposerMediaUploadStore5=function(l,m){'use strict';var n=this.validateAction(l,['composerID','uploadID']),o=n[0],p=n[1];this.$ReactComposerMediaUploadStore21(o,p,m);this.emitChange(o);};k.prototype.$ReactComposerMediaUploadStore13=function(l){'use strict';var m=this.validateAction(l,['composerID','from','to']),n=m[0],o=m[1],p=m[2],q=this.getComposerData(n);q.uploads=q.uploads.splice(o,1).splice(p,0,q.uploads.get(o));q.uploadsByID=q.uploads.groupBy(function(r,s){return s;}).toMap().map(function(r){return r.first().id;}).flip();this.emitChange(n);};k.prototype.$ReactComposerMediaUploadStore15=function(l){'use strict';var m=this.validateAction(l,['composerID','mediaIDs']),n=m[0],o=m[1],p=this.getComposerData(n);p.uploads=o.map(function(q){return this.$ReactComposerMediaUploadStore17(p,q);}.bind(this));p.uploadsByID=p.uploads.groupBy(function(q,r){return r;}).toMap().map(function(q){return q.first().id;}).flip();this.emitChange(n);};k.prototype.$ReactComposerMediaUploadStore14=function(l){'use strict';var m=this.validateAction(l,['composerID','medias']),n=m[0],o=m[1];o.forEach(function(p,q){this.$ReactComposerMediaUploadStore19(n,q,new (c('ReactComposerPhotoUpload'))({id:p.uploadID,photoID:p.photoID,mediaType:p.mediaType,originalPhotoID:p.photoID,state:c('ReactComposerPhotoUploadState').PHOTO_UPLOAD_DONE,thumbSrc:p.thumbSrc,fileURL:p.fileURL||p.imageSrc,filename:p.filename,isSpherical:Boolean(p.cubestripURI),height:p.height,width:p.width}));}.bind(this));this.emitChange(n);};k.prototype.$ReactComposerMediaUploadStore16=function(l){'use strict';var m=this.validateAction(l,['composerID','index','upload']),n=m[0],o=m[1],p=m[2],q=this.getComposerData(n);q.uploads=q.uploads.splice(o,0,p);for(var r=o;r<q.uploads.size;r++){var s=q.uploads.get(r).id;q.uploadsByID=q.uploadsByID.set(s,r);}this.emitChange(n);};k.prototype.$ReactComposerMediaUploadStore21=function(l,m,n){'use strict';var o=this.getComposerData(l);this.$ReactComposerMediaUploadStore20(o,m,function(p){return p.set('state',n);});};k.prototype.$ReactComposerMediaUploadStore20=function(l,m,n){'use strict';var o=this.$ReactComposerMediaUploadStore22(l,m),p=o[0],q=o[1];l.uploads=l.uploads.set(q,n(p,q));};k.prototype.$ReactComposerMediaUploadStore22=function(l,m){'use strict';var n=this.$ReactComposerMediaUploadStore18(l,m);return [l.uploads.get(n),n];};k.prototype.$ReactComposerMediaUploadStore18=function(l,m){'use strict';var n=l.uploadsByID.get(m);if(n===undefined)throw new Error('Upload '+m+' hasn\'t been registered');return n;};k.prototype.$ReactComposerMediaUploadStore17=function(l,m){'use strict';var n=this.$ReactComposerMediaUploadStore18(l,m);return l.uploads.get(n);};k.prototype.$ReactComposerMediaUploadStore1=function(l){'use strict';if(c('ReactComposerMediaUploadActionType')[l.type]){var m=l.composerID,n=l.uploadID;if(n==null)return false;return this.getHasUploadBeenRemoved(m,n);}return false;};k.prototype.$ReactComposerMediaUploadStore19=function(l,m,n){'use strict';var o=this.getComposerData(l);o.uploads=o.uploads.splice(m,0,n);for(var p=m;p<o.uploads.size;p++){var q=o.uploads.get(p).id;o.uploadsByID=o.uploadsByID.set(q,p);}this.$ReactComposerMediaUploadStore23(l,n);};k.prototype.$ReactComposerMediaUploadStore23=function(l,m){'use strict';if(m.mediaType==c('ReactComposerMediaUploadType').PHOTO){var n=new Image();n.onload=function(){var p=this.getComposerData(l);this.$ReactComposerMediaUploadStore20(p,m.id,function(q){return q.withMutations(function(r){return r.set('height',n.height).set('width',n.width);});});this.emitChange(l);}.bind(this);n.src=m.fileURL;}else if(m.mediaType==c('ReactComposerMediaUploadType').VIDEO){var o=document.createElement('video');o.onloadedmetadata=function(){var p=this.getComposerData(l);this.$ReactComposerMediaUploadStore20(p,m.id,function(q){return q.withMutations(function(r){return r.set('height',o.videoHeight).set('width',o.videoWidth);});});this.emitChange(l);}.bind(this);o.src=m.fileURL;}};f.exports=new k();}),null);
__d('MultimediaUploadProcessingDialog.react',['fbt','React','XUIDialog.react','XUIDialogTitle.react','XUIDialogBody.react'],(function a(b,c,d,e,f,g,h){'use strict';var i,j,k=c('React').PropTypes;i=babelHelpers.inherits(l,c('React').Component);j=i&&i.prototype;function l(){var m,n;for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return n=(m=j.constructor).call.apply(m,[this].concat(p)),this.state={dialogShown:true},this.$MultimediaUploadProcessingDialog1=function(){return this.props.numOfVideos===1?h._("Se est\u00e1 procesando el v\u00eddeo de tu publicaci\u00f3n. Te enviaremos una notificaci\u00f3n cuando finalice el proceso y se pueda ver la publicaci\u00f3n."):h._("Se est\u00e1n procesando los v\u00eddeos de tu publicaci\u00f3n. Te enviaremos una notificaci\u00f3n cuando est\u00e9 todo listo.");}.bind(this),this.$MultimediaUploadProcessingDialog2=function(){return h._("Procesando v\u00eddeos");},n;}l.prototype.componentWillReceiveProps=function(m){if(m.show)this.setState({dialogShown:true});};l.prototype.render=function(){return (c('React').createElement(c('XUIDialog.react'),{shown:this.state.dialogShown,width:400},c('React').createElement(c('XUIDialogTitle.react'),null,this.$MultimediaUploadProcessingDialog2()),c('React').createElement(c('XUIDialogBody.react'),null,this.$MultimediaUploadProcessingDialog1())));};l.propTypes={numOfVideos:k.number.isRequired};f.exports=l;}),null);
__d('ReactComposerMediaFilterUtils',['ComposerXNativeAudioUploadsConfig','VideoUploadConfig'],(function a(b,c,d,e,f,g){var h={hasVideos:function i(j){return this.filterVideos(j).length>0;},hasAudioFiles:function i(j){return this.filterAudioFiles(j).length>0;},filterVideos:function i(j){return this.filterFileOfSupportedType(j,c('VideoUploadConfig').videoExtensions);},filterAudioFiles:function i(j){return this.filterFileOfSupportedType(j,c('ComposerXNativeAudioUploadsConfig').audioExtensions);},filterFileOfSupportedType:function i(j,k){return j.filter(function(l){var m=l.indexOf('.')!==-1?l.split('.').pop().toLowerCase():'';return k[m];});}};f.exports=h;}),null);
__d('VideoUploadProgressBar',['cx','CSS','VideoUploadFeatureDetector'],(function a(b,c,d,e,f,g,h){function i(j){'use strict';this.$VideoUploadProgressBar1=j.progress_bar;this.$VideoUploadProgressBar2=j.throbber;this.$VideoUploadProgressBar3=j.uploader;this.$VideoUploadProgressBar4=j.start_margin;this.$VideoUploadProgressBar5=j.start_delay;this.$VideoUploadProgressBar6=j.end_margin;this.$VideoUploadProgressBar7=j.end_delay;this.$VideoUploadProgressBar8=j.progress_bar_label;this.$VideoUploadProgressBar9();}i.prototype.reset=function(){'use strict';this.$VideoUploadProgressBar1.setPosition(0);};i.prototype.getRoot=function(){'use strict';return this.$VideoUploadProgressBar1.getRoot();};i.computeProgress=function(j,k,l,m,n){'use strict';var o=Math.min(j+k,l);return o/l*(100-m-n)+m;};i.prototype.$VideoUploadProgressBar9=function(){'use strict';if(c('VideoUploadFeatureDetector').supportsFileAPI()){this.$VideoUploadProgressBar3.subscribe('upload-requested',this.$VideoUploadProgressBar10.bind(this));this.$VideoUploadProgressBar3.subscribe('upload-progressed',this.$VideoUploadProgressBar11.bind(this));this.$VideoUploadProgressBar3.subscribe('online',this.$VideoUploadProgressBar12.bind(this));this.$VideoUploadProgressBar3.subscribe('offline',this.$VideoUploadProgressBar13.bind(this));}else this.$VideoUploadProgressBar3.subscribe('upload-requested',this.$VideoUploadProgressBar14.bind(this));};i.prototype.$VideoUploadProgressBar10=function(event){'use strict';c('CSS').show(this.$VideoUploadProgressBar1.getRoot());c('CSS').removeClass(this.$VideoUploadProgressBar1.getRoot(),"_5r5a");this.$VideoUploadProgressBar1.setTarget(this.$VideoUploadProgressBar4,this.$VideoUploadProgressBar5);this.$VideoUploadProgressBar15(0);};i.prototype.$VideoUploadProgressBar15=function(j){'use strict';if(this.$VideoUploadProgressBar8)this.$VideoUploadProgressBar1.changeLabel(''+j.toFixed(1)+'%');};i.prototype.$VideoUploadProgressBar11=function(event,j){'use strict';c('CSS').removeClass(this.$VideoUploadProgressBar1.getRoot(),"_5r5a");var k=i.computeProgress(j.start_offset,j.sent_bytes,j.file_size,this.$VideoUploadProgressBar4,this.$VideoUploadProgressBar6);this.$VideoUploadProgressBar1.setPosition(k);this.$VideoUploadProgressBar15(k);if(k>=100-this.$VideoUploadProgressBar6){this.$VideoUploadProgressBar1.setTarget(100,this.$VideoUploadProgressBar7);this.$VideoUploadProgressBar15(100);}};i.prototype.$VideoUploadProgressBar12=function(event){'use strict';c('CSS').removeClass(this.$VideoUploadProgressBar1.getRoot(),"_5r5a");};i.prototype.$VideoUploadProgressBar13=function(event){'use strict';c('CSS').addClass(this.$VideoUploadProgressBar1.getRoot(),"_5r5a");};i.prototype.$VideoUploadProgressBar14=function(event){'use strict';c('CSS').show(this.$VideoUploadProgressBar2);};f.exports=i;}),null);
__d('VideoUploadLogger',['Banzai'],(function a(b,c,d,e,f,g){function h(i){this._source=i.source;this._waterfallID=i.waterfall_id;this._targetID=i.target_id;this._delay=i.delay;this._times=[];this._isChunkedUpload=i.is_chunked_upload;this._actorID=i.actor_id;this._composerEntryPointRef=i.composer_entry_point_ref;this._isRemoteUpload=i.is_remote_upload;this._containerType=i.container_type;}Object.assign(h,{BANZAI_GK:'videos',BANZAI_ROUTE:'video_waterfall',SOURCE_SIMPLE:'simple',SOURCE_COMPOSER:'composer',EVENT_STARTED_GENERATE_THUMBNAILS:'upload.client.started_generate_thumbnails',EVENT_FINISHED_GENERATE_THUMBNAILS:'upload.client.finished_generate_thumbnails',EVENT_SELECTED_CUSTOM_THUMBNAIL:'upload.client.selected_custom_thumbnail',EVENT_VIDEO_DIMENSIONS_UNREADABLE:'upload.client.video_dimensions_unreadable',EVENT_REPLACE_VIDEO:'upload.client.replace_video',EVENT_STARTED_FLOW:'upload.client.started_flow',EVENT_FINISHED_FLOW:'upload.client.finished_flow',EVENT_FAILED_FLOW:'upload.client.failed_flow',EVENT_CANCELED_FLOW:'upload.client.canceled_flow',EVENT_RESIGNED_FLOW:'upload.client.resigned_flow',EVENT_REQUESTED_UPLOADING:'upload.client.requested_uploading',EVENT_INVALIDATED_UPLOADING:'upload.client.invalidated_uploading',EVENT_STARTED_UPLOADING:'upload.client.started_uploading',EVENT_PROGRESS_UPLOADING_START_REQUEST:'upload.client.progress_uploading_start_request',EVENT_FINISHED_UPLOADING:'upload.client.finished_uploading',EVENT_CANCELED_UPLOADING:'upload.client.canceled_uploading',EVENT_ABANDONED_UPLOADING:'upload.client.abandoned_uploading',EVENT_FAILED_UPLOADING:'upload.client.failed_uploading',EVENT_STARTED_SENDING_BYTES:'upload.client.started_sending_bytes',EVENT_FINISHED_SENDING_BYTES:'upload.client.finished_sending_bytes',EVENT_CANCELED_SENDING_BYTES:'upload.client.canceled_sending_bytes',EVENT_FAILED_SENDING_BYTES:'upload.client.failed_sending_bytes',EVENT_STARTED_START_REQUEST:'upload.client.started_sending_start_request',EVENT_FINISHED_START_REQUEST:'upload.client.finished_sending_start_request',EVENT_FAILED_START_REQUEST:'upload.client.failed_sending_start_request',EVENT_STARTED_POST_REQUEST:'upload.client.started_sending_post_request',EVENT_FINISHED_POST_REQUEST:'upload.client.finished_sending_post_request',EVENT_FAILED_POST_REQUEST:'upload.client.failed_sending_post_request',EVENT_STARTED_SENDING_CHUNK_BYTES:'upload.client.started_sending_chunk_bytes',EVENT_FINISHED_SENDING_CHUNK_BYTES:'upload.client.finished_sending_chunk_bytes',EVENT_CANCELED_SENDING_CHUNK_BYTES:'upload.client.canceled_sending_chunk_bytes',EVENT_FAILED_SENDING_CHUNK_BYTES:'upload.client.failed_sending_chunk_bytes',EVENT_TIMEOUT_SENDING_CHUNK_BYTES:'upload.client.timeout_sending_chunk_bytes',EVENT_ENCODING_START_OBSERVED:'encode.client.encoding_start_observed',EVENT_ENCODING_SUCCESS_OBSERVED:'encode.client.encoding_success_observed',EVENT_ENCODING_FAIL_OBSERVED:'encode.client.encoding_fail_observed',EVENT_RECEIVED_RESPONSE:'upload.client.received_response'});Object.assign(h.prototype,{logEvent:function i(event,j){var k=babelHelpers['extends']({},j);if(k.elapsed_time==null)if(event.indexOf('started')!==-1){this._times[event]=Date.now();}else if(event.indexOf('finished')!==-1){k.elapsed_time=this._computeElapsedTime(event,'finished');}else if(event.indexOf('canceled')!==-1){k.elapsed_time=this._computeElapsedTime(event,'canceled');}else if(event.indexOf('failed')!==-1)k.elapsed_time=this._computeElapsedTime(event,'failed');k.event=event;k.source=this._source;k.waterfall_id=this._waterfallID;k.target_id=this._targetID;k.is_chunked_upload=this._isChunkedUpload;k.actor_id=this._actorID;k.composer_entry_point_ref=this._composerEntryPointRef;k.is_remote_upload=this._isRemoteUpload;k.container_type=this._containerType;c('Banzai').post(h.BANZAI_ROUTE,k,{delay:this._delay,retry:true});},_computeElapsedTime:function i(event,j){var k=event.replace(j,'started'),l=this._times[k];return l?Date.now()-l:null;}});f.exports=h;}),null);
__d('VideoUploadCrashMonitor',['Bandicoot','VideoUploadLogger'],(function a(b,c,d,e,f,g){var h,i;h=babelHelpers.inherits(j,c('Bandicoot'));i=h&&h.prototype;function j(k,l,m,n,o,p,q,r){'use strict';i.constructor.call(this,'VideoUploadSession');this.$VideoUploadCrashMonitor1={waterfallID:k,actorID:l,source:m,targetID:n,loggingDelay:o,supportsChunking:p,composerEntryPointRef:q,flowStarted:r};}j.prototype.flowStarted=function(){'use strict';this.$VideoUploadCrashMonitor1.flowStarted=true;};j.prototype.getCrashTimeData=function(){'use strict';return this.$VideoUploadCrashMonitor1;};j.prototype.logCrash=function(k,l,m){'use strict';if(!l.waterfallID)return;var n=new (c('VideoUploadLogger'))({actor_id:l.actorID,source:l.source,waterfall_id:l.waterfallID,target_id:l.targetID,delay:l.loggingDelay,is_chunked_upload:l.supportsChunking,composer_entry_point_ref:l.composerEntryPointRef}),o={error:'Crash Detected',error_description:'Detected video upload did not complete due to a crash'};n.logEvent(c('VideoUploadLogger').EVENT_FAILED_UPLOADING,o);if(l.flowStarted)n.logEvent(c('VideoUploadLogger').EVENT_RESIGNED_FLOW,{});};f.exports=j;}),null);
__d('VideoUploadFileValidator',['fbt','errorCode','ErrorDialog','JSXDOM'],(function a(b,c,d,e,f,g,h,i){var j=[1363019,1363020,1363021,1363022,1363023,1363024,1363025,1363026,1363027,1363030,1363031,1363032,1363033,1363038,1363039,1363040,1363048],k=['VIDEO__INVALID_GUIDE_DATA'];function l(m){'use strict';this.$VideoUploadFileValidator1=m;}l.prototype.validate=function(m,n){'use strict';return this.$VideoUploadFileValidator2(m)&&this.$VideoUploadFileValidator3(m)&&this.$VideoUploadFileValidator4(n);};l.prototype.getValidationErrorMessage=function(m,n){'use strict';return this.$VideoUploadFileValidator5(m)||this.$VideoUploadFileValidator6(m)||this.$VideoUploadFileValidator7(n);};l.canReplaceVideoForError=function(m){'use strict';if(!m)return true;if(k.indexOf(m)>-1)return false;if(j.indexOf(m)>-1)return true;return false;};l.prototype.$VideoUploadFileValidator2=function(m){'use strict';var n=this.$VideoUploadFileValidator5(m);if(n){c('ErrorDialog').show(n.summary,n.description);return false;}else return true;};l.prototype.$VideoUploadFileValidator5=function(m){'use strict';if(this.$VideoUploadFileValidator1.extensions[m.getExtension()])return;var n="http://www.facebook.com/help/"+"?faq=218673814818907#What-formats-of-video-files-can-I-upload?",o=c('JSXDOM').a({href:n},h._("recommended formats"));return {summary:h._("Formato de archivo incompatible"),description:h._("Sorry, the file you selected is in a format that we don't support. Please use one of our {link} for video files.",[h.param('link',o)])};};l.prototype.$VideoUploadFileValidator3=function(m){'use strict';var n=this.$VideoUploadFileValidator6(m);if(n){c('ErrorDialog').show(n.summary,n.description);return false;}else return true;};l.prototype.$VideoUploadFileValidator6=function(m){'use strict';var n;if(m.getSize()===null)return;if(m.getSize()<this.$VideoUploadFileValidator1.minSize)n=this.$VideoUploadFileValidator8();if(m.getSize()>this.$VideoUploadFileValidator1.maxSize)n=this.$VideoUploadFileValidator9();return n;};l.prototype.$VideoUploadFileValidator8=function(){'use strict';var m=Math.round(this.$VideoUploadFileValidator1.minSize/1024);return {summary:h._("El archivo de v\u00eddeo es demasiado peque\u00f1o"),description:h._("The video file you tried to upload is too small. The minimum size for a video file is {min-size} KB. Please try again with a larger file.",[h.param('min-size',m)])};};l.prototype.$VideoUploadFileValidator9=function(){'use strict';var m=this.$VideoUploadFileValidator1.maxSize/1024/1024;return {summary:h._("El archivo de v\u00eddeo es demasiado grande"),description:h._("The video file you tried to upload is too large. The maximum size for a video file is {max-size} MB. Please try again with a smaller file.",[h.param('max-size',m)])};};l.prototype.$VideoUploadFileValidator4=function(m){'use strict';var n=this.$VideoUploadFileValidator7(m);if(n){c('ErrorDialog').show(n.summary,n.description);return false;}else return true;};l.prototype.$VideoUploadFileValidator7=function(m){'use strict';var n;if(!m)return;var o=m.format.duration;if(o>this.$VideoUploadFileValidator1.maxLength)n=this.$VideoUploadFileValidator10();if(o<this.$VideoUploadFileValidator1.minLength)n=this.$VideoUploadFileValidator11();if(!m.streams.primaryVideo&&m.streams.primaryAudio)n=this.$VideoUploadFileValidator12();if(m.streams.primaryVideo.width<this.$VideoUploadFileValidator1.minWidth)n=this.$VideoUploadFileValidator13();if(m.streams.primaryVideo.height<this.$VideoUploadFileValidator1.minHeight)n=this.$VideoUploadFileValidator14();return n;};l.prototype.$VideoUploadFileValidator10=function(){'use strict';if(this.$VideoUploadFileValidator1.source==='profile_video'){return {summary:h._("El v\u00eddeo del perfil dura demasiado"),description:h._("La duraci\u00f3n m\u00e1xima es de {max-length} segundos. Sube un v\u00eddeo m\u00e1s corto.",[h.param('max-length',this.$VideoUploadFileValidator1.maxLength)])};}else return {summary:h._("Video Duration Too Long"),description:h._("The duration of the video you tried to upload is too long. The maximum duration for a video is {max-length} minutes. Please upload a shorter video.",[h.param('max-length',Math.round(this.$VideoUploadFileValidator1.maxLength/60))])};};l.prototype.$VideoUploadFileValidator11=function(){'use strict';return {summary:h._("Video File Too Short"),description:h._({"second":"El v\u00eddeo que has intentado subir es demasiado corto. La duraci\u00f3n m\u00ednima permitida para los v\u00eddeos es {min-length} segundos. Sube un v\u00eddeo de mayor duraci\u00f3n.","seconds":"El v\u00eddeo que has intentado subir es demasiado corto. La duraci\u00f3n m\u00ednima permitida para los v\u00eddeos es {min-length} segundos. Sube un v\u00eddeo de mayor duraci\u00f3n."},[h.param('min-length',this.$VideoUploadFileValidator1.minLength),h['enum'](this.$VideoUploadFileValidator1.minLength===1?'second':'seconds',{second:'second',seconds:'seconds'})])};};l.prototype.$VideoUploadFileValidator12=function(){'use strict';var m="http://www.facebook.com/help/"+"?faq=218673814818907#What-formats-of-video-files-can-I-upload?",n=c('JSXDOM').a({href:m},h._("supported video format"));return {summary:h._("No se ha detectado ning\u00fan v\u00eddeo"),description:h._("It looks like you're trying to upload a file that isn't a video. Please try uploading a {supported-video-format link}",[h.param('supported-video-format link',n)])};};l.prototype.$VideoUploadFileValidator13=function(){'use strict';return {summary:h._("Video Width Too Narrow"),description:h._("The width of the video you tried to upload is too short. The minimum width for a video is {min-width}. Please upload a wider video.",[h.param('min-width',this.$VideoUploadFileValidator1.minWidth)])};};l.prototype.$VideoUploadFileValidator14=function(){'use strict';return {summary:h._("Video Height Too Short"),description:h._("The height of the video you tried to upload is too short. The minimum height for a video is {min-height}. Please upload a taller video.",[h.param('min-height',this.$VideoUploadFileValidator1.minHeight)])};};f.exports=l;}),null);
__d('VideoUploadSphericalLogger',['Banzai'],(function a(b,c,d,e,f,g){var h=3000;function i(){'use strict';this.$VideoUploadSphericalLogger1={};this.$VideoUploadSphericalLogger2=false;this.$VideoUploadSphericalLogger3=0;}i.prototype.log=function(){'use strict';this.$VideoUploadSphericalLogger2?this.$VideoUploadSphericalLogger4():this.$VideoUploadSphericalLogger5();};i.prototype.$VideoUploadSphericalLogger5=function(){'use strict';c('Banzai').post('spherical_video_composer_upload',babelHelpers['extends']({},this.$VideoUploadSphericalLogger1));};i.prototype.$VideoUploadSphericalLogger4=function(){'use strict';var j=Date.now();if(j-this.$VideoUploadSphericalLogger3>h){this.$VideoUploadSphericalLogger3=j;this.$VideoUploadSphericalLogger5();}};i.prototype.setDirectorsCutEnabled=function(j){'use strict';this.$VideoUploadSphericalLogger1.directors_cut_enabled=j;return this;};i.prototype.setFieldOfView=function(j){'use strict';this.$VideoUploadSphericalLogger1.field_of_view=j;return this;};i.prototype.setFileExtension=function(j){'use strict';this.$VideoUploadSphericalLogger1.file_extension=j;return this;};i.prototype.setHasSphericalMetadata=function(j){'use strict';this.$VideoUploadSphericalLogger1.has_spherical_metadata=j;return this;};i.prototype.setPitchDegrees=function(j){'use strict';this.$VideoUploadSphericalLogger1.pitch_degrees=j;return this;};i.prototype.setTargetID=function(j){'use strict';this.$VideoUploadSphericalLogger1.target_id=j;return this;};i.prototype.setVideoID=function(j){'use strict';this.$VideoUploadSphericalLogger1.video_id=j;return this;};i.prototype.setUserAction=function(j){'use strict';this.$VideoUploadSphericalLogger1.user_action=j;if(j==='drag_video_preview'||j==='scroll_video_preview'){this.$VideoUploadSphericalLogger2=true;}else this.$VideoUploadSphericalLogger2=false;return this;};i.prototype.setVideoPreviewPosition=function(j){'use strict';this.$VideoUploadSphericalLogger1.video_preview_position=j;return this;};i.prototype.setYawDegrees=function(j){'use strict';this.$VideoUploadSphericalLogger1.yaw_degrees=j;return this;};i.prototype.setIsRedesign=function(j){'use strict';this.$VideoUploadSphericalLogger1.is_redesign=j;return this;};i.prototype.setFinalGuideEnabled=function(j){'use strict';this.$VideoUploadSphericalLogger1.final_guide_enabled=j;return this;};i.prototype.setFinalNumGuidePoints=function(j){'use strict';this.$VideoUploadSphericalLogger1.final_num_guide_points=j;return this;};f.exports=new i();}),null);
__d('VideoUploadMetadataParser',['VideoUploadFeatureDetector','VideoUploadSphericalLogger','fileSlice'],(function a(b,c,d,e,f,g){var h=4,i=4,j=5242880,k=24,l=88,m=20,n=16,o=4,p=84,q=20,r=62,s=[255,204,130,99,248,85,74,147,136,20,88,122,2,82,31,221],t=16,u=36,v=1,w=1,x=4,y=1,z=1,aa=4,ba=4;function ca(da,ea){'use strict';this.$VideoUploadMetadataParser1=da;this.$VideoUploadMetadataParser2=ea;}ca.prototype.getHandler=function(){'use strict';return this.$VideoUploadMetadataParser2;};ca.prototype.parse=function(){'use strict';if(!c('VideoUploadFeatureDetector').supportsFileReading()){this.$VideoUploadMetadataParser2(null);return;}switch(this.$VideoUploadMetadataParser1.getExtension()){case 'mp4':case 'mov':case 'm4v':case '3gp':case '3g2':c('VideoUploadSphericalLogger').setFileExtension(this.$VideoUploadMetadataParser1.getExtension());break;default:this.$VideoUploadMetadataParser2(null);return;}this.$VideoUploadMetadataParser3(0,Math.min(j,this.$VideoUploadMetadataParser1.getSize()),null);};ca.prototype.$VideoUploadMetadataParser3=function(da,ea,fa){'use strict';var ga=new FileReader();ga.onload=function(event){try{var ja=this.$VideoUploadMetadataParser4(new DataView(ga.result),0,ea-da,da,fa);if(ja.completed){ja=this.$VideoUploadMetadataParser5(ja);this.$VideoUploadMetadataParser2(ja);}else this.$VideoUploadMetadataParser3(da+ja.nextOffset,Math.min(this.$VideoUploadMetadataParser1.getSize(),da+ja.nextOffset+j),ja);}catch(ia){this.$VideoUploadMetadataParser2(null);}}.bind(this);var ha=this.$VideoUploadMetadataParser1.getFile();ga.readAsArrayBuffer(c('fileSlice').call(ha,da,ea));};ca.prototype.$VideoUploadMetadataParser6=function(da,ea,fa){'use strict';var ga=[];for(var ha=0;ha<fa;ha++)ga.push(String.fromCharCode(da.getUint8(ea+ha)));return ga.join('');};ca.prototype.$VideoUploadMetadataParser7=function(da,ea,fa){'use strict';var ga={version:null,ambisonic_type:null,ambisonic_order:null,ambisonic_channel_ordering:null,ambisonic_normalization:null,num_channels:null,channel_maps:[]},ha=0;ga.version=da.getUint8(ea+ha);ha=v;ga.ambisonic_type=da.getUint8(ea+ha);ha+=w;ga.ambisonic_order=da.getUint32(ea+ha);ha+=x;ga.ambisonic_channel_ordering=da.getUint8(ea+ha);ha+=y;ga.ambisonic_normalization=da.getUint8(ea+ha);ha+=z;ga.num_channels=da.getUint32(ea+ha);ha+=aa;for(var ia=0;ia<ga.num_channels;ia++){ga.channel_maps.push(da.getUint32(ea+ha));ha+=ba;if(ha>fa)return null;}return JSON.stringify(ga);};ca.prototype.$VideoUploadMetadataParser8=function(da,ea,fa,ga){'use strict';try{var ia=i+h;if(ia+s.length<fa&&this.$VideoUploadMetadataParser9(da,ea+ia)){ia+=s.length;if(ia<fa){var ja=this.$VideoUploadMetadataParser6(da,ea+ia,fa-ia),ka;if(window.DOMParser){var la=new DOMParser();ka=la.parseFromString(ja,'text/xml');}else{ka=new window.ActiveXObject('Microsoft.XMLDOM');ka.async='false';ka.loadXML(ja);}var ma=ka.getElementsByTagNameNS('*','Spherical')[0].childNodes[0].nodeValue;if(ma.toLowerCase()==='true'){var na=ka.getElementsByTagNameNS('*','StereoMode')[0],oa=na?na.childNodes[0].nodeValue:undefined;ga.sphericalMetadata.spherical=true;ga.sphericalMetadata.originalSphericalMetadata={spherical:true,stereoMode:oa};ga.sphericalMetadata.sphericalMetadataXml=ja;}}}}catch(ha){}};ca.prototype.$VideoUploadMetadataParser9=function(da,ea){'use strict';for(var fa=0;fa<s.length;fa++)if(da.getUint8(ea+fa)!==s[fa])return false;return true;};ca.prototype.$VideoUploadMetadataParser4=function(da,ea,fa,ga,ha){'use strict';if(!ha)ha={widths:[],heights:[],streamTypes:[],streamDurations:[],spherical:false,sphericalMetadata:{originalSphericalMetadata:{},sphericalMetadataXml:null,fbSpatialAudioMetadataXml:null,ytSa3dMetadataJson:null},isParsingInMediaInformationAtom:false,endOfMediaInformationAtomOffset:null};var ia=null;while(ea<fa){var ja=da.getUint32(ea),ka=this.$VideoUploadMetadataParser6(da,ea+h,i);if(ea+ja>fa){ha.completed=false;ha.nextOffset=ea;if(ja>fa)ha.nextOffset+=ja;return ha;}if(ha.isParsingInMediaInformationAtom&&ea>=ha.endOfMediaInformationAtomOffset){ha.isParsingInMediaInformationAtom=false;ha.endOfMediaInformationAtomOffset=null;}if(ea+ga===0&&ka!=='ftyp')throw new Error('No ftyp atom');if(ja===0)throw new Error('len is 0');var la=function xa(){var ya=da.getUint32(ea+m),za=da.getUint32(ea+k);return za/ya;};switch(ka){case 'moov':case 'trak':case 'mdia':case 'stbl':ea+=h+i;break;case 'mvhd':ha.duration=la();ea+=ja;break;case 'tkhd':var ma=da.getUint16(ea+p),na=da.getUint16(ea+l);ha.widths.push(ma);ha.heights.push(na);ia=da.getUint32(ea+q);ea+=ja;break;case 'hdlr':if(!ha.isParsingInMediaInformationAtom){var oa=this.$VideoUploadMetadataParser6(da,ea+n,o);switch(oa){case 'vide':oa='video';break;case 'soun':oa='audio';break;case 'subt':oa='subtitle';break;default:oa='data';}ha.streamTypes.push(oa);}ea+=ja;break;case 'mdhd':ha.streamDurations.push(la());ea+=ja;break;case 'uuid':this.$VideoUploadMetadataParser8(da,ea,ja,ha);ea+=ja;break;case 'meta':var pa=h+i+r,qa=this.$VideoUploadMetadataParser6(da,ea+pa,ja-pa);if(qa!==null){if(ha.sphericalMetadata.fbSpatialAudioMetadataXml===null)ha.sphericalMetadata.fbSpatialAudioMetadataXml='<fb360_spatial_audio>';ha.sphericalMetadata.fbSpatialAudioMetadataXml+='\n              <track id="'+ia.toString()+'">\n                '+qa+'\n              </track>\n            ';}ea+=ja;break;case 'minf':var ra=this.$VideoUploadMetadataParser6(da,ea+2*h+i,i);if(ra==='smhd'){ea+=h+i;ha.isParsingInMediaInformationAtom=true;ha.endOfMediaInformationAtomOffset=ea+ja;}else ea+=ja;break;case 'stsd':var sa=this.$VideoUploadMetadataParser6(da,ea+i+t,i);if(sa==='mp4a'){ea+=t;}else ea+=ja;break;case 'mp4a':var ta=da.getUint32(ea+u),ua=da.getUint32(ea+u+ta),va=this.$VideoUploadMetadataParser6(da,ea+u+ta+h,i);if(va==='SA3D'){var wa=this.$VideoUploadMetadataParser7(da,ea+u+ta+h+i,ua);if(wa!==null)if(ha.sphericalMetadata.ytSa3dMetadataJson===null)ha.sphericalMetadata.ytSa3dMetadataJson=wa;}ea+=ja;break;default:ea+=ja;}}ha.completed=true;if(ha.sphericalMetadata.fbSpatialAudioMetadataXml)ha.sphericalMetadata.fbSpatialAudioMetadataXml+='</fb360_spatial_audio>';return ha;};ca.prototype.$VideoUploadMetadataParser5=function(da){'use strict';var ea={streams:{},format:{},metadata:{}},fa=da.widths.length,ga=da.heights.length,ha=da.streamTypes.length,ia=da.streamDurations.length;if(fa!==ga||fa!==ha||fa!==ia)return null;for(var ja=0;ja<fa;ja++){var ka={width:da.widths[ja],height:da.heights[ja],duration:da.streamDurations[ja],type:da.streamTypes[ja]};if(ka.type==='video'){var la=ka.width*ka.height,ma=ea.streams.primaryVideo;if(!ma||ma.width*ma.height>la)ea.streams.primaryVideo=ka;}else if(ka.type==='audio'){var na=ea.streams.primaryAudio;if(!na||na.duration<ka.duration)ea.streams.primaryAudio=ka;}}ea.format.duration=da.duration;ea.format.isSpherical=da.sphericalMetadata.spherical;if(da.sphericalMetadata.spherical){ea.metadata.originalSphericalMetadata=da.sphericalMetadata.originalSphericalMetadata;ea.metadata.sphericalMetadataXml=da.sphericalMetadata.sphericalMetadataXml;ea.metadata.fbSpatialAudioMetadataXml=da.sphericalMetadata.fbSpatialAudioMetadataXml;ea.metadata.ytSa3dMetadataJson=da.sphericalMetadata.ytSa3dMetadataJson;}c('VideoUploadSphericalLogger').setHasSphericalMetadata(da.sphericalMetadata.spherical);return ea;};f.exports=ca;}),null);
__d('VideoUploadRequest',['AsyncRequest','DOM','DTSG','FileForm','Form','PHPQuerySerializer','VideoUploadFeatureDetector','emptyFunction','flattenPHPQueryData','submitForm'],(function a(b,c,d,e,f,g){var h='video';function i(j){'use strict';this.$VideoUploadRequest1=j;this.$VideoUploadRequest2=null;this.$VideoUploadRequest3=false;this.$VideoUploadRequest4=null;this.$VideoUploadRequest5=null;this.$VideoUploadRequest6=null;this.$VideoUploadRequest7=c('emptyFunction');this.$VideoUploadRequest8=c('emptyFunction');this.$VideoUploadRequest9=c('emptyFunction');this.$VideoUploadRequest10=c('emptyFunction');this.$VideoUploadRequest11=null;}i.prototype.setAllowCrossOrigin=function(j){'use strict';this.$VideoUploadRequest3=j;return this;};i.prototype.setData=function(j){'use strict';this.$VideoUploadRequest4=j;return this;};i.prototype.setWaterfallID=function(j){'use strict';this.$VideoUploadRequest5=j;return this;};i.prototype.setSuccessHandler=function(j){'use strict';this.$VideoUploadRequest7=j;return this;};i.prototype.setErrorHandler=function(j){'use strict';this.$VideoUploadRequest8=j;return this;};i.prototype.setTransportErrorHandler=function(j){'use strict';this.$VideoUploadRequest9=j;return this;};i.prototype.setUploadProgressHandler=function(j){'use strict';this.$VideoUploadRequest10=j;return this;};i.prototype.setTimeoutHandler=function(j,k){'use strict';this.$VideoUploadRequest6=j;this.$VideoUploadRequest11=k;return this;};i.prototype.setThumbnail=function(j){'use strict';this.$VideoUploadRequest12=j;return this;};i.prototype.setCaptions=function(j){'use strict';this.$VideoUploadRequest13=j;return this;};i.prototype.send=function(){'use strict';if(this.$VideoUploadRequest2)throw new Error('An upload request is already in progress.');if(c('VideoUploadFeatureDetector').supportsXHR()){this.$VideoUploadRequest2=this.$VideoUploadRequest14();if(this.$VideoUploadRequest12||this.$VideoUploadRequest13){var j=new FormData();if(this.$VideoUploadRequest12)j.append('thumb',this.$VideoUploadRequest12);if(this.$VideoUploadRequest13)this.$VideoUploadRequest13.forEach(function(l,m){var n=l.getIsDefault()?'captions_default':'captions_file'+m;j.append(n,l.getFile());});if(this.$VideoUploadRequest4){var k=c('flattenPHPQueryData')(this.$VideoUploadRequest4);Object.keys(k).forEach(function(l){j.append(l,k[l]);});}this.$VideoUploadRequest2.setRawData(j);}this.$VideoUploadRequest2.send();}else{this.$VideoUploadRequest2=this.$VideoUploadRequest15();this.$VideoUploadRequest16(this.$VideoUploadRequest2);}};i.prototype.sendChunk=function(j){'use strict';if(this.$VideoUploadRequest2)throw new Error('An upload request is already in progress.');var k=new FormData();k.append('video_file_chunk',j);this.$VideoUploadRequest2=this.$VideoUploadRequest14();this.$VideoUploadRequest2.setRawData(k);this.$VideoUploadRequest2.send();};i.prototype.sendFile=function(j){'use strict';if(this.$VideoUploadRequest2)throw new Error('An upload request is already in progress.');this.$VideoUploadRequest2=this.$VideoUploadRequest15();var k=j.cloneNode(false);j.name=h;c('DOM').replace(j,k);c('DOM').appendContent(this.$VideoUploadRequest2.getRoot(),j);this.$VideoUploadRequest16(this.$VideoUploadRequest2);j.name=k.name;c('DOM').replace(k,j);};i.prototype.abort=function(){'use strict';if(!this.$VideoUploadRequest2)throw new Error('There is no upload request in progress.');this.$VideoUploadRequest2.abort();this.$VideoUploadRequest2=null;};i.prototype.$VideoUploadRequest14=function(){'use strict';var j=this.__getAsyncRequest().setAllowCrossOrigin(this.$VideoUploadRequest3).setURI(this.$VideoUploadRequest1).setData(this.$VideoUploadRequest4).setRequestHeader('X_FB_VIDEO_WATERFALL_ID',this.$VideoUploadRequest5).setHandler(this.$VideoUploadRequest7).setErrorHandler(this.$VideoUploadRequest8).setTransportErrorHandler(this.$VideoUploadRequest9).setUploadProgressHandler(this.$VideoUploadRequest10);if(this.$VideoUploadRequest11)j.setTimeoutHandler(this.$VideoUploadRequest6,this.$VideoUploadRequest11);return j;};i.prototype.__getAsyncRequest=function(){'use strict';return new (c('AsyncRequest'))();};i.prototype.$VideoUploadRequest15=function(){'use strict';var j=c('DOM').create('form',{action:this.$VideoUploadRequest1,method:'POST'});c('Form').createHiddenInputs(babelHelpers['extends']({fb_dtsg:c('DTSG').getToken()},this.$VideoUploadRequest4),j);var k=new (c('FileForm'))(j,null,{allowCrossOrigin:this.$VideoUploadRequest3});k.subscribe('success',this.$VideoUploadRequest17.bind(this));k.subscribe('failure',this.$VideoUploadRequest18.bind(this));k.subscribe('progress',this.$VideoUploadRequest19.bind(this));return k;};i.prototype.$VideoUploadRequest16=function(j){'use strict';c('DOM').appendContent(document.body,j.getRoot());c('submitForm')(j.getRoot());};i.prototype.$VideoUploadRequest17=function(event,j){'use strict';this.$VideoUploadRequest7(j.response);};i.prototype.$VideoUploadRequest18=function(event,j){'use strict';this.$VideoUploadRequest8(j.response);};i.prototype.$VideoUploadRequest19=function(event,j){'use strict';this.$VideoUploadRequest10(j.event);};f.exports=i;}),null);
__d('VideoUploadPostRequestManager',['ArbiterMixin','VideoUploadRequest','mixin'],(function a(b,c,d,e,f,g){var h,i;h=babelHelpers.inherits(j,c('mixin')(c('ArbiterMixin')));i=h&&h.prototype;function j(k,l,m,n,o){'use strict';i.constructor.call(this);this.$VideoUploadPostRequestManager1=k;this.$VideoUploadPostRequestManager2=l;this.$VideoUploadPostRequestManager3=m;this.$VideoUploadPostRequestManager4=0;this.$VideoUploadPostRequestManager5=n;this.$VideoUploadPostRequestManager6=o;this.$VideoUploadPostRequestManager7=0;}j.prototype.getRequest=function(){'use strict';return this.$VideoUploadPostRequestManager8;};j.prototype.sendRequest=function(k){'use strict';if(this.$VideoUploadPostRequestManager8)return;this.$VideoUploadPostRequestManager9=babelHelpers['extends']({},k.getMetadata(),this.__createRequestData(k));this.$VideoUploadPostRequestManager10=this.$VideoUploadPostRequestManager9.thumb;delete this.$VideoUploadPostRequestManager9.thumb;this.$VideoUploadPostRequestManager11=this.$VideoUploadPostRequestManager9.captions;delete this.$VideoUploadPostRequestManager9.captions;this.$VideoUploadPostRequestManager12=k.getWaterfallID();this.$VideoUploadPostRequestManager13();this.inform('request-started');};j.prototype.$VideoUploadPostRequestManager13=function(){'use strict';clearTimeout(this.$VideoUploadPostRequestManager14);this.$VideoUploadPostRequestManager14=null;this.$VideoUploadPostRequestManager8=this.__getVideoUploadRequest(this.$VideoUploadPostRequestManager1).setAllowCrossOrigin(true).setData(this.$VideoUploadPostRequestManager9).setThumbnail(this.$VideoUploadPostRequestManager10).setCaptions(this.$VideoUploadPostRequestManager11).setWaterfallID(this.$VideoUploadPostRequestManager12).setSuccessHandler(this.$VideoUploadPostRequestManager15.bind(this)).setErrorHandler(this.$VideoUploadPostRequestManager16.bind(this)).setTransportErrorHandler(this.$VideoUploadPostRequestManager17.bind(this));this.$VideoUploadPostRequestManager8.send();};j.prototype.__createRequestData=function(k){'use strict';return {video_id:k.getVideoID(),target_id:k.getTargetID(),source:k.getSource(),waterfall_id:k.getWaterfallID(),creator_product:k.getCreatorProduct(),composer_entry_point_ref:k.getComposerEntryPointRef&&k.getComposerEntryPointRef(),supports_chunking:k.getSupportsChunking()};};j.prototype.__getVideoUploadRequest=function(k){'use strict';return new (c('VideoUploadRequest'))(k);};j.prototype.clearRequest=function(){'use strict';this.$VideoUploadPostRequestManager8=null;this.$VideoUploadPostRequestManager7=0;this.$VideoUploadPostRequestManager4=0;};j.prototype.isInProgress=function(){'use strict';return !!this.$VideoUploadPostRequestManager8;};j.prototype.$VideoUploadPostRequestManager18=function(k){'use strict';clearTimeout(this.$VideoUploadPostRequestManager14);this.$VideoUploadPostRequestManager14=setTimeout(this.$VideoUploadPostRequestManager13.bind(this),k);};j.prototype.$VideoUploadPostRequestManager19=function(k,l){'use strict';return Math.pow(k,l)*1000;};j.prototype.$VideoUploadPostRequestManager15=function(k){'use strict';var l=k.getPayload();this.inform('request-finished',{video_id:l.video_id,video_asset_id:l.video_asset_id,container_type:l.container_type,transport_retries:this.$VideoUploadPostRequestManager4,server_retries:this.$VideoUploadPostRequestManager7});this.clearRequest();};j.prototype.$VideoUploadPostRequestManager20=function(k){'use strict';this.inform('request-failed',{error_code:k.getError(),error_description:k.getErrorDescription(),error_summary:k.getErrorSummary(),transport_retries:this.$VideoUploadPostRequestManager4,server_retries:this.$VideoUploadPostRequestManager7,error_is_transient:k.isTransient()});this.clearRequest();};j.prototype.$VideoUploadPostRequestManager16=function(k){'use strict';this.$VideoUploadPostRequestManager8=null;this.$VideoUploadPostRequestManager4=0;if(k.isTransient()&&this.$VideoUploadPostRequestManager7<this.$VideoUploadPostRequestManager5){this.$VideoUploadPostRequestManager7++;this.$VideoUploadPostRequestManager18(this.$VideoUploadPostRequestManager19(this.$VideoUploadPostRequestManager6,this.$VideoUploadPostRequestManager7));}else this.$VideoUploadPostRequestManager20(k);};j.prototype.$VideoUploadPostRequestManager17=function(k){'use strict';if(this.$VideoUploadPostRequestManager2===0||this.$VideoUploadPostRequestManager4>=this.$VideoUploadPostRequestManager2){this.$VideoUploadPostRequestManager20(k);}else{this.$VideoUploadPostRequestManager4++;this.$VideoUploadPostRequestManager8=null;this.$VideoUploadPostRequestManager18(this.$VideoUploadPostRequestManager19(this.$VideoUploadPostRequestManager3,this.$VideoUploadPostRequestManager4));}};f.exports=j;}),null);
__d('VideoUploadConnectionMonitor',['ArbiterMixin','Network','VideoUploadFeatureDetector','debounce','mixin'],(function a(b,c,d,e,f,g){var h,i;h=babelHelpers.inherits(j,c('mixin')(c('ArbiterMixin')));i=h&&h.prototype;function j(){'use strict';i.constructor.call(this);this.$VideoUploadConnectionMonitor1=false;this.$VideoUploadConnectionMonitor2=[];this.$VideoUploadConnectionMonitor3=false;this.$VideoUploadConnectionMonitor4=true;this.$VideoUploadConnectionMonitor5=c('debounce')(function(){this.$VideoUploadConnectionMonitor6(false);}.bind(this),2000);}j.prototype.notifyStart=function(){'use strict';if(this.$VideoUploadConnectionMonitor3)return;if(this.$VideoUploadConnectionMonitor2.length===0){this.$VideoUploadConnectionMonitor2.push(c('Network').addListener('online',function(){this.$VideoUploadConnectionMonitor6(true);}.bind(this)));this.$VideoUploadConnectionMonitor2.push(c('Network').addListener('offline',function(){if(this.$VideoUploadConnectionMonitor1){this.$VideoUploadConnectionMonitor5();}else{this.$VideoUploadConnectionMonitor5.reset();setTimeout(this.$VideoUploadConnectionMonitor5,2000);}}.bind(this)));}this.$VideoUploadConnectionMonitor3=true;};j.prototype.notifyProgress=function(event){'use strict';if(!this.$VideoUploadConnectionMonitor3)return;if(!event)return;if(c('VideoUploadFeatureDetector').supportsFullProgress()){this.$VideoUploadConnectionMonitor1=true;if(event.total&&event.loaded===event.total){this.$VideoUploadConnectionMonitor5.reset();}else this.$VideoUploadConnectionMonitor5();}};j.prototype.notifySuccess=function(){'use strict';if(!this.$VideoUploadConnectionMonitor3)return;this.reset();this.$VideoUploadConnectionMonitor6(true);};j.prototype.notifyTransportError=function(){'use strict';if(!this.$VideoUploadConnectionMonitor3)return;this.$VideoUploadConnectionMonitor3=false;this.$VideoUploadConnectionMonitor6(false);};j.prototype.notifyError=function(){'use strict';if(!this.$VideoUploadConnectionMonitor3)return;this.reset();this.$VideoUploadConnectionMonitor6(true);};j.prototype.isOnline=function(){'use strict';return this.$VideoUploadConnectionMonitor4;};j.prototype.reset=function(){'use strict';while(this.$VideoUploadConnectionMonitor2.length)this.$VideoUploadConnectionMonitor2.pop().remove();this.$VideoUploadConnectionMonitor5.reset();this.$VideoUploadConnectionMonitor3=false;};j.prototype.$VideoUploadConnectionMonitor6=function(k){'use strict';this.$VideoUploadConnectionMonitor5.reset();if(this.$VideoUploadConnectionMonitor4!==k){this.$VideoUploadConnectionMonitor4=k;if(this.$VideoUploadConnectionMonitor4){this.inform('online');}else this.inform('offline');}};f.exports=j;}),null);
__d('VideoUploadReceiveRequestManager',['fbt','ArbiterMixin','VideoUploadConnectionMonitor','VideoUploadRequest','mixin'],(function a(b,c,d,e,f,g,h){var i,j,k=1363037;i=babelHelpers.inherits(l,c('mixin')(c('ArbiterMixin')));j=i&&i.prototype;function l(m,n,o,p,q,r,s,t,u){'use strict';j.constructor.call(this);this.$VideoUploadReceiveRequestManager1=m;this.$VideoUploadReceiveRequestManager2=n;this.$VideoUploadReceiveRequestManager3=o;this.$VideoUploadReceiveRequestManager4=p;this.$VideoUploadReceiveRequestManager5=q;this.$VideoUploadReceiveRequestManager6=r;this.$VideoUploadReceiveRequestManager7=s;this.$VideoUploadReceiveRequestManager8=t;this.$VideoUploadReceiveRequestManager9=u;this.$VideoUploadReceiveRequestManager10=0;this.$VideoUploadReceiveRequestManager11=0;this.$VideoUploadReceiveRequestManager12=0;this.$VideoUploadReceiveRequestManager13=null;this.$VideoUploadReceiveRequestManager14=null;this.$VideoUploadReceiveRequestManager15=0;this.$VideoUploadReceiveRequestManager16='constructed';this.$VideoUploadReceiveRequestManager17=new (c('VideoUploadConnectionMonitor'))();this.$VideoUploadReceiveRequestManager17.subscribe('online',this.$VideoUploadReceiveRequestManager18.bind(this));this.$VideoUploadReceiveRequestManager17.subscribe('offline',this.$VideoUploadReceiveRequestManager19.bind(this));}l.prototype.sendRequest=function(m){'use strict';this.$VideoUploadReceiveRequestManager16='sending request';if(this.$VideoUploadReceiveRequestManager20){this.$VideoUploadReceiveRequestManager16='request already in progress';return;}this.$VideoUploadReceiveRequestManager15=m.getEndOffset()-m.getStartOffset();this.$VideoUploadReceiveRequestManager21=m;this.$VideoUploadReceiveRequestManager22();};l.prototype.cancelRequest=function(){'use strict';if(!this.$VideoUploadReceiveRequestManager20)return;this.$VideoUploadReceiveRequestManager20.abort();this.$VideoUploadReceiveRequestManager23();};l.prototype.appendStateLogData=function(m,n){'use strict';m[n+'last_log_entry']=this.$VideoUploadReceiveRequestManager16;m[n+'upload_speed']=this.$VideoUploadReceiveRequestManager14;m[n+'transport_retries']=this.$VideoUploadReceiveRequestManager10;m[n+'server_retries']=this.$VideoUploadReceiveRequestManager11;m[n+'timeout_retries']=this.$VideoUploadReceiveRequestManager12;m[n+'last_timeout_value']=this.$VideoUploadReceiveRequestManager24;m[n+'last_request_start_time']=this.$VideoUploadReceiveRequestManager13;m[n+'pending_request']=this.$VideoUploadReceiveRequestManager20!=null;m[n+'pending_timer']=this.$VideoUploadReceiveRequestManager25!=null;m[n+'cached_chunk']=this.$VideoUploadReceiveRequestManager26!=null;if(this.$VideoUploadReceiveRequestManager21!=null){m[n+'start_offset']=this.$VideoUploadReceiveRequestManager21.getStartOffset();m[n+'end_offset']=this.$VideoUploadReceiveRequestManager21.getEndOffset();m[n+'partition_start_offset']=this.$VideoUploadReceiveRequestManager21.getPartitionStartOffset();m[n+'partition_end_offset']=this.$VideoUploadReceiveRequestManager21.getPartitionEndOffset();}if(this.$VideoUploadReceiveRequestManager17!=null)m[n+'connection_monitor_online']=this.$VideoUploadReceiveRequestManager17.isOnline();};l.prototype.$VideoUploadReceiveRequestManager23=function(){'use strict';this.$VideoUploadReceiveRequestManager20=null;this.$VideoUploadReceiveRequestManager26=null;this.$VideoUploadReceiveRequestManager10=0;this.$VideoUploadReceiveRequestManager11=0;this.$VideoUploadReceiveRequestManager12=0;this.$VideoUploadReceiveRequestManager13=null;this.$VideoUploadReceiveRequestManager14=null;this.$VideoUploadReceiveRequestManager15=0;this.$VideoUploadReceiveRequestManager21.reset();this.$VideoUploadReceiveRequestManager17.reset();clearTimeout(this.$VideoUploadReceiveRequestManager25);this.$VideoUploadReceiveRequestManager25=null;};l.prototype.$VideoUploadReceiveRequestManager22=function(m){'use strict';clearTimeout(this.$VideoUploadReceiveRequestManager25);this.$VideoUploadReceiveRequestManager25=null;if(this.$VideoUploadReceiveRequestManager21.getSupportsChunking()&&this.$VideoUploadReceiveRequestManager21.getStartOffset()>=this.$VideoUploadReceiveRequestManager21.getPartitionEndOffset()){if(!m){this.inform('request-finished',{start_offset:this.$VideoUploadReceiveRequestManager21.getEndOffset()-1,end_offset:this.$VideoUploadReceiveRequestManager21.getEndOffset(),transport_retries:this.$VideoUploadReceiveRequestManager10,server_retries:this.$VideoUploadReceiveRequestManager11,upload_speed:this.$VideoUploadReceiveRequestManager14});this.$VideoUploadReceiveRequestManager16='request finished - notified';}else this.$VideoUploadReceiveRequestManager16='request finished - not notified';return;}this.$VideoUploadReceiveRequestManager20=this.__getVideoUploadRequest(this.$VideoUploadReceiveRequestManager1).setAllowCrossOrigin(true).setData(this.__createRequestData(this.$VideoUploadReceiveRequestManager21)).setWaterfallID(this.$VideoUploadReceiveRequestManager21.getWaterfallID()).setSuccessHandler(this.__handleSuccessResponse.bind(this)).setErrorHandler(this.__handleServerFailureResponse.bind(this)).setTransportErrorHandler(this.$VideoUploadReceiveRequestManager27.bind(this)).setUploadProgressHandler(this.$VideoUploadReceiveRequestManager28.bind(this));this.$VideoUploadReceiveRequestManager13=Date.now();if(this.$VideoUploadReceiveRequestManager21.getSupportsChunking()){if(this.$VideoUploadReceiveRequestManager4){var n=this.$VideoUploadReceiveRequestManager29(this.$VideoUploadReceiveRequestManager21.getEndOffset()-this.$VideoUploadReceiveRequestManager21.getStartOffset(),this.$VideoUploadReceiveRequestManager14);this.$VideoUploadReceiveRequestManager20.setTimeoutHandler(n,this.__handleResponseTimeout.bind(this));this.$VideoUploadReceiveRequestManager16='sending chunk with timeout = '+n;this.$VideoUploadReceiveRequestManager24=n;}else this.$VideoUploadReceiveRequestManager16='sending chunk without timeout';this.$VideoUploadReceiveRequestManager20.sendChunk(this.$VideoUploadReceiveRequestManager30());}else{this.$VideoUploadReceiveRequestManager16='sending file';this.$VideoUploadReceiveRequestManager20.sendFile(this.$VideoUploadReceiveRequestManager21.getFile().getFileInput());}this.$VideoUploadReceiveRequestManager17.notifyStart();this.inform('request-started',{start_offset:this.$VideoUploadReceiveRequestManager21.getStartOffset(),end_offset:this.$VideoUploadReceiveRequestManager21.getEndOffset(),transport_retries:this.$VideoUploadReceiveRequestManager10,server_retries:this.$VideoUploadReceiveRequestManager11,upload_speed:this.$VideoUploadReceiveRequestManager14});};l.prototype.__getVideoUploadRequest=function(m){'use strict';return new (c('VideoUploadRequest'))(m);};l.prototype.$VideoUploadReceiveRequestManager31=function(m){'use strict';this.$VideoUploadReceiveRequestManager16='setting request to send after'+m;clearTimeout(this.$VideoUploadReceiveRequestManager25);this.$VideoUploadReceiveRequestManager25=setTimeout(this.$VideoUploadReceiveRequestManager22.bind(this),m);};l.prototype.$VideoUploadReceiveRequestManager30=function(){'use strict';if(this.$VideoUploadReceiveRequestManager26)return this.$VideoUploadReceiveRequestManager26;this.$VideoUploadReceiveRequestManager26=this.$VideoUploadReceiveRequestManager21.getFile().getChunk(this.$VideoUploadReceiveRequestManager21.getStartOffset(),this.$VideoUploadReceiveRequestManager21.getEndOffset());return this.$VideoUploadReceiveRequestManager26;};l.prototype.__createRequestData=function(m){'use strict';return {video_id:m.getVideoID(),start_offset:m.getStartOffset(),source:m.getSource(),target_id:m.getTargetID(),waterfall_id:m.getWaterfallID(),composer_entry_point_ref:m.getComposerEntryPointRef&&m.getComposerEntryPointRef(),supports_chunking:m.getSupportsChunking(),upload_speed:this.$VideoUploadReceiveRequestManager14,partition_start_offset:m.getPartitionStartOffset(),partition_end_offset:m.getPartitionEndOffset()};};l.prototype.__handleSuccessResponse=function(m){'use strict';this.$VideoUploadReceiveRequestManager16='success response received';var n=Date.now()-this.$VideoUploadReceiveRequestManager13;n=n===0?1:n;var o=m.getPayload();if(o.start_offset===this.$VideoUploadReceiveRequestManager21.getEndOffset()){var p=this.$VideoUploadReceiveRequestManager21.getEndOffset()-this.$VideoUploadReceiveRequestManager21.getStartOffset();this.$VideoUploadReceiveRequestManager14=Math.floor(p/n);}else this.$VideoUploadReceiveRequestManager14=null;this.$VideoUploadReceiveRequestManager17.notifySuccess();this.inform('request-finished',{start_offset:this.$VideoUploadReceiveRequestManager21.getStartOffset(),end_offset:this.$VideoUploadReceiveRequestManager21.getEndOffset(),transport_retries:this.$VideoUploadReceiveRequestManager10,server_retries:this.$VideoUploadReceiveRequestManager11,upload_speed:this.$VideoUploadReceiveRequestManager14});this.$VideoUploadReceiveRequestManager21.setStartOffset(o.start_offset);this.$VideoUploadReceiveRequestManager21.setEndOffset(o.end_offset);this.$VideoUploadReceiveRequestManager21.setLastKnownUploadSpeed(this.$VideoUploadReceiveRequestManager14);this.$VideoUploadReceiveRequestManager20=null;this.$VideoUploadReceiveRequestManager26=null;this.$VideoUploadReceiveRequestManager10=0;this.$VideoUploadReceiveRequestManager11=0;this.$VideoUploadReceiveRequestManager12=0;if(this.$VideoUploadReceiveRequestManager21.getSupportsChunking())this.$VideoUploadReceiveRequestManager22(true);};l.prototype.__handleServerFailureResponse=function(m){'use strict';this.$VideoUploadReceiveRequestManager16='failure response received';this.$VideoUploadReceiveRequestManager20=null;this.$VideoUploadReceiveRequestManager10=0;this.$VideoUploadReceiveRequestManager14=null;this.$VideoUploadReceiveRequestManager12=0;this.$VideoUploadReceiveRequestManager17.notifyError();if(this.__hasInvalidStartOffsetAndHasRetries(m.getError())){this.$VideoUploadReceiveRequestManager11++;var n=m.getPayload();this.$VideoUploadReceiveRequestManager16='invalid offset response received start='+n.start_offset+' end='+n.end_offset;if(this.$VideoUploadReceiveRequestManager21.getStartOffset()!=n.start_offset||this.$VideoUploadReceiveRequestManager21.getEndOffset()!=n.end_offset){this.$VideoUploadReceiveRequestManager21.setStartOffset(n.start_offset);this.$VideoUploadReceiveRequestManager21.setEndOffset(n.end_offset);this.$VideoUploadReceiveRequestManager26=null;}this.$VideoUploadReceiveRequestManager22();}else if((m.isTransient()||this.$VideoUploadReceiveRequestManager9)&&this.$VideoUploadReceiveRequestManager11<this.$VideoUploadReceiveRequestManager3){this.$VideoUploadReceiveRequestManager16='transient server error';this.$VideoUploadReceiveRequestManager11++;this.$VideoUploadReceiveRequestManager31(this.$VideoUploadReceiveRequestManager32(this.$VideoUploadReceiveRequestManager8,this.$VideoUploadReceiveRequestManager11));}else this.$VideoUploadReceiveRequestManager33(m);};l.prototype.__handleResponseTimeout=function(m){'use strict';this.inform('request-timeout',{start_offset:this.$VideoUploadReceiveRequestManager21.getStartOffset(),end_offset:this.$VideoUploadReceiveRequestManager21.getEndOffset(),transport_retries:this.$VideoUploadReceiveRequestManager10,server_retries:this.$VideoUploadReceiveRequestManager11,timeout_retries:this.$VideoUploadReceiveRequestManager12,upload_speed:this.$VideoUploadReceiveRequestManager14});this.$VideoUploadReceiveRequestManager20.abort();this.$VideoUploadReceiveRequestManager20=null;this.$VideoUploadReceiveRequestManager14=null;this.$VideoUploadReceiveRequestManager17.notifyTransportError();if(++this.$VideoUploadReceiveRequestManager12<=this.$VideoUploadReceiveRequestManager5){var n=this.$VideoUploadReceiveRequestManager21.getEndOffset()-this.$VideoUploadReceiveRequestManager21.getStartOffset();n=Math.floor(n/2);n=Math.max(n,this.$VideoUploadReceiveRequestManager15);var o=this.$VideoUploadReceiveRequestManager21.getEndOffset();o=Math.min(o,this.$VideoUploadReceiveRequestManager21.getStartOffset()+n);this.$VideoUploadReceiveRequestManager21.setEndOffset(o);this.$VideoUploadReceiveRequestManager26=null;this.$VideoUploadReceiveRequestManager16='resending after timeout with chunksize='+n;this.$VideoUploadReceiveRequestManager22();}else this.$VideoUploadReceiveRequestManager34({error_code:1006,error_description:h._("Parece que tu navegador est\u00e1 desconectado. Comprueba la conexi\u00f3n de internet y vuelve a intentarlo."),error_summary:h._("No hay conexi\u00f3n de red"),error_is_transient:true});};l.prototype.__hasInvalidStartOffsetAndHasRetries=function(m){'use strict';return m===k&&this.$VideoUploadReceiveRequestManager11<this.$VideoUploadReceiveRequestManager3;};l.prototype.$VideoUploadReceiveRequestManager27=function(m){'use strict';this.$VideoUploadReceiveRequestManager17.notifyTransportError();this.$VideoUploadReceiveRequestManager14=null;this.$VideoUploadReceiveRequestManager12=0;if(this.$VideoUploadReceiveRequestManager10<this.$VideoUploadReceiveRequestManager2){this.$VideoUploadReceiveRequestManager16='resending after transport failure';this.$VideoUploadReceiveRequestManager10++;this.$VideoUploadReceiveRequestManager20=null;this.$VideoUploadReceiveRequestManager31(this.$VideoUploadReceiveRequestManager32(this.$VideoUploadReceiveRequestManager7,this.$VideoUploadReceiveRequestManager10));}else this.$VideoUploadReceiveRequestManager33(m);};l.prototype.$VideoUploadReceiveRequestManager33=function(m){'use strict';this.$VideoUploadReceiveRequestManager34({error_code:m.getError(),error_description:m.getErrorDescription(),error_summary:m.getErrorSummary(),error_is_transient:m.isTransient()});};l.prototype.$VideoUploadReceiveRequestManager34=function(m){'use strict';this.$VideoUploadReceiveRequestManager16='handling failure error';this.inform('request-failed',m);this.$VideoUploadReceiveRequestManager23();};l.prototype.$VideoUploadReceiveRequestManager28=function(event){'use strict';this.$VideoUploadReceiveRequestManager17.notifyProgress(event);this.inform('request-progressed',{file_size:this.$VideoUploadReceiveRequestManager21.getFile().getSize(),start_offset:this.$VideoUploadReceiveRequestManager21.getStartOffset(),sent_bytes:event.loaded});};l.prototype.$VideoUploadReceiveRequestManager18=function(event){'use strict';this.inform('online');this.$VideoUploadReceiveRequestManager10=0;this.$VideoUploadReceiveRequestManager12=0;if(this.$VideoUploadReceiveRequestManager25)this.$VideoUploadReceiveRequestManager22();};l.prototype.$VideoUploadReceiveRequestManager19=function(event){'use strict';this.inform('offline');};l.prototype.$VideoUploadReceiveRequestManager32=function(m,n){'use strict';return Math.pow(m,n)*1000;};l.prototype.$VideoUploadReceiveRequestManager29=function(m,n){'use strict';var o;if(n>0){o=n;}else o=10;var p=Math.floor(m/o*this.$VideoUploadReceiveRequestManager6/100);return Math.max(p,30000);};f.exports=l;}),null);
__d("VideoUploadRequestContext",[],(function a(b,c,d,e,f,g){function h(){"use strict";this.reset();}h.prototype.setFile=function(i){"use strict";this.$VideoUploadRequestContext1=i;return this;};h.prototype.getFile=function(){"use strict";return this.$VideoUploadRequestContext1;};h.prototype.setMetadata=function(i){"use strict";this.$VideoUploadRequestContext2=i;return this;};h.prototype.getMetadata=function(){"use strict";return this.$VideoUploadRequestContext2;};h.prototype.setVideoID=function(i){"use strict";this.$VideoUploadRequestContext3=i;return this;};h.prototype.getVideoID=function(){"use strict";return this.$VideoUploadRequestContext3;};h.prototype.setStartOffset=function(i){"use strict";this.$VideoUploadRequestContext4=i;return this;};h.prototype.getStartOffset=function(){"use strict";return this.$VideoUploadRequestContext4;};h.prototype.setEndOffset=function(i){"use strict";this.$VideoUploadRequestContext5=i;return this;};h.prototype.getEndOffset=function(){"use strict";return this.$VideoUploadRequestContext5;};h.prototype.setPartitionStartOffset=function(i){"use strict";this.$VideoUploadRequestContext6=i;return this;};h.prototype.getPartitionStartOffset=function(){"use strict";return this.$VideoUploadRequestContext6;};h.prototype.setPartitionEndOffset=function(i){"use strict";this.$VideoUploadRequestContext7=i;return this;};h.prototype.getPartitionEndOffset=function(){"use strict";return this.$VideoUploadRequestContext7;};h.prototype.setTargetID=function(i){"use strict";this.$VideoUploadRequestContext8=i;return this;};h.prototype.getTargetID=function(){"use strict";return this.$VideoUploadRequestContext8;};h.prototype.setSource=function(i){"use strict";this.$VideoUploadRequestContext9=i;return this;};h.prototype.getSource=function(){"use strict";return this.$VideoUploadRequestContext9;};h.prototype.setWaterfallID=function(i){"use strict";this.$VideoUploadRequestContext10=i;return this;};h.prototype.getWaterfallID=function(){"use strict";return this.$VideoUploadRequestContext10;};h.prototype.setComposerEntryPointRef=function(i){"use strict";this.$VideoUploadRequestContext11=i;};h.prototype.getComposerEntryPointRef=function(){"use strict";return this.$VideoUploadRequestContext11;};h.prototype.setSupportsChunking=function(i){"use strict";this.$VideoUploadRequestContext12=i;return this;};h.prototype.getSupportsChunking=function(){"use strict";return this.$VideoUploadRequestContext12;};h.prototype.setSupportsFileAPI=function(i){"use strict";this.$VideoUploadRequestContext13=i;return this;};h.prototype.getSupportsFileAPI=function(){"use strict";return this.$VideoUploadRequestContext13;};h.prototype.setCreatorProduct=function(i){"use strict";this.$VideoUploadRequestContext14=i;return this;};h.prototype.getCreatorProduct=function(){"use strict";return this.$VideoUploadRequestContext14;};h.prototype.setLastKnownUploadSpeed=function(i){"use strict";this.$VideoUploadRequestContext15=i;};h.prototype.getLastKnownUploadSpeed=function(){"use strict";return this.$VideoUploadRequestContext15||0;};h.prototype.setUseParallelChunks=function(i){"use strict";this.$VideoUploadRequestContext16=i;};h.prototype.getUseParallelChunks=function(){"use strict";return this.$VideoUploadRequestContext16;};h.prototype.setIsSphericalVideo=function(i){"use strict";this.$VideoUploadRequestContext17=i;};h.prototype.getIsSphericalVideo=function(){"use strict";return this.$VideoUploadRequestContext17;};h.prototype.setSphericalMetadata=function(i){"use strict";this.$VideoUploadRequestContext18=i;};h.prototype.getSphericalMetadata=function(){"use strict";return this.$VideoUploadRequestContext18;};h.prototype.setEnableOmnistab=function(i){"use strict";this.$VideoUploadRequestContext19=i;};h.prototype.getEnableOmnistab=function(){"use strict";return this.$VideoUploadRequestContext19;};h.prototype.reset=function(){"use strict";this.$VideoUploadRequestContext1=null;this.$VideoUploadRequestContext3=null;this.$VideoUploadRequestContext4=null;this.$VideoUploadRequestContext5=null;this.$VideoUploadRequestContext8=null;this.$VideoUploadRequestContext9=null;this.$VideoUploadRequestContext10=null;this.$VideoUploadRequestContext11=null;this.$VideoUploadRequestContext12=null;this.$VideoUploadRequestContext13=null;this.$VideoUploadRequestContext6=null;this.$VideoUploadRequestContext7=null;this.$VideoUploadRequestContext14=null;this.$VideoUploadRequestContext15=0;this.$VideoUploadRequestContext16=false;this.$VideoUploadRequestContext17=false;this.$VideoUploadRequestContext2={};this.$VideoUploadRequestContext18={};this.$VideoUploadRequestContext19=false;};f.exports=h;}),null);
__d('VideoUploadStartRequestManager',['ArbiterMixin','VideoUploadRequest','FileHasher','performanceNow','mixin','Assert'],(function a(b,c,d,e,f,g){var h,i;h=babelHelpers.inherits(j,c('mixin')(c('ArbiterMixin')));i=h&&h.prototype;function j(k,l,m,n,o,p,q){'use strict';i.constructor.call(this);this.$VideoUploadStartRequestManager1=k;this.$VideoUploadStartRequestManager2=l;this.$VideoUploadStartRequestManager3=m;this.$VideoUploadStartRequestManager4=0;this.$VideoUploadStartRequestManager5=n;this.$VideoUploadStartRequestManager6=o;this.$VideoUploadStartRequestManager7=p;this.$VideoUploadStartRequestManager8=q;this.$VideoUploadStartRequestManager9=0;}j.prototype.getRequest=function(){'use strict';return this.$VideoUploadStartRequestManager10;};j.prototype.sendRequest=function(k){'use strict';if(this.$VideoUploadStartRequestManager11||this.$VideoUploadStartRequestManager10)return;this.$VideoUploadStartRequestManager12=k;if(this.$VideoUploadStartRequestManager5&&this.$VideoUploadStartRequestManager12.getFile().getFile()&&this.$VideoUploadStartRequestManager12.getFile().getFile().size<this.$VideoUploadStartRequestManager6&&c('FileHasher').isSupported()){this.$VideoUploadStartRequestManager13=c('performanceNow')();this.$VideoUploadStartRequestManager11=new (c('FileHasher'))();this.$VideoUploadStartRequestManager11.hash(this.$VideoUploadStartRequestManager12.getFile().getFile(),function(l){this.$VideoUploadStartRequestManager13=c('performanceNow')()-this.$VideoUploadStartRequestManager13;this.$VideoUploadStartRequestManager14=l.hash;this.$VideoUploadStartRequestManager11.destroy();this.$VideoUploadStartRequestManager11=null;if(!l.hash)this.$VideoUploadStartRequestManager15=l.exception;this.$VideoUploadStartRequestManager16();}.bind(this));}else this.$VideoUploadStartRequestManager16();};j.prototype.$VideoUploadStartRequestManager16=function(){'use strict';this.$VideoUploadStartRequestManager17();this.inform('request-started',{hash_time:this.$VideoUploadStartRequestManager13,hash_exception:this.$VideoUploadStartRequestManager15});};j.prototype.$VideoUploadStartRequestManager17=function(){'use strict';clearTimeout(this.$VideoUploadStartRequestManager18);this.$VideoUploadStartRequestManager18=null;this.$VideoUploadStartRequestManager10=this.__getVideoUploadRequest(this.$VideoUploadStartRequestManager1).setAllowCrossOrigin(true).setData(this.__getDataToSend(this.$VideoUploadStartRequestManager12,this.$VideoUploadStartRequestManager14)).setWaterfallID(this.$VideoUploadStartRequestManager12.getWaterfallID()).setSuccessHandler(this.$VideoUploadStartRequestManager19.bind(this)).setErrorHandler(this.$VideoUploadStartRequestManager20.bind(this)).setTransportErrorHandler(this.$VideoUploadStartRequestManager21.bind(this));this.$VideoUploadStartRequestManager10.send();};j.prototype.__getVideoUploadRequest=function(k){'use strict';return new (c('VideoUploadRequest'))(k);};j.prototype.__getDataToSend=function(k,l){'use strict';return {file_size:k.getFile().getSize(),file_extension:k.getFile().getExtension(),target_id:k.getTargetID(),source:k.getSource(),waterfall_id:k.getWaterfallID(),composer_entry_point_ref:k.getComposerEntryPointRef&&k.getComposerEntryPointRef(),supports_chunking:k.getSupportsChunking(),supports_file_api:k.getSupportsFileAPI(),partition_start_offset:k.getPartitionStartOffset(),partition_end_offset:k.getPartitionEndOffset(),creator_product:k.getCreatorProduct(),original_file_hash:l,spherical:k.getIsSphericalVideo(),spherical_metadata:k.getSphericalMetadata()};};j.prototype.cancelRequest=function(){'use strict';this.$VideoUploadStartRequestManager22();};j.prototype.$VideoUploadStartRequestManager23=function(k){'use strict';clearTimeout(this.$VideoUploadStartRequestManager18);this.$VideoUploadStartRequestManager18=setTimeout(this.$VideoUploadStartRequestManager17.bind(this),k);};j.prototype.$VideoUploadStartRequestManager22=function(){'use strict';if(this.$VideoUploadStartRequestManager11){this.$VideoUploadStartRequestManager11.destroy();this.$VideoUploadStartRequestManager11=null;}if(this.$VideoUploadStartRequestManager10){this.$VideoUploadStartRequestManager10.abort();this.$VideoUploadStartRequestManager10=null;}this.$VideoUploadStartRequestManager9=0;this.$VideoUploadStartRequestManager4=0;this.$VideoUploadStartRequestManager12=null;clearTimeout(this.$VideoUploadStartRequestManager18);this.$VideoUploadStartRequestManager18=null;};j.prototype.$VideoUploadStartRequestManager24=function(k,l){'use strict';return Math.pow(k,l)*1000;};j.prototype.$VideoUploadStartRequestManager19=function(k){'use strict';var l=k.getPayload();this.inform('request-finished',this.__getSuccessInformData(l));this.$VideoUploadStartRequestManager10=null;c('Assert').isTrue(this.$VideoUploadStartRequestManager11==null,'Unexpected: if file hasher is not null, clean up is required.');};j.prototype.__getSuccessInformData=function(k){'use strict';return {video_id:k.video_id,start_offset:k.start_offset,end_offset:k.end_offset,transport_retries:this.$VideoUploadStartRequestManager4,server_retries:this.$VideoUploadStartRequestManager9,skip_upload:k.skip_upload,hash_time:this.$VideoUploadStartRequestManager13};};j.prototype.$VideoUploadStartRequestManager25=function(k){'use strict';this.inform('request-failed',this.$VideoUploadStartRequestManager26(k));this.$VideoUploadStartRequestManager10=null;c('Assert').isTrue(this.$VideoUploadStartRequestManager11==null,'Unexpected: if file hasher is not null, clean up is required.');};j.prototype.$VideoUploadStartRequestManager20=function(k){'use strict';this.$VideoUploadStartRequestManager10=null;this.$VideoUploadStartRequestManager4=0;if(k.isTransient()&&this.$VideoUploadStartRequestManager9<this.$VideoUploadStartRequestManager7){this.$VideoUploadStartRequestManager9++;this.$VideoUploadStartRequestManager23(this.$VideoUploadStartRequestManager24(this.$VideoUploadStartRequestManager8,this.$VideoUploadStartRequestManager9));}else this.$VideoUploadStartRequestManager25(k);};j.prototype.$VideoUploadStartRequestManager21=function(k){'use strict';if(this.$VideoUploadStartRequestManager2===0||this.$VideoUploadStartRequestManager4>=this.$VideoUploadStartRequestManager2){this.$VideoUploadStartRequestManager25(k);}else{this.$VideoUploadStartRequestManager4++;this.$VideoUploadStartRequestManager10=null;this.$VideoUploadStartRequestManager23(this.$VideoUploadStartRequestManager24(this.$VideoUploadStartRequestManager3,this.$VideoUploadStartRequestManager4));}};j.prototype.$VideoUploadStartRequestManager26=function(k){'use strict';return {error_code:k.getError(),error_description:k.getErrorDescription(),error_summary:k.getErrorSummary(),transport_retries:this.$VideoUploadStartRequestManager4,server_retries:this.$VideoUploadStartRequestManager9,error_is_transient:k.isTransient()};};f.exports=j;}),null);
__d('VideoUploadSession',['ArbiterMixin','AsyncRequest','VideoUploadCrashMonitor','VideoUploadFeatureDetector','VideoUploadFileValidator','VideoUploadLogger','VideoUploadMetadataParser','VideoUploadPostRequestManager','VideoUploadReceiveRequestManager','VideoUploadRequestContext','VideoUploadStartRequestManager','WaterfallIDGenerator','mixin'],(function a(b,c,d,e,f,g){var h,i;h=babelHelpers.inherits(j,c('mixin')(c('ArbiterMixin')));i=h&&h.prototype;function j(k){'use strict';i.constructor.call(this);this.$VideoUploadSession1=k.source;this.$VideoUploadSession2=k.target_id;this.$VideoUploadSession3=k.logging_delay;this.$VideoUploadSession4=k.silent_file_validation;this.$VideoUploadSession5=k.background_upload;this.$VideoUploadSession6=k.actor_id;this.$VideoUploadSession7=k.composer_entry_point_ref;this.$VideoUploadSession8=k.monitor_crashes;this.$VideoUploadSession9=k.isMultiMediaPost;this.$VideoUploadSession10=k.container_type;this.$VideoUploadSession11=new (c('VideoUploadFileValidator'))({minSize:k.min_size,maxSize:k.max_size,minLength:k.min_length,maxLength:k.max_length,minWidth:k.min_width,minHeight:k.min_height,extensions:k.extensions,source:k.source});this.$VideoUploadSession12=c('VideoUploadFeatureDetector').supportsChunking();this.$VideoUploadSession13=c('VideoUploadFeatureDetector').supportsFileAPI();if(this.$VideoUploadSession12){this.$VideoUploadSession14=k.parallel_chunk_uploads;if(this.$VideoUploadSession14){this.$VideoUploadSession15=k.parallel_chunk_upload_filesize;this.$VideoUploadSession16=k.default_chunk_size;}}else this.$VideoUploadSession14=false;this.$VideoUploadSession17=this.$VideoUploadSession18(k);this.$VideoUploadSession19=this.$VideoUploadSession20(k);if(this.$VideoUploadSession14)this.$VideoUploadSession21=this.$VideoUploadSession20(k);this.$VideoUploadSession22=this.$VideoUploadSession23(k);}j.prototype.$VideoUploadSession24=function(){'use strict';this.$VideoUploadSession25=c('WaterfallIDGenerator').generate();this.$VideoUploadSession26=new (c('VideoUploadLogger'))({actor_id:this.$VideoUploadSession6,source:this.$VideoUploadSession1,waterfall_id:this.$VideoUploadSession25,target_id:this.$VideoUploadSession2,delay:this.$VideoUploadSession3,is_chunked_upload:this.$VideoUploadSession12,composer_entry_point_ref:this.$VideoUploadSession7,container_type:this.$VideoUploadSession10});};j.prototype.getLogger=function(){'use strict';if(!this.$VideoUploadSession26)return null;return this.$VideoUploadSession26;};j.prototype.start=function(k){'use strict';this.$VideoUploadSession27=null;this.$VideoUploadSession28=false;this.$VideoUploadSession29=false;this.$VideoUploadSession30=k;this.$VideoUploadSession31=0;this.$VideoUploadSession32=false;this.$VideoUploadSession33={sphericalMetadataXml:null,fbSpatialAudioMetadataXml:null,ytSa3dMetadataJson:null};this.$VideoUploadSession34=false;this.$VideoUploadSession24();this.__logEvent(c('VideoUploadLogger').EVENT_REQUESTED_UPLOADING);this.inform('upload-requested');var l=new (c('VideoUploadMetadataParser'))(this.$VideoUploadSession30,this.$VideoUploadSession35.bind(this));l.parse();};j.prototype.post=function(k){'use strict';this.__logEvent(c('VideoUploadLogger').EVENT_STARTED_POST_REQUEST);this.inform('post-started',k);var l=this.__createPostRequestContext(k);this.$VideoUploadSession22.sendRequest(l);this.$VideoUploadSession36=k;};j.prototype.__createPostRequestContext=function(k){'use strict';var l=new (c('VideoUploadRequestContext'))();this.__setupPostRequestContext(l,k);return l;};j.prototype.__setupPostRequestContext=function(k,l){'use strict';k.setMetadata(l).setVideoID(this.$VideoUploadSession27).setTargetID(this.$VideoUploadSession2).setSource(this.$VideoUploadSession1).setWaterfallID(this.$VideoUploadSession25).setSupportsChunking(this.$VideoUploadSession12).setCreatorProduct(this.$VideoUploadSession30.getCreatorProduct()).setFile(this.$VideoUploadSession30);if(l){if(l.spherical){this.$VideoUploadSession32=true;k.setIsSphericalVideo(this.$VideoUploadSession32);}if(l.enable_omnistab){this.$VideoUploadSession34=true;k.setEnableOmnistab(this.$VideoUploadSession34);}}if(k.setComposerEntryPointRef)k.setComposerEntryPointRef(this.$VideoUploadSession7);};j.prototype.cancel=function(){'use strict';if(!this.$VideoUploadSession28)return;var k=this.__fetchReceiveRequestManagerStateLogData();this.$VideoUploadSession37();if(this.$VideoUploadSession5){if(!this.$VideoUploadSession29)this.__logEvent(c('VideoUploadLogger').EVENT_CANCELED_UPLOADING);if(this.$VideoUploadSession38){this.__logEvent(c('VideoUploadLogger').EVENT_CANCELED_FLOW,k);this.$VideoUploadSession38=false;}}else{this.__logEvent(c('VideoUploadLogger').EVENT_CANCELED_UPLOADING);this.__logEvent(c('VideoUploadLogger').EVENT_CANCELED_FLOW,k);}};j.prototype.abandon=function(){'use strict';if(!this.$VideoUploadSession28)return;var k=this.__fetchReceiveRequestManagerStateLogData();this.$VideoUploadSession37();if(this.$VideoUploadSession5){if(!this.$VideoUploadSession29)this.__logEvent(c('VideoUploadLogger').EVENT_ABANDONED_UPLOADING);if(this.$VideoUploadSession38){this.__logEvent(c('VideoUploadLogger').EVENT_CANCELED_FLOW,k);this.$VideoUploadSession38=false;}}else{this.__logEvent(c('VideoUploadLogger').EVENT_ABANDONED_UPLOADING);this.__logEvent(c('VideoUploadLogger').EVENT_CANCELED_FLOW,k);}};j.prototype.isPostInProgress=function(){'use strict';return this.$VideoUploadSession22.isInProgress();};j.prototype.isInProgress=function(){'use strict';return this.$VideoUploadSession28;};j.prototype.getVideoID=function(){'use strict';return this.$VideoUploadSession27;};j.prototype.getUploadTime=function(){'use strict';return this.$VideoUploadSession39;};j.prototype.startFlow=function(){'use strict';if(!this.$VideoUploadSession5||this.$VideoUploadSession38)return;this.__logEvent(c('VideoUploadLogger').EVENT_STARTED_FLOW,{is_spherical:this.$VideoUploadSession32?'true':null});this.$VideoUploadSession38=true;if(this.$VideoUploadSession40)this.$VideoUploadSession40.flowStarted();};j.prototype.$VideoUploadSession35=function(k){'use strict';var l,m;if(this.$VideoUploadSession4){var n=this.$VideoUploadSession11.getValidationErrorMessage(this.$VideoUploadSession30,k);if(n){m={error_summary:n.summary,error_description:n.description};l=false;}else l=true;}else l=this.$VideoUploadSession11.validate(this.$VideoUploadSession30,k);if(!l){this.__logEvent(c('VideoUploadLogger').EVENT_INVALIDATED_UPLOADING);this.inform('upload-failed',m);return;}if(k&&k.format){this.$VideoUploadSession32=k.format.isSpherical;if(k.metadata){this.$VideoUploadSession33.sphericalMetadataXml=k.metadata.sphericalMetadataXml;this.$VideoUploadSession33.fbSpatialAudioMetadataXml=k.metadata.fbSpatialAudioMetadataXml;this.$VideoUploadSession33.ytSa3dMetadataJson=k.metadata.ytSa3dMetadataJson;}}if(!this.$VideoUploadSession5)this.__logEvent(c('VideoUploadLogger').EVENT_STARTED_FLOW,{is_spherical:this.$VideoUploadSession32?'true':null});this.$VideoUploadSession41=this.$VideoUploadSession14&&this.$VideoUploadSession30.getSize()>=this.$VideoUploadSession15;this.$VideoUploadSession42=false;this.$VideoUploadSession43=false;this.$VideoUploadSession44=0;this.$VideoUploadSession45=this.$VideoUploadSession44;this.$VideoUploadSession46=0;if(this.$VideoUploadSession41){this.$VideoUploadSession47=Math.floor(this.$VideoUploadSession30.getSize()/2);this.$VideoUploadSession48=this.$VideoUploadSession47;this.$VideoUploadSession49=this.$VideoUploadSession48;this.$VideoUploadSession50=0;this.$VideoUploadSession51=this.$VideoUploadSession30.getSize();}else this.$VideoUploadSession47=this.$VideoUploadSession30.getSize();var o=new (c('VideoUploadRequestContext'))().setFile(this.$VideoUploadSession30).setTargetID(this.$VideoUploadSession2).setSource(this.$VideoUploadSession1).setWaterfallID(this.$VideoUploadSession25).setSupportsChunking(this.$VideoUploadSession12).setSupportsFileAPI(this.$VideoUploadSession13).setCreatorProduct(this.$VideoUploadSession30.getCreatorProduct()).setPartitionStartOffset(this.$VideoUploadSession44).setPartitionEndOffset(this.$VideoUploadSession47);if(this.$VideoUploadSession14)o.setUseParallelChunks(this.$VideoUploadSession14);if(this.$VideoUploadSession32){o.setIsSphericalVideo(this.$VideoUploadSession32);o.setSphericalMetadata(this.$VideoUploadSession33);}if(o.setComposerEntryPointRef)o.setComposerEntryPointRef(this.$VideoUploadSession7);this.$VideoUploadSession52();this.$VideoUploadSession17.sendRequest(o);this.inform('metadata-parsed',k);};j.prototype.$VideoUploadSession18=function(k){'use strict';var l=this.$VideoUploadSession12?k.chunk_start_uri:k.start_uri,m=this.__getVideoUploadStartRequestManager(l,k.start_max_transport_retries,k.start_transport_retry_interval_base,k.skip_upload_enabled,k.skip_upload_file_size_limit,k.start_max_server_retries,k.start_server_retry_interval_base);m.subscribe('request-started',this.$VideoUploadSession53.bind(this));m.subscribe('request-finished',this.$VideoUploadSession54.bind(this));m.subscribe('request-failed',this.$VideoUploadSession55.bind(this));return m;};j.prototype.$VideoUploadSession20=function(k){'use strict';var l=this.$VideoUploadSession12?k.chunk_receive_uri:k.receive_uri,m=this.__getVideoUploadReceiveRequestManager(l,k);m.subscribe('request-started',this.$VideoUploadSession56.bind(this));m.subscribe('request-progressed',this.$VideoUploadSession57.bind(this));m.subscribe('request-finished',this.$VideoUploadSession58.bind(this));m.subscribe('request-failed',this.$VideoUploadSession59.bind(this));m.subscribe('request-timeout',this.$VideoUploadSession60.bind(this));m.subscribe('online',this.$VideoUploadSession61.bind(this));m.subscribe('offline',this.$VideoUploadSession62.bind(this));return m;};j.prototype.$VideoUploadSession23=function(k){'use strict';var l=this.$VideoUploadSession12?k.chunk_post_uri:k.post_uri,m=this.__getVideoUploadPostRequestManager(l,k);m.subscribe('request-finished',this.__handlePostRequestFinished.bind(this));m.subscribe('request-failed',this.$VideoUploadSession63.bind(this));return m;};j.prototype.$VideoUploadSession53=function(event,k){'use strict';this.__logEvent(c('VideoUploadLogger').EVENT_STARTED_UPLOADING,{hash_time:k.hash_time,hash_exception:k.hash_exception});this.__logEvent(c('VideoUploadLogger').EVENT_STARTED_START_REQUEST);this.$VideoUploadSession64=Date.now();this.inform('upload-started');};j.prototype.$VideoUploadSession54=function(event,k){'use strict';this.__logEvent(c('VideoUploadLogger').EVENT_PROGRESS_UPLOADING_START_REQUEST,{transport_retries:k.transport_retries,hash_time:k.hash_time,skip_upload:k.skip_upload?1:null});this.__logEvent(c('VideoUploadLogger').EVENT_FINISHED_START_REQUEST);this.$VideoUploadSession27=k.video_id;this.$VideoUploadSession65=k.skip_upload;if(!k.skip_upload){var l;l=this.__createReceiveRequestContext(k,false);this.$VideoUploadSession19.sendRequest(l);if(this.$VideoUploadSession41){l=this.__createReceiveRequestContext(k,true);this.$VideoUploadSession21.sendRequest(l);}}else{this.inform('upload-progressed',{start_offset:0,end_offset:this.$VideoUploadSession30.getSize(),file_size:this.$VideoUploadSession30.getSize(),sent_bytes:this.$VideoUploadSession30.getSize(),video_id:k.video_id,skip_upload:k.skip_upload});if(this.$VideoUploadSession5)this.__logFinishedUploading();this.inform('upload-finished',{start_offset:0,end_offset:this.$VideoUploadSession30.getSize(),video_id:k.video_id});}};j.prototype.__fetchReceiveRequestManagerStateLogData=function(){'use strict';var k={};if(this.$VideoUploadSession19!=null)this.$VideoUploadSession19.appendStateLogData(k,'requestManager_');if(this.$VideoUploadSession21!=null)this.$VideoUploadSession21.appendStateLogData(k,'requestManagerEx_');return k;};j.prototype.__createReceiveRequestContext=function(k,l){'use strict';if(!l)l=false;var m=new (c('VideoUploadRequestContext'))();this.__setupReceiveRequestContext(m,k,l);return m;};j.prototype.__setupReceiveRequestContext=function(k,l,m){'use strict';var n,o,p,q;if(!m){n=this.$VideoUploadSession44;o=this.$VideoUploadSession47;p=l.start_offset;q=l.end_offset;}else{n=this.$VideoUploadSession48;o=this.$VideoUploadSession51;p=this.$VideoUploadSession48;q=this.$VideoUploadSession48+this.$VideoUploadSession16>=this.$VideoUploadSession51?this.$VideoUploadSession51:this.$VideoUploadSession48+this.$VideoUploadSession16;}k.setFile(this.$VideoUploadSession30).setVideoID(l.video_id).setStartOffset(p).setEndOffset(q).setPartitionStartOffset(n).setPartitionEndOffset(o).setTargetID(this.$VideoUploadSession2).setSource(this.$VideoUploadSession1).setWaterfallID(this.$VideoUploadSession25).setSupportsChunking(this.$VideoUploadSession12);if(this.$VideoUploadSession14)k.setUseParallelChunks(this.$VideoUploadSession14);if(k.setComposerEntryPointRef)k.setComposerEntryPointRef(this.$VideoUploadSession7);};j.prototype.$VideoUploadSession55=function(event,k){'use strict';var l=this.__getLogErrorData(k);this.__logEvent(c('VideoUploadLogger').EVENT_FAILED_START_REQUEST,l);this.__logEvent(c('VideoUploadLogger').EVENT_FAILED_UPLOADING,l);var m=k.error_is_transient?c('VideoUploadLogger').EVENT_RESIGNED_FLOW:c('VideoUploadLogger').EVENT_FAILED_FLOW;if(this.$VideoUploadSession5){if(this.$VideoUploadSession38){this.__logEvent(m);this.$VideoUploadSession38=false;}}else this.__logEvent(m);this.$VideoUploadSession66();this.inform('upload-failed',k);};j.prototype.$VideoUploadSession56=function(event,k){'use strict';if(!k.start_offset&&!k.transport_retries&&!k.server_retries)this.__logEvent(c('VideoUploadLogger').EVENT_STARTED_SENDING_BYTES,{total_bytes:this.$VideoUploadSession30.getSize()});if(this.$VideoUploadSession12)this.__logEvent(c('VideoUploadLogger').EVENT_STARTED_SENDING_CHUNK_BYTES,{start_offset:k.start_offset,total_bytes:k.end_offset-k.start_offset,transport_retries:k.transport_retries,server_retries:k.server_retries,upload_speed:k.upload_speed});};j.prototype.$VideoUploadSession57=function(event,k){'use strict';if(k.start_offset<this.$VideoUploadSession47){this.$VideoUploadSession45=k.start_offset;this.$VideoUploadSession46=k.sent_bytes;}else{this.$VideoUploadSession49=k.start_offset;this.$VideoUploadSession50=k.sent_bytes;}k.start_offset=this.$VideoUploadSession45;k.sent_bytes=this.$VideoUploadSession46;if(this.$VideoUploadSession41){k.start_offset+=this.$VideoUploadSession49-this.$VideoUploadSession48;k.sent_bytes+=this.$VideoUploadSession50;}var l=Math.min(k.start_offset+k.sent_bytes,k.file_size);if(l>this.$VideoUploadSession31){this.$VideoUploadSession31=l;this.inform('upload-progressed',k);}};j.prototype.$VideoUploadSession58=function(event,k){'use strict';if(this.$VideoUploadSession12)this.__logEvent(c('VideoUploadLogger').EVENT_FINISHED_SENDING_CHUNK_BYTES,{start_offset:k.start_offset,sent_bytes:k.end_offset-k.start_offset,transport_retries:k.transport_retries,server_retries:k.server_retries,upload_speed:k.upload_speed});if(k.start_offset<this.$VideoUploadSession47){this.$VideoUploadSession42=k.end_offset>=this.$VideoUploadSession47;}else this.$VideoUploadSession43=k.end_offset>=this.$VideoUploadSession51;if(!this.$VideoUploadSession13||this.$VideoUploadSession42&&(!this.$VideoUploadSession41||this.$VideoUploadSession43)){this.__logEvent(c('VideoUploadLogger').EVENT_FINISHED_SENDING_BYTES,{sent_bytes:this.$VideoUploadSession30.getSize()});this.$VideoUploadSession39=Date.now()-this.$VideoUploadSession64;if(this.$VideoUploadSession5)this.__logFinishedUploading();k.video_id=this.$VideoUploadSession27;this.inform('upload-finished',k);if(this.$VideoUploadSession9){this.__logEvent(c('VideoUploadLogger').EVENT_FINISHED_FLOW);this.$VideoUploadSession38=false;this.$VideoUploadSession66();this.inform('multimedia-upload-finished',k);}}};j.prototype.$VideoUploadSession59=function(event,k){'use strict';var l=this.__getLogErrorData(k);if(this.$VideoUploadSession12)this.__logEvent(c('VideoUploadLogger').EVENT_FAILED_SENDING_CHUNK_BYTES,l);this.__logEvent(c('VideoUploadLogger').EVENT_FAILED_UPLOADING,l);var m=k.error_is_transient?c('VideoUploadLogger').EVENT_RESIGNED_FLOW:c('VideoUploadLogger').EVENT_FAILED_FLOW;if(this.$VideoUploadSession5){if(this.$VideoUploadSession38){this.__logEvent(m);this.$VideoUploadSession38=false;}}else this.__logEvent(m);this.$VideoUploadSession66();this.inform('upload-failed',k);};j.prototype.$VideoUploadSession60=function(event,k){'use strict';this.__logEvent(c('VideoUploadLogger').EVENT_TIMEOUT_SENDING_CHUNK_BYTES,{start_offset:k.start_offset,sent_bytes:k.end_offset-k.start_offset,transport_retries:k.transport_retries,server_retries:k.server_retries,timeout_retries:k.timeout_retries,upload_speed:k.upload_speed});};j.prototype.$VideoUploadSession61=function(event,k){'use strict';this.inform('online',k);};j.prototype.$VideoUploadSession62=function(event,k){'use strict';this.inform('offline',k);};j.prototype.__handlePostRequestFinished=function(event,k){'use strict';this.__logEvent(c('VideoUploadLogger').EVENT_FINISHED_POST_REQUEST);if(!k.video_id)k.video_id=this.$VideoUploadSession27;if(!this.$VideoUploadSession5)this.__logFinishedUploading();this.__logEvent(c('VideoUploadLogger').EVENT_FINISHED_FLOW);this.$VideoUploadSession38=false;this.$VideoUploadSession66();var l=babelHelpers['extends']({},k,this.$VideoUploadSession36);this.inform('post-finished',l);};j.prototype.__logFinishedUploading=function(){'use strict';this.__logEvent(c('VideoUploadLogger').EVENT_FINISHED_UPLOADING,{elapsed_time:this.$VideoUploadSession39,skip_upload:this.$VideoUploadSession65?1:null});this.$VideoUploadSession29=true;};j.prototype.$VideoUploadSession63=function(event,k){'use strict';var l=this.__getLogErrorData(k);this.__logEvent(c('VideoUploadLogger').EVENT_FAILED_POST_REQUEST,l);if(this.$VideoUploadSession28){this.__logEvent(c('VideoUploadLogger').EVENT_FAILED_UPLOADING,l);var m=k.error_is_transient?c('VideoUploadLogger').EVENT_RESIGNED_FLOW:c('VideoUploadLogger').EVENT_FAILED_FLOW;this.__logEvent(m);}this.$VideoUploadSession66();this.inform('post-failed',k);};j.prototype.$VideoUploadSession37=function(){'use strict';this.$VideoUploadSession17.cancelRequest();this.$VideoUploadSession19.cancelRequest();if(this.$VideoUploadSession41)this.$VideoUploadSession21.cancelRequest();this.$VideoUploadSession66();if(this.$VideoUploadSession27){new (c('AsyncRequest'))('/ajax/video/actions/delete').setData({fbid:this.$VideoUploadSession27,redirect:false}).send();this.$VideoUploadSession27=null;}};j.prototype.$VideoUploadSession52=function(){'use strict';this.$VideoUploadSession28=true;if(this.$VideoUploadSession8){this.$VideoUploadSession40=new (c('VideoUploadCrashMonitor'))(this.$VideoUploadSession25,this.$VideoUploadSession6,this.$VideoUploadSession1,this.$VideoUploadSession2,this.$VideoUploadSession3,this.$VideoUploadSession12,this.$VideoUploadSession7,!this.$VideoUploadSession5||this.$VideoUploadSession38);this.$VideoUploadSession40.startSession();}};j.prototype.$VideoUploadSession66=function(){'use strict';this.$VideoUploadSession28=false;if(this.$VideoUploadSession40){this.$VideoUploadSession40.endSession();this.$VideoUploadSession40=null;}};j.prototype.__getLogErrorData=function(k){'use strict';return {error:k.error_summary,error_code:k.error_code,error_description:k.error_description,transport_retries:k.transport_retries,server_retries:k.server_retries};};j.prototype.__logEvent=function(event,k){'use strict';var l=this.getLogger();k=k||{};if(this.$VideoUploadSession30){k.file_size=this.$VideoUploadSession30.getSize();k.file_extension=this.$VideoUploadSession30.getExtension();k.sent_bytes=this.$VideoUploadSession31;}l.logEvent(event,k);};j.prototype.__getVideoUploadStartRequestManager=function(k,l,m,n,o,p,q){'use strict';return new (c('VideoUploadStartRequestManager'))(k,l,m,n,o,p,q);};j.prototype.__getVideoUploadReceiveRequestManager=function(k,l){'use strict';return new (c('VideoUploadReceiveRequestManager'))(k,l.max_transport_retries,l.max_server_retries,l.response_timeout_enabled,l.max_response_timeout_retries,l.response_timeout_speed_variation_factor_ppt,l.transport_retry_interval_base,l.server_retry_interval_base,l.receive_errors_force_retry);};j.prototype.__getVideoUploadPostRequestManager=function(k,l){'use strict';return new (c('VideoUploadPostRequestManager'))(k,l.post_max_transport_retries,l.post_transport_retry_interval_base,l.post_max_server_retries,l.post_server_retry_interval_base);};f.exports=j;}),null);
__d('VideoUploader',['ArbiterMixin','VideoUploadCrashMonitor','VideoUploadLogger','VideoUploadSession','arrayContains','mixin'],(function a(b,c,d,e,f,g){var h,i;h=babelHelpers.inherits(j,c('mixin')(c('ArbiterMixin')));i=h&&h.prototype;function j(k){'use strict';i.constructor.call(this);this.$VideoUploader1=k;this.$VideoUploader2=null;if(k.monitor_crashes){this.$VideoUploader3=new (c('VideoUploadCrashMonitor'))();this.$VideoUploader3.logKnownCrashes();}}j.prototype.getLogger=function(){'use strict';if(!this.$VideoUploader2)return;if(this.$VideoUploader2.getLogger)return this.$VideoUploader2.getLogger();};j.prototype.upload=function(k){'use strict';if(this.$VideoUploader2)return;this.$VideoUploader2=this.__getVideoUploadSession(this.$VideoUploader1);this.$VideoUploader2.subscribe(this.__getEventsWhichShouldListenFromSession(),function(event,l){return this.$VideoUploader4(event,l);}.bind(this));this.$VideoUploader2.start(k);};j.prototype.__getVideoUploadSession=function(k){'use strict';return new (c('VideoUploadSession'))(k);};j.prototype.__getEventsWhichShouldListenFromSession=function(){'use strict';return ['upload-requested','upload-started','upload-progressed','upload-finished','upload-failed','post-started','post-finished','post-failed','online','offline','metadata-parsed'];};j.prototype.postUserRequest=function(){'use strict';if(!this.$VideoUploader2)return;if(this.$VideoUploader2.startFlow)this.$VideoUploader2.startFlow();};j.prototype.post=function(k){'use strict';if(!this.$VideoUploader2)return;this.$VideoUploader2.post(k);};j.prototype.getVideoID=function(){'use strict';return this.$VideoUploader2.getVideoID();};j.prototype.cancel=function(){'use strict';if(!this.$VideoUploader2)return;this.$VideoUploader2.cancel();this.$VideoUploader2=null;};j.prototype.abandon=function(){'use strict';if(!this.$VideoUploader2)return;this.$VideoUploader2.abandon();this.$VideoUploader2=null;};j.prototype.reset=function(){'use strict';this.$VideoUploader2=null;};j.prototype.getUploadSession=function(){'use strict';return this.$VideoUploader2;};j.prototype.getLoggerData=function(){'use strict';return {waterfall_id:this.$VideoUploader2?this.$VideoUploader2.$VideoUploader5:null,actor_id:this.$VideoUploader1.actor_id,target_id:this.$VideoUploader1.target_id,target_type:this.$VideoUploader1.target_type,composer_entry_point_ref:this.$VideoUploader1.composer_entry_point_ref};};j.prototype.isPostInProgress=function(){'use strict';return !!this.$VideoUploader2&&this.$VideoUploader2.isPostInProgress();};j.prototype.isSessionInProgress=function(){'use strict';return !!this.$VideoUploader2&&this.$VideoUploader2.isInProgress();};j.prototype.getUploadParameters=function(){'use strict';return this.$VideoUploader1;};j.prototype.__getSession=function(){'use strict';return this.$VideoUploader2;};j.prototype.__getEventsForWhichSessionShouldBeSetToNull=function(){'use strict';return ['upload-failed','post-finished','multimedia-upload-finished'];};j.prototype.$VideoUploader4=function(event,k){'use strict';if(c('arrayContains')(this.__getEventsForWhichSessionShouldBeSetToNull(),event))this.$VideoUploader2=null;this.__delegateEvent(event,k);};j.prototype.__delegateEvent=function(event,k){'use strict';this.inform(event,k);};f.exports=j;}),null);
__d('ReactComposerVideoXUploader',['invariant','ReactComposerEvents','ReactComposerMediaUploadActions','ReactComposerMediaUploadStore','ReactComposerMediaUploadType','ReactComposerMediaFilterUtils','ReactComposerMediaUploadActionType','VideoUploader','VideoUploadProgressBar','Arbiter','DOM','ifRequired','JSLogger','Map','PhotosUploadID','SubscriptionsHandler','VideoUploadFile','MultimediaUploadProcessingDialog.react','React','ReactDOM','Run','Set','throttle','ReactComposerMediaUtils'],(function a(b,c,d,e,f,g,h){'use strict';var i=250;function j(k){this.$ReactComposerVideoXUploader10=function(){var l=c('DOM').create('div');c('DOM').appendContent(document.body,l);var m=this.$ReactComposerVideoXUploader6>0;c('ifRequired')('ReactComposerOptimisticPostingStore',function(n){if(n.hadOptimisticallyPosted(this.$ReactComposerVideoXUploader1))m=false;}.bind(this),function(){});if(m)c('ReactDOM').render(c('React').createElement(c('MultimediaUploadProcessingDialog.react'),{numOfVideos:this.$ReactComposerVideoXUploader6}),l);}.bind(this);this.$ReactComposerVideoXUploader3=k;this.$ReactComposerVideoXUploader2=new (c('SubscriptionsHandler'))();this.$ReactComposerVideoXUploader6=0;this.$ReactComposerVideoXUploader7=new (c('Map'))();this.$ReactComposerVideoXUploader8=new (c('Set'))();this.$ReactComposerVideoXUploader9=false;k.composerID||h(0);k.uploaderParams||h(0);this.$ReactComposerVideoXUploader2.addSubscriptions(c('Arbiter').subscribe(c('ReactComposerEvents').POST_SUCCEEDED+k.composerID,c('throttle')(this.$ReactComposerVideoXUploader10,i,this)),c('Arbiter').subscribe(c('ReactComposerEvents').POST_STARTED+k.composerID,c('throttle')(this.$ReactComposerVideoXUploader11,i,this)));this.$ReactComposerVideoXUploader1=k.composerID;this.$ReactComposerVideoXUploader4=k.uploaderParams;this.$ReactComposerVideoXUploader5=c('JSLogger').create('composer');c('Run').onLeave(function(){return this.cancelUploads();}.bind(this));c('Run').onUnload(function(){return this.cancelUploads();}.bind(this));}j.prototype.cancelUploads=function(){this.$ReactComposerVideoXUploader8.forEach(function(k){var l=k.uploadID;this.$ReactComposerVideoXUploader8['delete'](k);var m=this.$ReactComposerVideoXUploader7.get(l);if(m)m.abandon();}.bind(this));this.$ReactComposerVideoXUploader9=false;};j.prototype.upload=function(k){k.forEach(function(m){if(!c('ReactComposerMediaFilterUtils').hasVideos([m.name]))return;if(!m.uploadID)m.uploadID=c('PhotosUploadID').getNewID();this.$ReactComposerVideoXUploader12(m);}.bind(this));var l=k.find(function(m){return c('ReactComposerMediaFilterUtils').hasVideos([m.name]);});if(!this.$ReactComposerVideoXUploader9&&l)this.uploadVideo(l);};j.prototype.uploadVideo=function(k){if(!k)return;this.$ReactComposerVideoXUploader9=true;var l=JSON.parse(JSON.stringify(this.$ReactComposerVideoXUploader4));l.isMultiMediaPost=true;var m=new (c('VideoUploader'))(l);this.$ReactComposerVideoXUploader7.set(k.uploadID,m);var n=c('VideoUploadFile').fromFile(k);this.$ReactComposerVideoXUploader2.addSubscriptions(m.subscribe('upload-started',this.$ReactComposerVideoXUploader13.bind(this,k)),m.subscribe('upload-progressed',this.$ReactComposerVideoXUploader14.bind(this,k)),m.subscribe('upload-failed',this.$ReactComposerVideoXUploader15.bind(this,k)),m.subscribe('upload-finished',this.$ReactComposerVideoXUploader16.bind(this,k)));try{m.upload(n);}catch(o){this.$ReactComposerVideoXUploader5.error('error_send_unpublished_files',o);throw o;}};j.prototype.cancelUpload=function(k){var l=this.$ReactComposerVideoXUploader7.get(k);if(l){l.cancel();l.reset();this.$ReactComposerVideoXUploader7['delete'](k);if(this.$ReactComposerVideoXUploader8.size>0){var m=this.$ReactComposerVideoXUploader8.values().next().value;this.uploadVideo(m);}else this.$ReactComposerVideoXUploader9=false;}this.deleteUpload(k);};j.prototype.deleteUpload=function(k){this.$ReactComposerVideoXUploader8.forEach(function(l){if(l.uploadID===k)this.$ReactComposerVideoXUploader8['delete'](l);}.bind(this));};j.prototype.$ReactComposerVideoXUploader16=function(k,l,m){c('ReactComposerMediaUploadActions').doneUploading(this.$ReactComposerVideoXUploader1,k.uploadID,c('ReactComposerMediaUploadActionType').VIDEO_UPLOAD_DONE,k,0,m.video_id,'','');var n=this.$ReactComposerVideoXUploader7.get(k.uploadID);if(n){n.reset();this.$ReactComposerVideoXUploader7['delete'](k.uploadID);}c('ReactComposerMediaUtils').changeToPeopleTaggerAfterUpload(this.$ReactComposerVideoXUploader1);this.$ReactComposerVideoXUploader9=false;this.$ReactComposerVideoXUploader8['delete'](k);if(this.$ReactComposerVideoXUploader8.size>0){var o=this.$ReactComposerVideoXUploader8.values().next().value;this.uploadVideo(o);}};j.prototype.$ReactComposerVideoXUploader12=function(k){this.$ReactComposerVideoXUploader8.add(k);c('ReactComposerMediaUploadActions').enqueue(this.$ReactComposerVideoXUploader1,k.uploadID,k.name,c('ReactComposerMediaUploadStore').getUploads(this.$ReactComposerVideoXUploader1).size,c('ReactComposerMediaUploadActionType').VIDEO_UPLOAD_ENQUEUED,c('ReactComposerMediaUploadType').VIDEO,URL.createObjectURL(k));};j.prototype.$ReactComposerVideoXUploader13=function(k,l){c('ReactComposerMediaUploadActions').startUploading(this.$ReactComposerVideoXUploader1,k.uploadID,k,c('ReactComposerMediaUploadActionType').VIDEO_UPLOAD_UPLOADING);};j.prototype.$ReactComposerVideoXUploader14=function(k,l,m){var n=c('VideoUploadProgressBar').computeProgress(m.start_offset,m.sent_bytes,m.file_size,0,0);c('ReactComposerMediaUploadActions').progressUploading(this.$ReactComposerVideoXUploader1,k.uploadID,Math.round(n));};j.prototype.$ReactComposerVideoXUploader15=function(k,l,m){var n={code:m.error_code,description:m.error_description,summary:m.error_summary,transient:m.error_is_transient||m.error_code==1004||m.error_code==1006};c('ReactComposerMediaUploadActions').failUploading(this.$ReactComposerVideoXUploader1,k.uploadID,k,0,n,c('ReactComposerMediaUploadActionType').VIDEO_UPLOAD_FAILED);};j.prototype.$ReactComposerVideoXUploader11=function(){this.$ReactComposerVideoXUploader6=c('ReactComposerMediaUploadStore').getUploadsCount(this.$ReactComposerVideoXUploader1,c('ReactComposerMediaUploadType').VIDEO);};j.prototype.destroy=function(){this.$ReactComposerVideoXUploader2.release();};f.exports=j;}),null);
__d('ReactComposerPhotoLegacyLimitExceededDialog',['fbt','DOM','LayerDestroyOnHide','React','ReactDOM','XUIDialog.react','XUIDialogBody.react','XUIDialogFooter.react','XUIDialogOkayButton.react','XUIDialogTitle.react'],(function a(b,c,d,e,f,g,h){var i={show:function j(k){var l=h._("Se han a\u00f1adido demasiadas fotos"),m=h._("Solo puedes a\u00f1adir {maxselect} fotos a una publicaci\u00f3n. Para a\u00f1adir m\u00e1s fotos, prueba a crear un \u00e1lbum.",[h.param('maxselect',k)]),n=c('DOM').create('div');c('ReactDOM').render(c('React').createElement(c('XUIDialog.react'),{shown:true,behaviors:{LayerDestroyOnHide:c('LayerDestroyOnHide')},width:600},c('React').createElement(c('XUIDialogTitle.react'),null,c('React').createElement('span',null,l)),c('React').createElement(c('XUIDialogBody.react'),null,m),c('React').createElement(c('XUIDialogFooter.react'),null,c('React').createElement(c('XUIDialogOkayButton.react'),{use:'confirm',action:'cancel'}))),n);}};f.exports=i;}),null);
__d('ReactComposerVideoLegacyLimitExceededDialog',['fbt','ErrorDialog'],(function a(b,c,d,e,f,g,h){var i={show:function j(){c('ErrorDialog').show(h._("Demasiados archivos"),h._("Selecciona un v\u00eddeo cada vez."));}};f.exports=i;}),null);
__d('ReactComposerVideoUploadActionType',['keyMirrorRecursive'],(function a(b,c,d,e,f,g){f.exports=c('keyMirrorRecursive')({VIDEO_SET_UPLOADER:null,VIDEO_UPLOAD_ADD:null,VIDEO_UPLOAD_REMOVE:null},'ReactComposerVideoUploadActionType');}),null);
__d('ReactComposerVideoUploadStore',['ReactComposerStoreBase','ReactComposerVideoUploadActionType','immutable'],(function a(b,c,d,e,f,g){var h,i,j=c('immutable').Record({file:null});h=babelHelpers.inherits(k,c('ReactComposerStoreBase'));i=h&&h.prototype;function k(){'use strict';var l;i.constructor.call(this,function(){return {uploader:null,video:null};},function(m){switch(m.type){case c('ReactComposerVideoUploadActionType').VIDEO_SET_UPLOADER:l&&l.$ReactComposerVideoUploadStore1(m);break;case c('ReactComposerVideoUploadActionType').VIDEO_UPLOAD_ADD:l&&l.$ReactComposerVideoUploadStore2(m);break;case c('ReactComposerVideoUploadActionType').VIDEO_UPLOAD_REMOVE:l&&l.$ReactComposerVideoUploadStore3(m);break;default:}});l=this;}k.prototype.getUploader=function(l){'use strict';return this.getComposerData(l).uploader;};k.prototype.getVideo=function(l){'use strict';return this.getComposerData(l).video;};k.prototype.$ReactComposerVideoUploadStore1=function(l){'use strict';var m=this.validateAction(l,['composerID','uploader']),n=m[0],o=m[1],p=this.getComposerData(n);p.uploader=o;this.emitChange(n);};k.prototype.$ReactComposerVideoUploadStore2=function(l){'use strict';var m=this.validateAction(l,['composerID','file']),n=m[0],o=m[1],p=this.getComposerData(n);p.video=new j({file:o});this.emitChange(n);};k.prototype.$ReactComposerVideoUploadStore3=function(l){'use strict';var m=this.validateAction(l,'composerID'),n=this.getComposerData(m);n.video=null;n.input&&n.input.clear();this.emitChange(m);};f.exports=new k();}),null);
__d('ReactComposerVideoUploadActions',['ReactComposerDispatcher','ReactComposerVideoUploadActionType','ReactComposerVideoUploadStore'],(function a(b,c,d,e,f,g){c('ReactComposerVideoUploadStore');var h={setUploader:function i(j,k){c('ReactComposerDispatcher').dispatch({composerID:j,type:c('ReactComposerVideoUploadActionType').VIDEO_SET_UPLOADER,uploader:k});},add:function i(j,k){c('ReactComposerDispatcher').dispatch({composerID:j,type:c('ReactComposerVideoUploadActionType').VIDEO_UPLOAD_ADD,file:k});},remove:function i(j){c('ReactComposerDispatcher').dispatch({composerID:j,type:c('ReactComposerVideoUploadActionType').VIDEO_UPLOAD_REMOVE});}};f.exports=h;}),null);
__d('ReactComposerMediaUtils',['invariant','ReactComposerAttachmentStore','ReactComposerAttachmentType','ReactComposerLoggingName','ReactComposerMediaUploadType','ReactComposerMediaFilterUtils','ReactComposerPhotoActions','ReactComposerPhotoLegacyLimitExceededDialog','ReactComposerMediaUploadActions','ReactComposerMediaUploadStore','ReactComposerTaggerActions','ReactComposerTaggerStore','ReactComposerTaggerType','ReactComposerVideoLegacyLimitExceededDialog','ReactComposerVideoUploadStore','ReactComposerVideoUploadActions','Arbiter','Bootloader','Map','PUWMethods','VideoUploadFeatureDetector','VideoUploader','VideoUploadFile','curry','uniqueID'],(function a(b,c,d,e,f,g,h){'use strict';var i={clearInput:function j(k,l){var m=this.getFileNamesFromFileInput(k.getInput());if(l||!i.hasVideos(m))k.clear();},getFileNames:function j(k){var l=[];for(var m=0;m<k.length;m++)l.push(k[m].name);return l;},getFileNamesFromFileInput:function j(k){if(c('VideoUploadFeatureDetector').supportsFileAPI()){return this.getFileNames(k.files);}else return [k.value.split('/').pop().split('\\').pop()];},hasVideos:function j(k){return c('ReactComposerMediaFilterUtils').hasVideos(k);},hasAudioFiles:function j(k){return c('ReactComposerMediaFilterUtils').hasAudioFiles(k);},filterVideos:function j(k){return c('ReactComposerMediaFilterUtils').filterVideos(k);},filterAudioFiles:function j(k){return c('ReactComposerMediaFilterUtils').filterAudioFiles(k);},filterFileOfSupportedType:function j(k,l){return c('ReactComposerMediaFilterUtils').filterFileOfSupportedType(k,l);},uploadVideo:function j(k,l){var m=c('ReactComposerMediaUploadStore').getUploadsOfType(k,c('ReactComposerMediaUploadType').PHOTO);if(m.size>0)c('ReactComposerMediaUploadActions').removeAllPhotoUploads(k,m);c('ReactComposerVideoUploadActions').add(k,l);},uploadPhotos:function j(k,l,m,n,o,p){var q=m.isUploadLimitExceeded(n,l);if(q){c('ReactComposerPhotoLegacyLimitExceededDialog').show(m.getMaxSelectableFilesCount(n));return;}var r=l?l.length:1;if(r<1)return;if(c('ReactComposerVideoUploadStore').getVideo(k))c('ReactComposerVideoUploadActions').remove(k);c('ReactComposerMediaUploadActions').photosSelect(k,r,o);p&&p();},uploadVideosFromTarget:function j(k,l,m,n,o){if(o){this.uploadMultiMediaFromTarget(k,l,m,n,o);}else{if(l.files&&l.files.length>1){c('ReactComposerVideoLegacyLimitExceededDialog').show();return;}this.uploadVideo(k,c('VideoUploadFile').fromFileInput(l));}},uploadVideos:function j(k,l,m,n,o){if(o){this.uploadMultiMedia(k,l,m,n);}else{if(l&&l.length>1){c('ReactComposerVideoLegacyLimitExceededDialog').show();return;}this.uploadVideo(k,c('VideoUploadFile').fromFile(l[0]));}},uploadMultiMediaFromTarget:function j(k,l,m,n,o){var p=this.getVideoXUploader(k);p.upload(Array.from(l.files));this.uploadPhotos(k,l.files,m,n,c('PUWMethods').FILE_SELECTOR,function(){m&&m.upload(l);},o);},uploadPhotosOrVideoFromTarget:function j(k,l,m,n,o){var p=this.getFileNamesFromFileInput(l);if(this.hasVideos(p)){this.uploadVideosFromTarget(k,l,m,n,o);}else this.uploadPhotos(k,l.files,m,n,c('PUWMethods').FILE_SELECTOR,function(){m&&m.upload(l);});},uploadMultiMedia:function j(k,l,m,n){var o=arguments.length<=4||arguments[4]===undefined?c('PUWMethods').FILE_SELECTOR:arguments[4],p=this.getVideoXUploader(k);p.upload(l);var q=l.filter(function(r){return !this.hasVideos([r.name]);}.bind(this));this.uploadPhotos(k,q,m,n,o,function(){q.forEach(function(r){r.uploadID=c('uniqueID')();r.filename='';});m.enqueueAsyncUploadRequest(k,q,{},{},false);});},uploadPhotosOrVideo:function j(k,l,m,n){var o=arguments.length<=4||arguments[4]===undefined?c('PUWMethods').FILE_SELECTOR:arguments[4],p=arguments[5],q=this.getFileNames(l);if(this.hasVideos(q)){this.uploadVideos(k,l,m,n,p);}else this.uploadPhotos(k,l,m,n,o,function(){l.forEach(function(r){r.uploadID=c('uniqueID')();r.filename='';});m.enqueueAsyncUploadRequest(k,l,{},{},false);});},subscribeToImageEdit:function j(k,l){return c('Arbiter').subscribe(['AttachmentsPhotoEditor/newImage'+k,'AttachmentsPhotoEditor/tagsUpdated'+k],c('curry')(i.onImageEdited,k,l));},onImageEdited:function j(k,l,m,n){if(m==='AttachmentsPhotoEditor/newImage'+k){var o=c('ReactComposerMediaUploadStore').getUploadsOfType(k,c('ReactComposerMediaUploadType').PHOTO),p=o.find(function(t){return (t.photoID===n.fbid||t.originalPhotoID===n.fbid);}),q=c('ReactComposerMediaUploadStore').getUploadIndex(k,p.id);c('ReactComposerPhotoActions').removePhoto(k,p.photoID,p.id);var r=n.blob;r.uploadID=c('uniqueID')();r.name=p.filename||c('uniqueID')();var s=new (c('Map'))([[r.uploadID,q]]);l&&l.enqueueAsyncUploadRequest(k,[r],{data:{original_fbid:n.fbid,xy_tags:n.xyTags,stickers:n.stickers,text_overlays:n.textOverlays,has_crop:n.hasCrop,has_filter:n.hasFilter},indexMap:s},{xyTags:n.xyTags},false);c('ReactComposerMediaUploadActions').photosSelect(k,1,c('PUWMethods').METHOD_EDITOR);}else if(m==='AttachmentsPhotoEditor/tagsUpdated'+k)i.handleFaceboxAndXYTags(k,n.fbid,n.xyTags);c('ReactComposerPhotoActions').finishPhotoEdit(k);},handleFaceboxAndXYTags:function j(k,l,m){c('ReactComposerPhotoActions').untagAllForPhoto(k,l);m.forEach(function(n){if(n.from_facebox){c('ReactComposerPhotoActions').tagFacebox(k,l,n.facebox,n.subject,n.name);}else if(n.is_product_tag){c('ReactComposerPhotoActions').tagXYProduct(k,l,n.name,n.source,n.subject,n.x,n.y);}else c('ReactComposerPhotoActions').tagXY(k,l,n.name,n.source,n.subject,n.x,n.y);});},handleXYTagsOnly:function j(k,l,m){m.forEach(function(n){if(n.from_facebox){return;}else c('ReactComposerPhotoActions').tagXY(k,l,n.name,n.source,n.subject,n.x,n.y);});},handleVideoUploadForDroppedFiles:function j(k,l,m){var n=c('ReactComposerMediaUploadStore').getUploadsCount(m.composerID)>0;if(n)return false;var o=this.getFileNames(k);if(!o||o.length!==1)return false;var p=i.hasVideos(o);if(p){c('Bootloader').loadModules(["ComposerXVideoUploadDialogController"],function(q){return (q.showDialog({targetID:m.targetID,files:k,composerEntryPointRef:m.composerType,canShowOptimisticPost:l.shouldShowOptimisticVideoPost}));},'ReactComposerMediaUtils');return true;}return false;},handleSpecialMediaUpload:function j(event,k,l,m){var n=c('ReactComposerMediaUploadStore').getUploadsCount(m.composerID)>0;if(!l.useVideoUploadDialog||n)return false;var o=event.target;if(!o||!o.files||o.files.length!==1)return false;var p=i.getFileNamesFromFileInput(o),q=i.hasVideos(p),r=i.hasAudioFiles(p);if(r&&l.canUploadAudio){c('Bootloader').loadModules(["ComposerXAudioUploadDialogController"],function(s){return (s.showDialog({targetID:m.targetID,fileInput:k,originalComposerID:m.composerID}));},'ReactComposerMediaUtils');return true;}else if(q){c('Bootloader').loadModules(["ComposerXVideoUploadDialogController"],function(s){return (s.showDialog({targetID:m.targetID,fileInput:k,composerEntryPointRef:m.composerType,canShowOptimisticPost:l.shouldShowOptimisticVideoPost,originalComposerID:m.composerID}));},'ReactComposerMediaUtils');return true;}return false;},isMultimediaPost:function j(k){return (c('ReactComposerMediaUploadStore').getUploadsCount(k,c('ReactComposerMediaUploadType').VIDEO)>0&&c('ReactComposerMediaUploadStore').getUploadsCount(k,c('ReactComposerMediaUploadType').PHOTO)>0);},getVideoXUploader:function j(k){var l=c('ReactComposerAttachmentStore').getAttachmentsConfig(k,c('ReactComposerAttachmentType').MEDIA);l||h(0);var m=c('ReactComposerMediaUploadStore').getVideoUploader(k,l.videoUploadParams);return m;},getVideoUploader:function j(k){var l=c('ReactComposerAttachmentStore').getAttachmentsConfig(k,c('ReactComposerAttachmentType').MEDIA);l||h(0);var m=JSON.parse(JSON.stringify(l.videoUploadParams));return new (c('VideoUploader'))(m);},changeToPeopleTaggerAfterUpload:function j(k){var l=c('ReactComposerTaggerStore').getSelectedTagger(k),m=c('ReactComposerAttachmentStore').getIsAttachmentSelected(k,c('ReactComposerAttachmentType').MEDIA);if(l===null&&m)c('ReactComposerTaggerActions').selectTaggerWithoutAutofocus(k,c('ReactComposerLoggingName').PHOTO_UPLOAD_DONE,c('ReactComposerTaggerType').PEOPLE);}};f.exports=i;}),null);
/*
 * @preserve-header
 *
 * Javascript EXIF Reader 0.1.6
 * Copyright (c) 2008 Jacob Seidelin, jseidelin@nihilogic.dk, http://blog.nihilogic.dk/
 * Licensed under the MPL License [http://www.nihilogic.dk/licenses/mpl-license.txt]
 */__d("exif/exif",[],(function a(b,c,d,e,f,g){var h=(function(){var i={36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRation",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",40965:"InteroperabilityIFDPointer",42016:"ImageUniqueID"},j={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright"},k={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential"},l={ExposureProgram:{0:"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Not defined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},Components:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"}};function m(y,event,z){if(y.addEventListener){y.addEventListener(event,z,false);}else if(y.attachEvent)y.attachEvent("on"+event,z);}function n(y){return !!(y.exifdata);}function o(y,z){BinaryAjax(y.src,function(aa){var ba=p(aa.binaryResponse);y.exifdata=ba||{};if(z)z.call(y);});}function p(y){if(y.getByteAt(0)!=255||y.getByteAt(1)!=216)return false;var z=2,aa=y.getLength(),ba;while(z<aa){if(y.getByteAt(z)!=255)return false;ba=y.getByteAt(z+1);if(ba==22400){return s(y,z+4,y.getShortAt(z+2,true)-2);}else if(ba==225){return s(y,z+4,y.getShortAt(z+2,true)-2);}else z+=2+y.getShortAt(z+2,true);}}function q(y,z,aa,ba,ca){var da=y.getShortAt(aa,ca),ea={},fa,ga,ha;for(ha=0;ha<da;ha++){fa=aa+ha*12+2;ga=ba[y.getShortAt(fa,ca)];ea[ga]=r(y,fa,z,aa,ca);}return ea;}function r(y,z,aa,ba,ca){var da=y.getShortAt(z+2,ca),ea=y.getLongAt(z+4,ca),fa=y.getLongAt(z+8,ca)+aa,ga,ha,ia,ja,ka,la;switch(da){case 1:case 7:if(ea==1){return y.getByteAt(z+8,ca);}else{ga=ea>4?fa:(z+8);ha=[];for(ja=0;ja<ea;ja++)ha[ja]=y.getByteAt(ga+ja);return ha;}case 2:ga=ea>4?fa:(z+8);return y.getStringAt(ga,ea-1);case 3:if(ea==1){return y.getShortAt(z+8,ca);}else{ga=ea>2?fa:(z+8);ha=[];for(ja=0;ja<ea;ja++)ha[ja]=y.getShortAt(ga+2*ja,ca);return ha;}case 4:if(ea==1){return y.getLongAt(z+8,ca);}else{ha=[];for(var ja=0;ja<ea;ja++)ha[ja]=y.getLongAt(fa+4*ja,ca);return ha;}case 5:if(ea==1){ka=y.getLongAt(fa,ca);la=y.getLongAt(fa+4,ca);ia=new Number(ka/la);ia.numerator=ka;ia.denominator=la;return ia;}else{ha=[];for(ja=0;ja<ea;ja++){ka=y.getLongAt(fa+8*ja,ca);la=y.getLongAt(fa+4+8*ja,ca);ha[ja]=new Number(ka/la);ha[ja].numerator=ka;ha[ja].denominator=la;}return ha;}case 9:if(ea==1){return y.getSLongAt(z+8,ca);}else{ha=[];for(ja=0;ja<ea;ja++)ha[ja]=y.getSLongAt(fa+4*ja,ca);return ha;}case 10:if(ea==1){return y.getSLongAt(fa,ca)/y.getSLongAt(fa+4,ca);}else{ha=[];for(ja=0;ja<ea;ja++)ha[ja]=y.getSLongAt(fa+8*ja,ca)/y.getSLongAt(fa+4+8*ja,ca);return ha;}}}function s(y,z){if(y.getStringAt(z,4)!="Exif")return false;var aa,ba,ca,da,ea,fa=z+6;if(y.getShortAt(fa)==18761){aa=false;}else if(y.getShortAt(fa)==19789){aa=true;}else return false;if(y.getShortAt(fa+2,aa)!=42)return false;if(y.getLongAt(fa+4,aa)!=8)return false;ba=q(y,fa,fa+8,j,aa);if(ba.ExifIFDPointer){da=q(y,fa,fa+ba.ExifIFDPointer,i,aa);for(ca in da){switch(ca){case "LightSource":case "Flash":case "MeteringMode":case "ExposureProgram":case "SensingMethod":case "SceneCaptureType":case "SceneType":case "CustomRendered":case "WhiteBalance":case "GainControl":case "Contrast":case "Saturation":case "Sharpness":case "SubjectDistanceRange":case "FileSource":da[ca]=l[ca][da[ca]];break;case "ExifVersion":case "FlashpixVersion":da[ca]=String.fromCharCode(da[ca][0],da[ca][1],da[ca][2],da[ca][3]);break;case "ComponentsConfiguration":da[ca]=l.Components[da[ca][0]]+l.Components[da[ca][1]]+l.Components[da[ca][2]]+l.Components[da[ca][3]];break;}ba[ca]=da[ca];}}if(ba.GPSInfoIFDPointer){ea=q(y,fa,fa+ba.GPSInfoIFDPointer,k,aa);for(ca in ea){switch(ca){case "GPSVersionID":ea[ca]=ea[ca][0]+"."+ea[ca][1]+"."+ea[ca][2]+"."+ea[ca][3];break;}ba[ca]=ea[ca];}}return ba;}function t(y,z){if(!y.complete)return false;if(!n(y)){o(y,z);}else if(z)z.call(y);return true;}function u(y,z){if(!n(y))return;return y.exifdata[z];}function v(y){if(!n(y))return {};var z,aa=y.exifdata,ba={};for(z in aa)if(aa.hasOwnProperty(z))ba[z]=aa[z];return ba;}function w(y){if(!n(y))return "";var z,aa=y.exifdata,ba="";for(z in aa)if(aa.hasOwnProperty(z))if(typeof aa[z]=="object"){if(aa[z] instanceof Number){ba+=z+" : "+aa[z]+" ["+aa[z].numerator+"/"+aa[z].denominator+"]\r\n";}else ba+=z+" : ["+aa[z].length+" values]\r\n";}else ba+=z+" : "+aa[z]+"\r\n";return ba;}function x(y){return p(y);}return {readFromBinaryFile:x,pretty:w,getTag:u,getAllTags:v,getData:t,Tags:i,TiffTags:j,GPSTags:k,StringValues:l};})();f.exports=h;}),null);
__d('ImageExif',['exif/exif'],(function a(b,c,d,e,f,g){function h(k){this.getByteAt=function(l){return k.getUint8(l);};this.getShortAt=function(l,m){return k.getUint16(l,!m);};this.getSShortAt=function(l,m){return k.getInt16(l,!m);};this.getLongAt=function(l,m){return k.getUint32(l,!m);};this.getSLongAt=function(l,m){return k.getInt32(l,!m);};this.getStringAt=function(l,m){var n=Array(m);for(var o=0;o<m;o++)n.push(String.fromCharCode(this.getByteAt(l+o)));return n.join('');};this.getLength=function(){return k.byteLength;};}function i(k){var l=function m(n){return k.charCodeAt(n)&255;};this.getByteAt=l;this.getShortAt=function(m,n){var o=this.getSShortAt(m,n);return o>0?o:o+65536;};this.getSShortAt=function(m,n){var o=l(m),p=l(m+1);return n?(o<<8)+p:(p<<8)+o;};this.getLongAt=function(m,n){var o=this.getSLongAt(m,n);return o>0?o:o+4294967296;};this.getSLongAt=function(m,n){var o=l(m),p=l(m+1),q=l(m+2),r=l(m+3);return n?(((o<<8)+p<<8)+q<<8)+r:(((r<<8)+q<<8)+p<<8)+o;};this.getStringAt=function(m,n){return k.substr(m,n);};this.getLength=function(){return k.length;};}var j={readFromFile:function k(l,m){var n=new FileReader();n.addEventListener('load',function(event){var o=event.target.result,p=o instanceof ArrayBuffer?this.readFromArrayBuffer(o):this.readFromBinaryString(o);m(p);}.bind(this),false);if(window.DataView){n.readAsArrayBuffer(l);}else n.readAsBinaryString(l);},readFromBinaryString:function k(l){return c('exif/exif').readFromBinaryFile(new i(l));},readFromArrayBuffer:function k(l){return c('exif/exif').readFromBinaryFile(new h(new DataView(l)));}};f.exports=j;}),null);
__d('StringEncoding',[],(function a(b,c,d,e,f,g){'use strict';function h(o,p){var q=new Uint8Array(o),r=0,s=[];while(r<q.length){var t=q[r],u=void 0;if(t>>7===0){u=1;}else if(t>>5===6){t&=31;u=2;}else if(t>>4===14){t&=15;u=3;}else if(t>>3===30){t&=7;u=4;}else if(t>>2===62){t&=3;u=5;}else if(t>>1===126){t&=1;u=6;}else throw new Error('Cannot decode as UTF-8 - '+'unrecognised codepoint header');if(r+u>q.length)throw new Error('Cannot decode as UTF-8 - '+'incomplete codepoint');for(var v=1;v<u;v++){var w=q[r+v];if(w>>6!==2)throw new Error('Cannot decode as UTF-8 - '+'unrecognised codepoint subsequent byte');w&=63;t<<=6;t|=w;}if(t>1114111)throw new Error('Cannot decode as UTF-8 - '+"JavaScript doesn't support codepoints over 0x10FFFF");if(!t)switch(p){case 'error':throw new Error('Cannot decode as UTF-8 - '+"contains a null and we're not allowing them");case 'ignore':continue;case 'truncate':return String.fromCodePoint.apply(String,s);case 'include':break;}s.push(t);r+=u;}return String.fromCodePoint.apply(String,s);}function i(o){return (o&255)<<8|o>>8;}function j(o,p){if(o.byteLength%2!==0)throw new Error('Cannot decode as UTF-16 - '+'data length mod 2 != 0');var q=new Uint16Array(o),r=0,s=[],t=false;if(q[0]===65279){++r;}else if(q[0]==65534){++r;t=true;}while(r<q.length){var u=q[r];if(t)u=i(u);var v=u;if(u>55295&&u<57344){if((u&64512)!==55296)throw new Error('Cannot decode as UTF-16 - '+'incorrect signature for high surrogate');if(r+1>=q.length)throw new Error('Cannot decode as UTF-16 - '+'incomplete codepoint');++r;var w=q[r];if(t)w=i(w);if((w&64512)!==56320)throw new Error('Cannot decode as UTF-16 - '+'incorrect signature for low surrogate');v=((u&1023)<<10|w&1023)+65536;}if(!v)switch(p){case 'error':throw new Error('Cannot decode as UTF-16 - '+"contains a null and we're not allowing them");case 'ignore':continue;case 'truncate':return String.fromCodePoint.apply(String,s);case 'include':break;}s.push(v);++r;}return String.fromCodePoint.apply(String,s);}function k(o){return ((o&255)<<24|(o&255<<8)<<8|(o&255<<16)>>8|o>>>24);}function l(o,p){if(o.byteLength%4!==0)throw new Error('Cannot decode as UTF-32 - '+'data length mod 4 != 0');var q=new Uint32Array(o),r=0,s=[],t=false;if(q[0]===65279){++r;}else if(q[0]==4294836224){++r;t=true;}while(r<q.length){var u=q[r];if(t)u=k(u);if(u&2147483648)throw new Error('Cannot decode as UTF-32 - '+'invalid codepoint');if(u>1114111)throw new Error('Cannot decode as UTF-32 - '+"JavaScript doesn't support codepoints over 0x10FFFF");if(!u)switch(p){case 'error':throw new Error('Cannot decode as UTF-32 - '+"contains a null and we're not allowing them");case 'ignore':continue;case 'truncate':return String.fromCodePoint.apply(String,s);case 'include':break;}s.push(u);++r;}return String.fromCodePoint.apply(String,s);}var m={'utf-8':h,'utf-16':j,'utf-32':l};function n(o,p){if(o){this.$Decoder1=o;}else this.$Decoder1=['utf-8','utf-16','utf-32'];if(!p)p='error';this.$Decoder2=p;for(var q=this.$Decoder1,r=Array.isArray(q),s=0,q=r?q:q[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var t;if(r){if(s>=q.length)break;t=q[s++];}else{s=q.next();if(s.done)break;t=s.value;}var u=t;this.$Decoder3(u);}}n.prototype.getPrecedence=function(){return this.$Decoder1;};n.prototype.decode=function(o){var p=[];for(var q=this.$Decoder1,r=Array.isArray(q),s=0,q=r?q:q[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var t;if(r){if(s>=q.length)break;t=q[s++];}else{s=q.next();if(s.done)break;t=s.value;}var u=t,v=this.$Decoder3(u);try{return v(o,this.$Decoder2);}catch(w){p.push(w);}}throw new Error(p.join(', '));};n.prototype.$Decoder3=function(o){var p=m[o];if(!p)throw new Error('Unknown encoding '+o);return p;};f.exports.Decoder=n;}),null);
__d('ImageMetadata',['regeneratorRuntime','Promise','StringEncoding','ImageExif','emptyFunction'],(function a(b,c,d,e,f,g){'use strict';function h(m){this.$ImageMetadata3='';this.$ImageMetadata5=m;this.$ImageMetadata6=new Uint8Array(m);this.$ImageMetadata7();}h.prototype.$ImageMetadata7=function(){var m=0;while(m<this.$ImageMetadata6.length){m=this.$ImageMetadata8(m);if(m===-1)return;var n=this.$ImageMetadata6[m+1],o=i[n];if(!o)return;var p=o.length;if(p===undefined)p=this.$ImageMetadata6[m+2]*256+this.$ImageMetadata6[m+3];this.$ImageMetadata9(m,p,o);if(o.name==='SOS')return;m+=2+p;}};h.prototype.$ImageMetadata9=function(m,n,o){switch(o.name){case 'APP1':if(this.$ImageMetadata10(m+4,j)){this.$ImageMetadata11(m+4+j.length,n-2-j.length);}else if(this.$ImageMetadata10(m+4,k)){this.$ImageMetadata12(m+4+k.length,n-2-k.length);}else if(this.$ImageMetadata10(m+4,l))this.$ImageMetadata13(m+4+l.length,n-2-l.length);break;case 'SOF0':case 'SOF1':case 'SOF2':case 'SOF3':case 'SOF5':case 'SOF6':case 'SOF7':case 'JPG':case 'SOF9':case 'SOF10':case 'SOF11':case 'SOF13':case 'SOF14':case 'SOF15':this.$ImageMetadata14(m+4,n-2);break;}};h.prototype.$ImageMetadata14=function(m,n){var o=this.$ImageMetadata6[m+3]*256+this.$ImageMetadata6[m+4],p=this.$ImageMetadata6[m+1]*256+this.$ImageMetadata6[m+2];if(o>0&&p>0)this.$ImageMetadata4={x:o,y:p};};h.prototype.$ImageMetadata11=function(m,n){var o=emptyFunction;try{emptyFunction=c('emptyFunction');var p=c('ImageExif').readFromArrayBuffer(this.$ImageMetadata5)||{};}finally{emptyFunction=o;}var q={};for(var r in p){var s=p[r];if(typeof s==='string')s=s.trim();q[r.trim()]=s;}this.$ImageMetadata1=q;};h.prototype.$ImageMetadata12=function(m,n){this.$ImageMetadata2={};var o=this.$ImageMetadata2,p=new (c('StringEncoding').Decoder)(null,'truncate');try{var r=p.decode(this.$ImageMetadata5.slice(m,m+n));this.$ImageMetadata3=r;}catch(q){return;}for(var s=0;s<r.length;++s){var t=r.indexOf('<GPano:',s);if(t==-1)break;var u=r.indexOf('>',t),v=r.substring(t+1,u).trim(),w=r.indexOf('<',u),x=r.substring(u+1,w).trim();o[v]=x;s=w;}for(var y=0;y<r.length;++y){var z=r.indexOf('GPano:',y);if(z==-1)break;var aa=r.indexOf('=',z),ba=r.substring(z,aa).trim(),ca=r.indexOf('"',z);if(ba.indexOf('>')==-1&&ba.indexOf('<')==-1){var da=r.indexOf('"',ca+1),ea=r.substring(ca+1,da).trim();o[ba]=ea;y=da;}}};h.prototype.$ImageMetadata13=function(m){};h.prototype.$ImageMetadata10=function(m,n){return n.split('').every(function(o){return this.$ImageMetadata6[m++]===o.charCodeAt(0);}.bind(this));};h.prototype.$ImageMetadata8=function(m){for(var n=m;n+1<this.$ImageMetadata6.length;++n)if(this.$ImageMetadata6[n]===255&&this.$ImageMetadata6[n+1]!==0&&this.$ImageMetadata6[n+1]!==255)return n;return -1;};h.prototype.hasExif=function(){return Boolean(this.$ImageMetadata1);};h.prototype.hasXMP=function(){return Boolean(this.$ImageMetadata2);};h.prototype.hasSize=function(){return Boolean(this.$ImageMetadata4);};h.prototype.getExif=function(){if(!this.$ImageMetadata1)throw new Error('Image has no Exif data');return this.$ImageMetadata1;};h.prototype.getXMP=function(){if(!this.$ImageMetadata2)throw new Error('Image has no XMP data');return this.$ImageMetadata2;};h.prototype.getXMPString=function(){return this.$ImageMetadata3;};h.prototype.getSize=function(){if(!this.$ImageMetadata4)throw new Error('Could not find size data?!');return this.$ImageMetadata4;};h.genMetadataFromBlob=function m(n){return c('regeneratorRuntime').async(function o(p){while(1)switch(p.prev=p.next){case 0:p.t0=h;p.next=3;return c('regeneratorRuntime').awrap(h.$ImageMetadata15(n));case 3:p.t1=p.sent;return p.abrupt('return',new p.t0(p.t1));case 5:case 'end':return p.stop();}},null,this);};h.$ImageMetadata15=function(m){return new (c('Promise'))(function(n,o){var p=new b.FileReader();p.onabort=o;p.onerror=o;p.onload=n;p.readAsArrayBuffer(m);});};var i=[];i[216]={name:'SOI',length:0};i[192]={name:'SOF0'};i[193]={name:'SOF1'};i[194]={name:'SOF2'};i[195]={name:'SOF3'};i[197]={name:'SOF5'};i[198]={name:'SOF6'};i[199]={name:'SOF7'};i[200]={name:'JPG'};i[201]={name:'SOF9'};i[202]={name:'SOF10'};i[203]={name:'SOF11'};i[205]={name:'SOF13'};i[206]={name:'SOF14'};i[207]={name:'SOF15'};i[196]={name:'DHT'};i[219]={name:'DQT'};i[221]={name:'DRI',length:2};i[218]={name:'SOS'};i[208]={name:'RST0',length:0};i[209]={name:'RST1',length:0};i[210]={name:'RST2',length:0};i[211]={name:'RST3',length:0};i[212]={name:'RST4',length:0};i[213]={name:'RST5',length:0};i[214]={name:'RST6',length:0};i[215]={name:'RST7',length:0};i[224]={name:'APP0'};i[225]={name:'APP1'};i[226]={name:'APP2'};i[227]={name:'APP3'};i[228]={name:'APP4'};i[229]={name:'APP5'};i[230]={name:'APP6'};i[231]={name:'APP7'};i[232]={name:'APP8'};i[233]={name:'APP9'};i[234]={name:'APP10'};i[235]={name:'APP11'};i[236]={name:'APP12'};i[237]={name:'APP13'};i[238]={name:'APP14'};i[239]={name:'APP15'};i[254]={name:'COM'};i[217]={name:'EOI',length:0};var j='Exif\0\0',k='http://ns.adobe.com/xap/1.0/\0',l='http://ns.adobe.com/xmp/extension/\0';f.exports=h;}),null);
__d('SphericalImage',['Promise','regeneratorRuntime','ImageMetadata'],(function a(b,c,d,e,f,g){'use strict';var h='GPano:ProjectionType',i=100,j='cylindrical';function k(y){return new (c('Promise'))(function(z,aa){if(b.FileReader){var ba=new b.FileReader();ba.onabort=aa;ba.onerror=aa;ba.onload=function(event){return z(event.target.result);};ba.readAsArrayBuffer(y);}else z(new ArrayBuffer(0));});}function l(y){if(!y.hasXMP())return false;var z=y.getXMP(),aa=Boolean(z['GPano:CroppedAreaImageWidthPixels']&&z['GPano:CroppedAreaImageHeightPixels']&&z['GPano:FullPanoWidthPixels']&&z['GPano:FullPanoHeightPixels']);if(aa)return true;var ba=y.getSize(),ca=Math.abs(ba.x-ba.y*2)<=2;if(z[h]==='equirectangular'&&ca)return true;var da=ba.x===ba.y*6||ba.y===ba.x*6,ea=Boolean(z[h]==='cubestrip'||z[h]==='cubemap');if(ea&&da)return true;return false;}var m={'iPhone 4S':{x:19334,y:3264},'iPhone 5':{x:18521,y:3264},'iPhone 5c':{x:18521,y:3264},'iPhone 5s':{x:17279,y:3264},'iPhone 6':{x:17731,y:3264},'iPhone 6 Plus':{x:17731,y:3264},'iPhone 6s':{x:21729,y:4000},'iPhone 6s Plus':{x:21729,y:4000},'iPhone SE':{x:21729,y:4000},'iPhone 7':{x:21842,y:3884},'iPhone 7 Plus':{x:21842,y:3884},'iPad Air':{x:14810,y:2592},'iPad Air 2':{x:18512,y:3264},'iPad Mini 2':{x:14810,y:2592},'iPad Mini 3':{x:14810,y:2592},'iPad Mini 4':{x:18512,y:3264},'iPad Pro':{x:18512,y:3264}},n={'sm-g90':{minHeight:2200,fullWidth:17000},'sm-n91':{minHeight:2200,fullWidth:17000},'sm-g92':{minHeight:2200,fullWidth:15550},'sm-n92':{minHeight:2200,fullWidth:15550},'sm-g93':{minHeight:2800,fullWidth:20200},'sm-n93':{minHeight:2800,fullWidth:20200}};function o(y){if(!y.hasExif())return false;return (s(y)||r(y)||t(y));}var p=[{make:'ricoh',model:'ricoh theta s'},{make:'ricoh',model:'ricoh theta m15'},{make:'samsung',model:'sm-c200'},{make:'lg electronics',model:'lg-r105'},{make:'nikon',model:'keymission 360'}];function q(y,z){return p.some(function(aa){return aa.model===z&&aa.make===y;});}function r(y){var z=y.getExif(),aa=z.Make&&z.Make.toLowerCase(),ba=z.Model&&z.Model.toLowerCase(),ca=y.getSize();return ca.x===2*ca.y&&q(aa,ba);}function s(y){var z=y.getExif();if(z.Make!='Apple')return false;var aa=m[z.Model];if(!aa)return false;var ba=void 0,ca=void 0;if(z.ExifImageWidth&&z.ExifImageLength)if(!ca||z.ExifImageWidth>ca.x)ca={x:z.ExifImageWidth,y:z.ExifImageLength};if(z.ImageWidth&&z.ImageLength)if(!ca||z.ImageWidth>ca.x)ca={x:z.ImageWidth,y:z.ImageLength};if(z.OriginalImageWidth&&z.OriginalImageHeight)if(!ca||z.OriginalImageWidth>ca.x)ca={x:z.OriginalImageWidth,y:z.OriginalImageHeight};if(z.PixelXDimension&&z.PixelYDimension)if(!ca||z.PixelXDimension>ca.x)ca={x:z.PixelXDimension,y:z.PixelYDimension};if(y.hasSize()){ba=y.getSize();var da=u(ba);if(ca){var ea=u(ca);if(!v(da,ea))return false;}if(da<2)return false;}var fa=ca||ba;if(!fa)return false;if(!v(fa.y,aa.y,.3))return false;return true;}function t(y){var z=y.getExif(),aa=y.getSize(),ba=aa.x,ca=aa.y;if(String(z.Make).toLowerCase()!='samsung')return false;var da=String(z.Model).toLowerCase().trim(),ea=null;Object.keys(n).forEach(function(ha){if(da.includes(ha))ea=n[ha];});if(!ea)return false;if(z.Orientation===6){var fa=ba;ba=ca;ca=fa;}if(ca<ea.minHeight)return false;var ga=ba/ea.fullWidth*360;if(ga<i||ba<2*ca)return false;return true;}function u(y){return y.x/y.y;}function v(y,z){var aa=arguments.length<=2||arguments[2]===undefined?.05:arguments[2];return y>(1-aa)*z&&y<(1+aa)*z;}function w(y){return (l(y)||o(y));}function x(y){this.$SphericalImage1=y;this.$SphericalImage2=w(this.$SphericalImage1);}x.createFromBlob=function y(z){var aa;return c('regeneratorRuntime').async(function ba(ca){while(1)switch(ca.prev=ca.next){case 0:ca.next=2;return c('regeneratorRuntime').awrap(k(z));case 2:aa=ca.sent;return ca.abrupt('return',new this(new (c('ImageMetadata'))(aa)));case 4:case 'end':return ca.stop();}},null,this);};x.prototype.isSpherical=function(){return this.$SphericalImage2;};x.prototype.getMetadata=function(){return this.$SphericalImage1;};x.prototype.getSize=function(){return this.$SphericalImage1.getSize();};x.prototype.getProjectionType=function(){var y='';if(this.$SphericalImage1.hasXMP())y=this.$SphericalImage1.getXMP()[h]||'';if(this.isSpherical()&&!y)y=j;return y;};f.exports=x;}),null);
__d("XSphericalPhotoSphereMetadataAsyncController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/spherical_media\/photo\/metadata\/",{});}),null);
__d('SphericalImageExperimental',['Promise','regeneratorRuntime','ImageMetadata','XSphericalPhotoSphereMetadataAsyncController','XAsyncRequest'],(function a(b,c,d,e,f,g){'use strict';var h='ProjectionType',i=2048;function j(m,n,o){return new (c('Promise'))(function(p,q){new (c('XAsyncRequest'))(c('XSphericalPhotoSphereMetadataAsyncController').getURIBuilder().getURI()).setMethod('POST').setData({exif_string:JSON.stringify(o,function(r,s){if(r==='FocalLength'&&s.numerator&&s.denominator)return s.numerator+'/'+s.denominator;return s;}),height:m.height,width:m.width,xmp:n}).setHandler(p).setErrorHandler(q).send();});}function k(m){return new (c('Promise'))(function(n,o){var p=null,q=function s(){if(p){if(!p.hasExif()||!p.hasSize()){n({});return;}var t=p.getSize(),u=t.x,v=t.y,w=u,x=v;if(Math.max(w,x)<i||w/x<2&&x/w<2){n({});return;}var y=p.getExif(),z=p.getXMPString();if(z===''&&(!y.Make||!y.Model)){n({});return;}j({width:w,height:x},z,y).then(function(aa){var ba=aa.payload;n({photoSphereMetadata:ba,imageMetadata:p});})['catch'](o).done();}};if(b.FileReader){var r=new b.FileReader();r.onabort=o;r.onerror=o;r.onload=function(event){try{p=new (c('ImageMetadata'))(event.target.result);q();}catch(s){o(s);}};r.readAsArrayBuffer(m);}else n({});});}function l(m){this.props=m;}l.createFromBlob=function m(n){var o;return c('regeneratorRuntime').async(function p(q){while(1)switch(q.prev=q.next){case 0:q.next=2;return c('regeneratorRuntime').awrap(k(n));case 2:o=q.sent;return q.abrupt('return',new this(o));case 4:case 'end':return q.stop();}},null,this);};l.prototype.isSpherical=function(){return Boolean(this.props.photoSphereMetadata);};l.prototype.getMetadata=function(){return this.props.imageMetadata;};l.prototype.getSize=function(){if(this.props.imageMetadata)return this.props.imageMetadata.getSize();return null;};l.prototype.getProjectionType=function(){var m='';if(this.props.photoSphereMetadata&&this.props.photoSphereMetadata[h])m=this.props.photoSphereMetadata[h];return m;};f.exports=l;}),null);
__d('XComposerPhotoUploader',['regeneratorRuntime','Promise','AsyncUploadRequest','ReactComposerMediaUtils','FileInputUploader','JSLogger','PhotosMimeType','PhotosUploadID','QE','SphericalPhotoConfig','SphericalImage','SphericalImageExperimental','curry','emptyFunction','performanceNow'],(function a(b,c,d,e,f,g){'use strict';var h=b.URL||b.webkitURL||{};function i(j){this.$XComposerPhotoUploader2=j.uploadData||{};this.$XComposerPhotoUploader1=j.uploadEndpoint;this.$XComposerPhotoUploader3=j.retryLimit;this.$XComposerPhotoUploader4=j.concurrentLimit;this.$XComposerPhotoUploader5=j.resizer;this.$XComposerPhotoUploader6=j.onUploadEnqueued||c('emptyFunction');this.$XComposerPhotoUploader7=j.onUploadsEnqueued||c('emptyFunction');this.$XComposerPhotoUploader8=j.onResizeStart||c('emptyFunction');this.$XComposerPhotoUploader11=j.onResizeProgress||c('emptyFunction');this.$XComposerPhotoUploader9=j.onResizeSuccess||c('emptyFunction');this.$XComposerPhotoUploader10=j.onResizeFailure||c('emptyFunction');this.$XComposerPhotoUploader12=j.onSphericalCheckFailure||c('emptyFunction');this.$XComposerPhotoUploader13=j.onSphericalCheckSuccess||c('emptyFunction');this.$XComposerPhotoUploader14=j.onUploadIsSpherical||c('emptyFunction');this.$XComposerPhotoUploader15=j.onUploadSent||c('emptyFunction');this.$XComposerPhotoUploader16=j.onUploadStart||c('emptyFunction');this.$XComposerPhotoUploader17=j.onUploadProgress||c('emptyFunction');this.$XComposerPhotoUploader18=j.onUploadSuccess||c('emptyFunction');this.$XComposerPhotoUploader19=j.onUploadFailure||c('emptyFunction');this.$XComposerPhotoUploader20=c('JSLogger').create('composer');}i.prototype.upload=function(j,k){k=k||0;var l=Object.assign({},this.$XComposerPhotoUploader2),m=null;if(!this.$XComposerPhotoUploader21(j)){var n=c('PhotosUploadID').getNewID();j.uploadID=n;l.upload_id=n;this.$XComposerPhotoUploader6({uploadID:n,fileName:j.value.split('/').pop().split('\\').pop(),fileURL:h.createObjectURL?h.createObjectURL(j):null});}else{m=Array.from(j.files);m=m.filter(function(r){return !c('ReactComposerMediaUtils').hasVideos([r.name]);});if(m.length===0)return;var o=m.length+k;m.forEach(function(r){if(!r.uploadID)r.uploadID=c('PhotosUploadID').getNewID();var s=false;if(c('SphericalPhotoConfig').spherical_photo_www_upload)s=null;this.$XComposerPhotoUploader6({uploadID:r.uploadID,fileName:r.name,isSpherical:s,fileURL:h.createObjectURL?h.createObjectURL(r):null});}.bind(this));}this.$XComposerPhotoUploader7();var p=new (c('FileInputUploader'))(j).setURI(this.$XComposerPhotoUploader1).setData(l).setAllowCrossOrigin(true).setNetworkErrorRetryLimit(this.$XComposerPhotoUploader3).setUploadInParallel(true);if(m&&m.length>0){p.setFiles({farr:m});if(this.$XComposerPhotoUploader5){p.setPreprocessHandler(this.$XComposerPhotoUploader22.bind(this));}else p.setPreprocessHandler(this.$XComposerPhotoUploader23.bind(this));if(this.$XComposerPhotoUploader4)p.setConcurrentLimit(this.$XComposerPhotoUploader4);}p.subscribe('progress',function(r,s){return (this.$XComposerPhotoUploader17(this.$XComposerPhotoUploader24(s,j),s));}.bind(this));p.subscribe('failure',function(r,s){return (this.$XComposerPhotoUploader19(this.$XComposerPhotoUploader24(s,j),s,m));}.bind(this));p.subscribe('start',function(r,s){return (this.$XComposerPhotoUploader16(this.$XComposerPhotoUploader24(s,j),s));}.bind(this));p.subscribe('success',function(r,s){return (this.$XComposerPhotoUploader18(this.$XComposerPhotoUploader24(s,j),s));}.bind(this));try{p.send();this.$XComposerPhotoUploader15(j);}catch(q){this.$XComposerPhotoUploader20.error('error_send_unpublished_files',q);throw q;}};i.prototype.getAsyncUploadRequest=function(j,k){var l=new (c('AsyncUploadRequest'))().setData(Object.assign({},k&&k.data,this.$XComposerPhotoUploader2)).setFiles({farr:j}).setAllowCrossOrigin(true).setURI(this.$XComposerPhotoUploader1);if(this.$XComposerPhotoUploader4)l.setLimit(this.$XComposerPhotoUploader4);if(this.$XComposerPhotoUploader5)l.setPreprocessHandler(this.$XComposerPhotoUploader22.bind(this));l.subscribe('start',function(m,n){return (this.$XComposerPhotoUploader16(n.getFile().uploadID,{upload:n}));}.bind(this));l.subscribe('progress',function(m,n){return (this.$XComposerPhotoUploader17(n.getFile().uploadID,{upload:n,event:n.getProgressEvent()}));}.bind(this));l.subscribe('success',function(m,n){return (this.$XComposerPhotoUploader18(n.getFile().uploadID,{upload:n,response:n.getResponse()}));}.bind(this));l.subscribe('failure',function(m,n){return (this.$XComposerPhotoUploader19(n.getFile().uploadID,{upload:n,response:n.getResponse()},j));}.bind(this));return l;};i.prototype.$XComposerPhotoUploader24=function(j,k){if(j.upload){return j.upload.getFile().uploadID;}else return k.uploadID;};i.prototype.$XComposerPhotoUploader23=function(j,k){(function l(){return c('regeneratorRuntime').async(function m(n){while(1)switch(n.prev=n.next){case 0:n.next=2;return c('regeneratorRuntime').awrap(this.$XComposerPhotoUploader25(j,k));case 2:return n.abrupt('return',n.sent);case 3:case 'end':return n.stop();}},null,this);}).bind(this)().done();};i.prototype.$XComposerPhotoUploader25=function j(k,l){var m,n;return c('regeneratorRuntime').async(function o(p){while(1)switch(p.prev=p.next){case 0:m=k.getFile();p.next=3;return c('regeneratorRuntime').awrap(this.$XComposerPhotoUploader26(m));case 3:n=p.sent;if(n&&n.isSpherical()){this.$XComposerPhotoUploader14(m,n.isSpherical(),n.getProjectionType());}else this.$XComposerPhotoUploader14(m,false,'');l(k);case 6:case 'end':return p.stop();}},null,this);};i.prototype.$XComposerPhotoUploader22=function(j,k){(function l(){return c('regeneratorRuntime').async(function m(n){while(1)switch(n.prev=n.next){case 0:n.next=2;return c('regeneratorRuntime').awrap(this.$XComposerPhotoUploader27(j,k));case 2:return n.abrupt('return',n.sent);case 3:case 'end':return n.stop();}},null,this);}).bind(this)().done();};i.prototype.$XComposerPhotoUploader26=function j(k){var l,m,n;return c('regeneratorRuntime').async(function o(p){while(1)switch(p.prev=p.next){case 0:l=c('performanceNow')();m=c('SphericalPhotoConfig').www_spherical_photo_new_detector;p.prev=2;if(!m){p.next=9;break;}p.next=6;return c('regeneratorRuntime').awrap(c('SphericalImageExperimental').createFromBlob(k));case 6:p.t0=p.sent;p.next=12;break;case 9:p.next=11;return c('regeneratorRuntime').awrap(c('SphericalImage').createFromBlob(k));case 11:p.t0=p.sent;case 12:n=p.t0;if(n.isSpherical())c('QE').logExposure('spherical_photo');this.$XComposerPhotoUploader13(k,c('performanceNow')()-l,n.getProjectionType(),m);return p.abrupt('return',n);case 18:p.prev=18;p.t1=p['catch'](2);this.$XComposerPhotoUploader12(k,c('performanceNow')()-l,m);return p.abrupt('return',null);case 23:case 'end':return p.stop();}},null,this,[[2,18]]);};i.prototype.$XComposerPhotoUploader28=function(j){return this.$XComposerPhotoUploader29(this.$XComposerPhotoUploader5.resizeBlob.bind(this.$XComposerPhotoUploader5),j);};i.prototype.$XComposerPhotoUploader30=function(j){return this.$XComposerPhotoUploader29(this.$XComposerPhotoUploader5.resize360Blob.bind(this.$XComposerPhotoUploader5),j,c('SphericalPhotoConfig').upload_size_limit);};i.prototype.$XComposerPhotoUploader29=function(j,k,l){var m=c('curry')(this.$XComposerPhotoUploader11,k.uploadID),n=function(){return this.$XComposerPhotoUploader8(k);}.bind(this);return new (c('Promise'))(function(o,p){n();j(k,function(q,r,s){if(q){p(q);}else if(s){o(null);}else o(r);},m,l);});};i.prototype.$XComposerPhotoUploader27=function j(k,l){var m,n,o,p,q,r,s,t,u;return c('regeneratorRuntime').async(function v(w){while(1)switch(w.prev=w.next){case 0:m=k.getFile();if(!(!m||!c('PhotosMimeType').isJpeg(m.type))){w.next=5;break;}this.$XComposerPhotoUploader14(m,false,'');l(k);return w.abrupt('return');case 5:n=c('performanceNow')();w.prev=6;o=null;if(!c('SphericalPhotoConfig').spherical_photo_www_upload){w.next=12;break;}w.next=11;return c('regeneratorRuntime').awrap(this.$XComposerPhotoUploader26(m));case 11:o=w.sent;case 12:if(!(o&&o.isSpherical())){w.next=24;break;}this.$XComposerPhotoUploader14(m,true,o.getProjectionType());q=true;r=o.getSize();s=c('SphericalPhotoConfig').upload_size_limit;if(r&&Math.max(r.x,r.y)<=s)q=false;if(!q){w.next=22;break;}w.next=21;return c('regeneratorRuntime').awrap(this.$XComposerPhotoUploader30(m));case 21:p=w.sent;case 22:w.next=28;break;case 24:this.$XComposerPhotoUploader14(m,false,'');w.next=27;return c('regeneratorRuntime').awrap(this.$XComposerPhotoUploader28(m));case 27:p=w.sent;case 28:if(p){p.uploadID=m.uploadID;p.name=m.name;k.setFile(p);}t=p===null;k.getFile().filename=m.name;this.$XComposerPhotoUploader9(m,p||m,t,c('performanceNow')()-n);w.next=39;break;case 34:w.prev=34;w.t0=w['catch'](6);u=c('performanceNow')()-n;this.$XComposerPhotoUploader10(m,p||m,w.t0,u);case 39:l(k);case 40:case 'end':return w.stop();}},null,this,[[6,34]]);};i.prototype.$XComposerPhotoUploader21=function(j){return !!j.files&&c('AsyncUploadRequest').isSupported();};f.exports=i;}),null);