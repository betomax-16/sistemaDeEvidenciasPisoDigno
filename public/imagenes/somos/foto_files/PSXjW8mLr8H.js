if (self.CavalryLogger) { CavalryLogger.start_js(["MOjBh"]); }

__d('ConversationNubTabsUpdateEventController',['Arbiter'],(function a(b,c,d,e,f,g){'use strict';var h='ConversationNub/tabsUpdated',i='ConversationNub/minimizedByUser',j='ConversationNub/maximizedByUser',k=false;function l(p){if(!k)c('Arbiter').inform(h,p);}function m(p){return c('Arbiter').subscribe(h,function(q,r){k=true;p(r);k=false;});}function n(p,q){q&&c('Arbiter').inform(i,{tab:p});p.minimize();l();}function o(p,q){q&&c('Arbiter').inform(j,{tab:p});p.popOut();l();}f.exports={TAB_MINIMIZED_BY_USER_EVENT:i,TAB_MAXIMIZED_BY_USER_EVENT:j,informTabsUpdated:l,subscribeToTabsUpdated:m,minimizeAndInformTabUpdate:n,popOutAndInformTabUpdate:o};}),null);
__d('ConversationNub',['csx','cx','Arbiter','ConversationNubHeader','ConversationNubTabsUpdateEventController','ConversationNubUtils','NotificationUserActions','PinnedConversationNubsConfig','CSS','DOM','EventListener','ConversationNubTabState','SubscriptionsHandler','URI','debounce','guid'],(function a(b,c,d,e,f,g,h,i){'use strict';var j=c('ConversationNubTabsUpdateEventController').minimizeAndInformTabUpdate,k=c('ConversationNubTabsUpdateEventController').popOutAndInformTabUpdate,l=c('ConversationNubTabState'),m=10,n=500,o=100;p.createDefaultState=function(q,r,s,t,u,v){return {tabID:q,permalinkURI:r?new (c('URI'))(r):null,ftID:s,notifAlertID:t,title:u,keepAtBottom:false,isTabRaised:false,isBlinkingUnread:false,badgeCount:0,shouldShowNux:v===true,allSeenNewComments:{},unseenCommentsSinceLastCleared:{},hasFakeInitBadge:false};};function p(q,r,s){this.$ConversationNub1=q;this.$ConversationNub10=r;this.$ConversationNub5=c('guid')();this.$ConversationNub7=null;this.$ConversationNub8=false;this.$ConversationNub9=null;this.$ConversationNub6=new (c('SubscriptionsHandler'))();this.$ConversationNub11();this.$ConversationNub12();if(s!=null)l.modifyTabState(this.$ConversationNub10,function(t){if(s){t.hasFakeInitBadge=false;}else{t.hasFakeInitBadge=true;this.$ConversationNub13(1);this.$ConversationNub14(true);}}.bind(this));this.$ConversationNub15();}p.prototype.$ConversationNub15=function(){this.$ConversationNub16();this.$ConversationNub17();c('ConversationNubUtils').informShouldRecheckTabVisibility(this);this.forceReflow();};p.prototype.getPersistentState=function(){return l.getTabState(this.$ConversationNub10);};p.prototype.$ConversationNub11=function(){var q=this.$ConversationNub18();if(q){this.$ConversationNub6.addSubscriptions(c('EventListener').listen(q,'click',this.$ConversationNub19.bind(this)),c('EventListener').listen(q,'mouseenter',this.$ConversationNub20.bind(this)),c('EventListener').listen(q,'mouseleave',this.$ConversationNub21.bind(this)));var r=c('ConversationNubUtils').getCloseButtonElem(q);if(r)c('ConversationNubUtils').addCloseButtonListeners(r,this.$ConversationNub6,this.$ConversationNub22.bind(this));}var s=this.$ConversationNub23();if(s){l.modifyTabState(this.$ConversationNub10,function(u){u.keepAtBottom=true;});this.$ConversationNub6.addSubscriptions(c('EventListener').listen(s,'scroll',c('debounce')(this.$ConversationNub24.bind(this),o)),c('Arbiter').subscribe('reflow',this.$ConversationNub25.bind(this)));}var t=this.$ConversationNub26();if(t)this.$ConversationNub6.addSubscriptions(c('EventListener').listen(t,'focusin',this.$ConversationNub27.bind(this)));};p.prototype.$ConversationNub12=function(){var q=this.$ConversationNub28();if(!q){this.$ConversationNub2=null;return;}var r=function(){var t=this.getPersistentState();return {permalinkURI:t.permalinkURI,ftID:t.ftID,tabID:t.tabID};}.bind(this),s=new (c('ConversationNubHeader'))(q,r);this.$ConversationNub6.addSubscriptions(s.subscribe('closeButton',this.$ConversationNub22.bind(this)),s.subscribe('showMenu',this.$ConversationNub29.bind(this)),s.subscribe('hideMenu',this.$ConversationNub30.bind(this)),s.subscribe('minimizeButton',this.$ConversationNub31.bind(this,true)),s.subscribe('clickHeader',this.$ConversationNub31.bind(this,true)),s.subscribe('menuPermalinkClick',this.$ConversationNub31.bind(this,false)));this.$ConversationNub2=s;};p.prototype.$ConversationNub28=function(){return this.$ConversationNub1&&c('DOM').scry(this.$ConversationNub1,".fbNubFlyoutTitlebar")[0];};p.prototype.$ConversationNub18=function(){return this.$ConversationNub1&&c('DOM').scry(this.$ConversationNub1,".fbNubButton")[0];};p.prototype.$ConversationNub23=function(){if(!this.$ConversationNub3&&this.$ConversationNub1)this.$ConversationNub3=c('DOM').scry(this.$ConversationNub1,".uiScrollableAreaWrap")[0];return this.$ConversationNub3;};p.prototype.$ConversationNub26=function(){if(!this.$ConversationNub4&&this.$ConversationNub1)this.$ConversationNub4=c('DOM').scry(this.$ConversationNub1,".fbNubFlyoutBodyContent")[0];return this.$ConversationNub4;};p.prototype.$ConversationNub32=function(){var q=this.$ConversationNub18();if(q)return c('DOM').scry(q,"._37op")[0];return null;};p.prototype.$ConversationNub22=function(){c('ConversationNubUtils').informShouldCloseTab(this.$ConversationNub10,c('ConversationNubUtils').CLOSE_REASON_TAB_X_OUT);};p.prototype.$ConversationNub31=function(q){j(this,q);};p.prototype.$ConversationNub29=function(){this.$ConversationNub1&&c('CSS').addClass(this.$ConversationNub1,"_1uw3");};p.prototype.$ConversationNub30=function(){this.$ConversationNub1&&c('CSS').removeClass(this.$ConversationNub1,"_1uw3");};p.prototype.$ConversationNub19=function(){if(this.getPersistentState().isTabRaised){j(this,true);}else k(this,true);};p.prototype.$ConversationNub20=function(){if(this.getPersistentState().isBlinkingUnread)this.$ConversationNub9=new Date();};p.prototype.$ConversationNub21=function(){var q=this.$ConversationNub9;if(q&&this.getPersistentState().isBlinkingUnread){var r=new Date();if(r-q>=n)this.$ConversationNub14(false);}this.$ConversationNub9=null;};p.prototype.$ConversationNub33=function(){var q=this.$ConversationNub23();if(q){var r=q.scrollHeight;if(r>0&&!this.$ConversationNub34(q)){this.$ConversationNub8=true;q.scrollTop=r;}}};p.prototype.$ConversationNub34=function(q){q=q||this.$ConversationNub23();return !!(q&&q.scrollTop>=q.scrollHeight-q.clientHeight-m);};p.prototype.$ConversationNub24=function(){if(!this.getPersistentState().isTabRaised)return;l.modifyTabState(this.$ConversationNub10,function(q){q.keepAtBottom=this.$ConversationNub34();c('ConversationNubUtils').informShouldRecheckTabVisibility(this);}.bind(this));if(!this.$ConversationNub8)this.clearJewelNotifications();this.$ConversationNub8=false;};p.prototype.$ConversationNub27=function(){this.clearJewelNotifications();};p.prototype.$ConversationNub25=function(){var q=this.getPersistentState();if(!q.isTabRaised)return;if(q.keepAtBottom){this.$ConversationNub33();this.$ConversationNub7&&clearTimeout(this.$ConversationNub7);this.$ConversationNub7=setTimeout(function(){if(q.keepAtBottom)this.$ConversationNub33();}.bind(this),100);}};p.prototype.$ConversationNub13=function(q){l.modifyTabState(this.$ConversationNub10,function(r){r.badgeCount=q;this.$ConversationNub16();}.bind(this));};p.prototype.$ConversationNub14=function(q){l.modifyTabState(this.$ConversationNub10,function(r){r.isBlinkingUnread=q;this.$ConversationNub17();}.bind(this));};p.prototype.$ConversationNub16=function(){var q=this.$ConversationNub32();if(!q)return;var r=this.getPersistentState().badgeCount,s=r>0;if(s){c('DOM').setContent(q,r);c('CSS').show(q);}else{c('CSS').hide(q);c('DOM').setContent(q,r);}};p.prototype.$ConversationNub17=function(){if(this.$ConversationNub1){var q=this.getPersistentState().isBlinkingUnread;c('CSS').conditionClass(this.$ConversationNub1,"_53tf",q);}};p.prototype.getRootDOM=function(){return this.$ConversationNub1;};p.prototype.getShouldShowNux=function(){return this.getPersistentState().shouldShowNux;};p.prototype.getTabID=function(){return this.$ConversationNub10;};p.prototype.getNotificationAlertID=function(){return this.getPersistentState().notifAlertID;};p.prototype.getFeedbackTargetID=function(){return this.getPersistentState().ftID;};p.prototype.getPermalinkURI=function(){return this.getPersistentState().permalinkURI;};p.prototype.getTitle=function(){return this.getPersistentState().title;};p.prototype.getBadgeCount=function(){return this.getPersistentState().badgeCount;};p.prototype.getIsRaised=function(){return this.getPersistentState().isTabRaised;};p.prototype.getSessionID=function(){return this.$ConversationNub5;};p.prototype.markCommentsAsSeenWithoutBadging=function(q){l.modifyTabState(this.$ConversationNub10,function(r){q.forEach(function(s){r.allSeenNewComments[s]=true;});});};p.prototype.attemptAddNewCommentsToBadge=function(q){l.modifyTabState(this.$ConversationNub10,function(r){q.forEach(function(u){if(r.allSeenNewComments[u])return;r.allSeenNewComments[u]=true;r.unseenCommentsSinceLastCleared[u]=true;});var s=Object.keys(r.unseenCommentsSinceLastCleared).length;if(r.hasFakeInitBadge)s+=1;var t=r.badgeCount;this.$ConversationNub13(s);this.$ConversationNub14(s>0&&s>t);}.bind(this));};p.prototype.clearBadge=function(){l.clearTabNotifications(this.$ConversationNub10);this.$ConversationNub16();this.$ConversationNub17();};p.prototype.clearJewelNotifications=function(){if(c('PinnedConversationNubsConfig').sharedNotificationsReadStateEnabled){var q=this.getNotificationAlertID();if(q)c('NotificationUserActions').markNotificationsAsRead([q]);}};p.prototype.popOutAndInformTabUpdate=function(){this.popOut();c('ConversationNubTabsUpdateEventController').informTabsUpdated();};p.prototype.popOut=function(){l.modifyTabState(this.$ConversationNub10,function(q){if(this.$ConversationNub1)c('CSS').addClass(this.$ConversationNub1,"_5r93");q.isTabRaised=true;this.clearBadge();if(q.keepAtBottom)this.$ConversationNub33();}.bind(this));};p.prototype.minimize=function(){l.modifyTabState(this.$ConversationNub10,function(q){if(this.$ConversationNub1)c('CSS').removeClass(this.$ConversationNub1,"_5r93");q.isTabRaised=false;this.$ConversationNub2&&this.$ConversationNub2.hideMenu();this.clearBadge();}.bind(this));};p.prototype.forceReflow=function(){this.$ConversationNub25();};p.prototype.destroy=function(){this.minimize();this.$ConversationNub6.release();this.$ConversationNub2&&this.$ConversationNub2.destroy();this.$ConversationNub2=null;this.$ConversationNub7&&clearTimeout(this.$ConversationNub7);if(this.$ConversationNub1){c('DOM').remove(this.$ConversationNub1);c('Arbiter').inform('ConversationNub/destroy',{root:this.$ConversationNub1});this.$ConversationNub1=null;}};f.exports=p;}),null);
__d('ConversationNubHeader',['csx','ArbiterMixin','Bootloader','ConversationNubUtils','DOM','Event','EventListener','Keys','SubscriptionsHandler','ifRequired','mixin'],(function a(b,c,d,e,f,g,h){'use strict';var i,j;function k(m,n){return c('EventListener').listen(m,'keydown',function(o){if(c('Event').getKeyCode(o)===c('Keys').RETURN)n(o);});}i=babelHelpers.inherits(l,c('mixin')(c('ArbiterMixin')));j=i&&i.prototype;function l(m,n){j.constructor.call(this);this.$ConversationNubHeader1=m;this.$ConversationNubHeader3=n;this.$ConversationNubHeader4=null;this.$ConversationNubHeader5=false;this.$ConversationNubHeader2=new (c('SubscriptionsHandler'))();this.$ConversationNubHeader6();}l.prototype.$ConversationNubHeader6=function(){var m=this.$ConversationNubHeader1;this.$ConversationNubHeader2.addSubscriptions(c('EventListener').listen(m,'click',this.$ConversationNubHeader7.bind(this)));var n=c('ConversationNubUtils').getCloseButtonElem(m);if(n)c('ConversationNubUtils').addCloseButtonListeners(n,this.$ConversationNubHeader2,this.$ConversationNubHeader8.bind(this));var o=this.$ConversationNubHeader9();if(o)this.$ConversationNubHeader2.addSubscriptions(c('EventListener').listen(o,'click',this.$ConversationNubHeader10.bind(this)),k(o,this.$ConversationNubHeader10.bind(this)));var p=this.$ConversationNubHeader11();if(p)this.$ConversationNubHeader2.addSubscriptions(c('EventListener').listen(p,'click',this.$ConversationNubHeader12.bind(this)),c('EventListener').listen(p,'mouseover',this.$ConversationNubHeader13.bind(this)),c('EventListener').listen(p,'focus',this.$ConversationNubHeader14.bind(this)),k(p,this.$ConversationNubHeader15.bind(this)));};l.prototype.$ConversationNubHeader11=function(){return c('DOM').scry(this.$ConversationNubHeader1,"._1rf1")[0];};l.prototype.$ConversationNubHeader9=function(){return c('DOM').scry(this.$ConversationNubHeader1,"._4a56")[0];};l.prototype.$ConversationNubHeader16=function(){return c('ConversationNubUtils').getCloseButtonElem(this.$ConversationNubHeader1);};l.prototype.$ConversationNubHeader8=function(){this.inform('closeButton');};l.prototype.$ConversationNubHeader10=function(m){if(m.type==='click')m.kill();this.inform('minimizeButton');};l.prototype.$ConversationNubHeader7=function(){this.inform('clickHeader');};l.prototype.$ConversationNubHeader17=function(){this.inform('showMenu');};l.prototype.$ConversationNubHeader18=function(){this.inform('hideMenu');var m=this.$ConversationNubHeader11();m&&m.blur();};l.prototype.$ConversationNubHeader19=function(){this.inform('menuPermalinkClick');};l.prototype.$ConversationNubHeader20=function(m){if(this.$ConversationNubHeader4)return;var n=this.$ConversationNubHeader11();if(!n)return;if(m)this.$ConversationNubHeader5=true;c('Bootloader').loadModules(["React","ReactDOM","ConversationNubHeaderMenu.react"],function(o,p,q){var r=babelHelpers['extends']({},this.$ConversationNubHeader3(),{onMenuShow:this.$ConversationNubHeader17.bind(this),onMenuHide:this.$ConversationNubHeader18.bind(this),onPermalinkClick:this.$ConversationNubHeader19.bind(this),showOnMount:this.$ConversationNubHeader5});this.$ConversationNubHeader4=p.render(o.createElement(q,r),n);}.bind(this),'ConversationNubHeader');};l.prototype.$ConversationNubHeader12=function(m){m.kill();this.$ConversationNubHeader20(true);};l.prototype.$ConversationNubHeader13=function(){this.$ConversationNubHeader20(false);};l.prototype.$ConversationNubHeader14=function(){this.$ConversationNubHeader20(false);};l.prototype.$ConversationNubHeader15=function(){if(this.$ConversationNubHeader4){this.$ConversationNubHeader4.toggle();}else this.$ConversationNubHeader20(true);};l.prototype.hideMenu=function(){this.$ConversationNubHeader4&&this.$ConversationNubHeader4.hide();};l.prototype.destroy=function(){var m=this.$ConversationNubHeader11();if(m&&this.$ConversationNubHeader4)c('ifRequired')('ReactDOM',function(n){n.unmountComponentAtNode(m);});this.$ConversationNubHeader2.release();};f.exports=l;}),null);
__d('PersistedStore',['invariant','WebStorage','areEqual','deepFreezeValue'],(function a(b,c,d,e,f,g,h){'use strict';function i(j){var k=j.initialValue,l=j.storageKeyPrefix,m=j.serializer,n=j.deserializer,o=j.onDataUpdatedOutOfBand,p=j.enablePersistence,q=p===undefined?true:p;this.$PersistedStore2=null;this.$PersistedStore3=null;this.$PersistedStore5=0;if(q)this.$PersistedStore7=c('WebStorage').getLocalStorage();this.$PersistedStore1=k;this.$PersistedStore4=l;this.$PersistedStore6=l+'.PersistedStoreMetadata';this.$PersistedStore8=m;this.$PersistedStore9=n;this.$PersistedStore10=o;this.reloadFromStorageIfNecessary();}i.prototype.$PersistedStore11=function(j){var k=JSON.stringify(this.$PersistedStore8(j));return this.$PersistedStore9(JSON.parse(k));};i.prototype.$PersistedStore12=function(){return this.$PersistedStore11(this.$PersistedStore1);};i.prototype.isPersisted=function(){return this.$PersistedStore7!=null;};i.prototype.modify=function(j){this.$PersistedStore3=null;if(!this.isPersisted()){this.$PersistedStore1=j(this.$PersistedStore1);}else if(this.$PersistedStore2){this.$PersistedStore2=j(this.$PersistedStore2);}else{var k=void 0;try{this.$PersistedStore2=this.$PersistedStore12();k=j(this.$PersistedStore2);}finally{this.$PersistedStore2=null;}if(k&&!c('areEqual')(this.$PersistedStore1,k)){this.$PersistedStore1=k;this.$PersistedStore13();}}};i.prototype.getData=function(){if(!this.isPersisted()){return this.$PersistedStore1;}else if(this.$PersistedStore3)return this.$PersistedStore3;var j=void 0;if(this.$PersistedStore2){j=this.$PersistedStore11(this.$PersistedStore2);c('deepFreezeValue')(j);}else{j=this.$PersistedStore12();c('deepFreezeValue')(j);this.$PersistedStore3=j;}return j;};i.prototype.$PersistedStore14=function(j){if(this.$PersistedStore7!=null)if(j>i.VERSION){this.$PersistedStore7=null;}else if(j<i.VERSION){this.$PersistedStore7.removeItem(this.$PersistedStore6);this.$PersistedStore7.removeItem(this.$PersistedStore4);}else return true;return false;};i.prototype.$PersistedStore15=function(){try{if(this.$PersistedStore7!=null){var k=this.$PersistedStore7.getItem(this.$PersistedStore6);if(k!=null){var l=JSON.parse(k),m=Number.parseInt(l.highWaterMark,10),n=Number.parseInt(l.version,10);if(m&&n)return {highWaterMark:m,version:n};}}}catch(j){this.$PersistedStore7=null;}return null;};i.prototype.reloadFromStorageIfNecessary=function(){if(!this.isPersisted())return;var j=this.$PersistedStore15();if(j){var k=j.highWaterMark,l=j.version;if(this.$PersistedStore14(l)&&this.$PersistedStore5<k)this.$PersistedStore16(k);}};i.prototype.$PersistedStore16=function(j){var k=this.$PersistedStore17();if(k)this.$PersistedStore18(k,j);};i.prototype.$PersistedStore17=function(){var j=null;try{if(this.$PersistedStore7){var l=this.$PersistedStore7.getItem(this.$PersistedStore4);if(l!=null)j=JSON.parse(l);}}catch(k){this.$PersistedStore7=null;}return j;};i.prototype.$PersistedStore18=function(j,k){this.$PersistedStore3=null;var l=this.$PersistedStore9(j),m=this.$PersistedStore1;this.$PersistedStore1=l;this.$PersistedStore5=k;this.$PersistedStore10(m,l);};i.prototype.$PersistedStore13=function(){this.reloadFromStorageIfNecessary();if(!this.isPersisted())return;var j=this.$PersistedStore8(this.$PersistedStore1),k=JSON.stringify(j),l={highWaterMark:++this.$PersistedStore5,version:i.VERSION},m=JSON.stringify(l);try{this.$PersistedStore7!=null||h(0);this.$PersistedStore7.setItem(this.$PersistedStore6,m);this.$PersistedStore7.setItem(this.$PersistedStore4,k);}catch(n){this.$PersistedStore7=null;}};i.VERSION=24;f.exports=i;}),null);
__d('filterSet',['Set'],(function a(b,c,d,e,f,g){'use strict';function h(i,j){var k=new (c('Set'))();for(var l=i,m=Array.isArray(l),n=0,l=m?l:l[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var o;if(m){if(n>=l.length)break;o=l[n++];}else{n=l.next();if(n.done)break;o=n.value;}var p=o;if(j(p))k.add(p);}return k;}f.exports=h;}),null);
__d('differenceSets',['filterSet'],(function a(b,c,d,e,f,g){'use strict';function h(i){for(var j=arguments.length,k=Array(j>1?j-1:0),l=1;l<j;l++)k[l-1]=arguments[l];return c('filterSet')(i,function(m){return !k.some(function(n){return n.has(m);});});}f.exports=h;}),null);
__d('ConversationNubTabStateList',['invariant','PersistedStore','PinnedConversationNubsConfig','Set','URI','differenceSets'],(function a(b,c,d,e,f,g,h){'use strict';function i(){this.$ConversationNubTabStateList2=new (c('Set'))();this.$ConversationNubTabStateList1=new (c('PersistedStore'))({initialValue:[],storageKeyPrefix:'conversationNubTabState',serializer:i.serializeStateArrayToJson,deserializer:i.deserializeJsonToStateArray,onDataUpdatedOutOfBand:this.$ConversationNubTabStateList3.bind(this),enablePersistence:c('PinnedConversationNubsConfig').persistenceEnabled});}i.prototype.modifyTabState=function(j,k){this.modifyTabs(function(l){var m=l.findIndex(function(n){return n.tabID===j;});m!==-1||h(0);k(l[m]);return l;});};i.prototype.$ConversationNubTabStateList4=function(j){return new (c('Set'))(j.map(function(k){return k.tabID;}));};i.prototype.modifyTabs=function(j){try{this.$ConversationNubTabStateList1.modify(function(k){var l=this.$ConversationNubTabStateList4(k),m=j(k),n=this.$ConversationNubTabStateList4(m);this.$ConversationNubTabStateList2=c('differenceSets')(l,n);return m;}.bind(this));}finally{this.$ConversationNubTabStateList2=new (c('Set'))();}};i.prototype.getTabs=function(){return this.$ConversationNubTabStateList1.getData();};i.prototype.getTabState=function(j){var k=this.getTabStateIfExists(j);k||h(0);return k;};i.prototype.getTabStateIfExists=function(j){return this.getTabs().find(function(k){return k.tabID===j;});};i.prototype.$ConversationNubTabStateList3=function(j,k){var l=j.length!==0,m=this.$ConversationNubTabStateList2.size!==0;if(l||m)this.modifyTabs(function(n){var o=this.$ConversationNubTabStateList4(k),p=this.$ConversationNubTabStateList4(j),q=this.$ConversationNubTabStateList2,r=c('differenceSets')(o,p,q),s=k.filter(function(t){return r.has(t.tabID);});return j.concat(s);}.bind(this));};i.prototype.reloadFromStorageIfNecessary=function(){var j;(j=this.$ConversationNubTabStateList1).reloadFromStorageIfNecessary.apply(j,arguments);};i.serializeStateArrayToJson=function(j){var k=[];if(Array.isArray(j))k=j.map(i.serializeStateToJson).filter(Boolean);return k;};i.serializeStateToJson=function(j){var k=j.permalinkURI?j.permalinkURI.toString():null,l=babelHelpers['extends']({},j,{permalinkURI:k});return l;};i.deserializeJsonToStateArray=function(j){if(Array.isArray(j)){return j.map(i.deserializeJsonToState).filter(Boolean);}else return [];};i.deserializeJsonToState=function(j){if(j!=null&&typeof j.tabID==='string'&&typeof j.ftID==='string'&&typeof j.title==='string'&&typeof j.keepAtBottom==='boolean'&&typeof j.isTabRaised==='boolean'&&typeof j.isBlinkingUnread==='boolean'&&j.allSeenNewComments!=null&&j.allSeenNewComments instanceof Object&&j.unseenCommentsSinceLastCleared!=null&&j.unseenCommentsSinceLastCleared instanceof Object&&typeof j.hasFakeInitBadge==='boolean'&&typeof j.badgeCount==='number'&&typeof j.shouldShowNux==='boolean'&&(j.permalinkURI==null||typeof j.permalinkURI==='string')&&(j.notifAlertID==null||typeof j.notifAlertID==='string')){var k=j.permalinkURI?new (c('URI'))(j.permalinkURI):null,l={tabID:j.tabID,ftID:j.ftID,notifAlertID:j.notifAlertID,title:j.title,keepAtBottom:j.keepAtBottom,isTabRaised:j.isTabRaised,isBlinkingUnread:j.isBlinkingUnread,allSeenNewComments:j.allSeenNewComments,unseenCommentsSinceLastCleared:j.unseenCommentsSinceLastCleared,hasFakeInitBadge:j.hasFakeInitBadge,badgeCount:j.badgeCount,shouldShowNux:j.shouldShowNux,permalinkURI:k};return l;}else return null;};i.prototype.push=function(){for(var j=arguments.length,k=Array(j),l=0;l<j;l++)k[l]=arguments[l];this.modifyTabs(function(m){k.forEach(function(n){if(m.find(function(o){return o.tabID===n.tabID;})){h(0);}else m.push(n);});return m;});};i.prototype.remove=function(j){this.modifyTabs(function(k){var l=k.findIndex(function(m){return m.tabID===j;});if(l!==-1)k.splice(l,1);return k;});};f.exports=i;}),null);
__d('ConversationNubTabState',['invariant','ConversationNub','ConversationNubTabStateList'],(function a(b,c,d,e,f,g,h){'use strict';function i(){this.$ConversationNubTabStateClass1=Object.create(null);this.$ConversationNubTabStateClass2=new (c('ConversationNubTabStateList'))();this.$ConversationNubTabStateClass3=Infinity;}i.prototype.getTabState=function(j){return this.$ConversationNubTabStateClass2.getTabState(j);};i.prototype.getTabStateIfExists=function(j){return this.$ConversationNubTabStateClass2.getTabStateIfExists(j);};i.prototype.getUnloadedTabs=function(){var j=this.$ConversationNubTabStateClass2.getTabs().filter(function(k){return !this.getLoadedTab(k.tabID);}.bind(this));return j;};i.prototype.setMaxDockTabs=function(j){this.$ConversationNubTabStateClass3=j;};i.prototype.getNumDockTabs=function(){var j=this.$ConversationNubTabStateClass3,k=this.getTotalTabCount();return Math.min(j,k);};i.prototype.getNumMenuTabs=function(){return this.getTotalTabCount()-this.getNumDockTabs();};i.prototype.addTabState=function(j){this.$ConversationNubTabStateClass2.push(j);};i.prototype.addLoadedTab=function(j,k){var l=this.getTabState(j);if(!l)return;var m=this.getLoadedTab(j);if(m)return;this.$ConversationNubTabStateClass1[j]=k;};i.prototype.getLoadedTab=function(j){return this.$ConversationNubTabStateClass1[j];};i.prototype.getLoadedTabByFeedbackTarget=function(j){return this.getLoadedTabs().find(function(k){return k.getPersistentState().ftID===j;});};i.prototype.isTabInDock=function(j){var k=this.getLoadedTab(j);if(!k)return false;var l=this.$ConversationNubTabStateClass4(k);return 0<=l&&l<this.getNumDockTabs();};i.prototype.$ConversationNubTabStateClass4=function(j){return this.getLoadedTabs().indexOf(j);};i.prototype.clearTabNotifications=function(j){this.$ConversationNubTabStateClass2.modifyTabState(j,function(k){k.unseenCommentsSinceLastCleared={};k.hasFakeInitBadge=false;k.badgeCount=0;k.isBlinkingUnread=false;});};i.prototype.deleteTab=function(j){var k=this.getLoadedTab(j);if(k){delete this.$ConversationNubTabStateClass1[j];k.destroy();}this.$ConversationNubTabStateClass2.remove(j);return Boolean(k);};i.prototype.modifyTabState=function(j,k){return this.$ConversationNubTabStateClass2.modifyTabState(j,k);};i.prototype.moveTabToDockLeft=function(j){var k=this.getLoadedTab(j);if(!k)return;this.$ConversationNubTabStateClass2.modifyTabs(function(l){var m=l.findIndex(function(v){return v.tabID===j;});m!==-1||h(0);var n=l[m],o=this.$ConversationNubTabStateClass4(k),p=this.getLoadedTabs().length,q=this.getNumDockTabs();if(o<0||p===0){return l;}else if(q===0){if(o!==0){l.splice(m,1);l.unshift(n);}return l;}var r=q-1;if(o===r)return l;l.splice(m,1);if(o<r)r-=1;var s=this.getLoadedTabs()[r],t=this.getTabState(s.getTabID());t||h(0);var u=l.findIndex(function(v){return v.tabID===t.tabID;});l.splice(u,0,n);return l;}.bind(this));};i.prototype.getLoadedTabs=function(){var j=this.$ConversationNubTabStateClass2.getTabs().map(function(k){return this.getLoadedTab(k.tabID);}.bind(this)).filter(Boolean);return j;};i.prototype.getUnsortedLoadedTabs=function(){var j=Object.values(this.$ConversationNubTabStateClass1);return j;};i.prototype.getTotalTabCount=function(){return this.getUnsortedLoadedTabs().length;};i.prototype.getTabsForDockOldestFirst=function(){return this.getLoadedTabs().slice(0,this.getNumDockTabs());};i.prototype.getTabsForDockNewestFirst=function(){return this.getTabsForDockOldestFirst().slice().reverse();};i.prototype.getTabsForMenu=function(){return this.getLoadedTabs().slice(this.getNumDockTabs()).reverse();};f.exports=new i();}),null);
__d("XConversationNubTogglePinController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/ajax\/conversation\/nub_story\/toggle_pin\/",{ft_id:{type:"String"},pin:{type:"Bool",defaultValue:false},with_render:{type:"Bool",defaultValue:false},notif_setting:{type:"Enum",enumType:1}});}),null);
__d("XConversationsToggleController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/ajax\/conversation\/toggle_feature\/",{turn_conversations_on:{type:"Bool",defaultValue:false}});}),null);
__d('ConversationNubUtils',['csx','Arbiter','AsyncFeature','AsyncRequest','DOM','Event','EventListener','ConversationNubTabState','Keys','XConversationNubTogglePinController','XConversationsToggleController'],(function a(b,c,d,e,f,g,h){'use strict';var i=c('ConversationNubTabState'),j={DISABLE:'disable',ENABLE:'enable'},k='ConversationNubUtils/closeTab',l='ConversationNubUtils/unpinnedFromHeader',m='ConversationNubUtils/recheckTabVisibility',n='ConversationNubUtils/openPermalinkFromHeader',o='ConversationNubUtils/turnOff',p='ConversationNubUtils/turnOn',q='tab-x-out',r='overflow-x-out',s='unpin';function t(ma){var na=Object.values(j);return na.find(function(oa){return oa===ma;})||null;}function u(ma,na,oa,pa){var qa=pa||{},ra=qa.notif_setting,sa=c('XConversationNubTogglePinController').getURIBuilder().setString('ft_id',String(ma)).setBool('pin',na);if(ra&&c('AsyncFeature').__serverHasFeatureImpl(3))sa.setEnum('notif_setting',ra);var ta=sa.getURI(),ua=new (c('AsyncRequest'))().setURI(ta).setMethod('POST');if(oa)ua.setAllowCrossPageTransition(true);ua.send();}function v(ma){var na=c('XConversationsToggleController').getURIBuilder().setBool('turn_conversations_on',ma).getURI();ma?la():ka();var oa=new (c('AsyncRequest'))().setURI(na).setAllowCrossPageTransition(true).setHandler(function(pa){if(pa.getPayload().conversationsStatus){la();}else ka();}).setErrorHandler(function(pa){ma?ka():la();}).setMethod('POST');oa.send();}function w(ma,na,oa){u(ma,true,na,oa);}function x(ma,na,oa){u(ma,false,na,oa);}function y(ma,na){w(ma,false,na);}function z(ma,na){x(ma,false,na);}function aa(ma,na){w(ma,true,na);}function ba(ma,na){x(ma,true,na);}function ca(){v(false);}function da(){v(true);}function ea(ma){return c('DOM').scry(ma,"._4iz6")[0];}function fa(ma,na,oa){var pa=function qa(){oa();};na.addSubscriptions(c('EventListener').listen(ma,'click',pa),c('EventListener').listen(ma,'keydown',function(qa){if(c('Event').getKeyCode(qa)===c('Keys').RETURN)pa();}));}function ga(ma,na){var oa=i.getLoadedTab(ma);if(!oa)return;var pa=oa.getPersistentState(),qa=oa.getSessionID();c('Arbiter').inform(k,{tabID:ma,tabState:pa,sessionID:qa,reason:na});}function ha(ma){var na=i.getLoadedTab(ma);if(!na)return;c('Arbiter').inform(l,{tab:na});}function ia(ma){c('Arbiter').inform(m,{tab:ma});}function ja(ma){var na=i.getLoadedTab(ma);if(!na)return;c('Arbiter').inform(n,{tab:na});}function ka(){c('Arbiter').inform(o,{});}function la(){c('Arbiter').inform(p,{});}f.exports={CLOSE_TAB_EVENT:k,UNPIN_FROM_HEADER_EVENT:l,OPEN_PERMALINK_FROM_HEADER_EVENT:n,TURN_CONVERSATIONS_OFF_EVENT:o,TURN_CONVERSATIONS_ON_EVENT:p,CLOSE_REASON_TAB_X_OUT:q,CLOSE_REASON_OVERFLOW_X_OUT:r,CLOSE_REASON_UNPIN:s,coerceToPinRequestNotifSetting:t,sendPinRequest:y,sendUnpinRequest:z,sendPinRequestAcrossTransitions:aa,sendUnpinRequestAcrossTransitions:ba,getCloseButtonElem:ea,addCloseButtonListeners:fa,informShouldCloseTab:ga,informDidUnpinFromHeaderMenu:ha,informShouldRecheckTabVisibility:ia,informOpenPermalinkFromHeader:ja,turnConversationsOff:ca,turnConversationsOn:da};}),null);
__d('ConversationNubPermalinkUtils',['URI','isFacebookURI'],(function a(b,c,d,e,f,g){'use strict';function h(l){return l.substr(-1)==='/'?l.slice(0,-1):l;}function i(l,m){var n=l.getPath(),o=m.getPath();return h(n)===h(o);}function j(l,m,n){var o=l.getQueryData(),p=m.getQueryData(),q=o[n],r=p[n];if(q==null&&r==null)return true;return q===r;}function k(l){var m=new (c('URI'))(window.location.href);return (m&&l&&c('isFacebookURI')(m)&&c('isFacebookURI')(l)&&i(m,l)&&j(m,l,'fbid')&&j(m,l,'story_fbid'));}f.exports={isOnPermalink:k};}),null);
__d('ConversationNubViewportManager',['DockTabsViewportCalculator','DockTabsViewportPinnedConversationTabUtils'],(function a(b,c,d,e,f,g){'use strict';var h=c('DockTabsViewportPinnedConversationTabUtils').getMinRequiredWidthForFirstConvoTab;function i(j,k,l){this.$ConversationNubViewportManager1=j;this.$ConversationNubViewportManager3=k;this.$ConversationNubViewportManager2=c('DockTabsViewportCalculator').getInstance(this.$ConversationNubViewportManager1);this.$ConversationNubViewportManager2&&this.$ConversationNubViewportManager2.registerPinnedConvoTabCallbacks(babelHelpers['extends']({},l,{pinnedConvoTabStateGetter:function(){return this.$ConversationNubViewportManager3;}.bind(this)}));}i.prototype.getNumDockTabsToShow=function(j){return this.getCouldFitAtLeastOneDockTab(j)?1:0;};i.prototype.getCouldFitAtLeastOneDockTab=function(j){var k=h();return k<=j;};i.prototype.forceRecalculatePinnedConvoTabs=function(j){this.$ConversationNubViewportManager2&&this.$ConversationNubViewportManager2.forceRecalculatePinnedConvoTabs(j);};f.exports=i;}),null);
__d('ConversationNubVisibilityDedupeUtils',['Bootloader','emptyFunction','ifRequired'],(function a(b,c,d,e,f,g){'use strict';function h(j){c('Bootloader').loadModules(["UFICommentVisibilityStore"],j,'ConversationNubVisibilityDedupeUtils');}function i(j){return c('ifRequired')('UFICommentVisibilityStore',function(k){return (k.isFeedbackTargetVisible(j));},c('emptyFunction').thatReturnsFalse);}f.exports={bootloadUFIVisibilityModule:h,isFeedbackTargetVisible:i};}),null);
__d("XNotificationNubStoryController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/conversation\/nub_story\/",{notif_alert_id:{type:"String"},notif_id:{type:"Int"},ft_id:{type:"String"},force_minimized:{type:"Bool",defaultValue:false}});}),null);
__d('NotificationConversationController',['csx','cx','Arbiter','AsyncRequest','Bootloader','ConversationNub','ConversationNubTabsUpdateEventController','ConversationNubPermalinkUtils','ConversationNubUtils','ConversationNubViewportManager','ConversationNubVisibilityDedupeUtils','CSS','DOM','ConversationNubTabState','NotificationConstants','NotificationUpdates','PinnedConversationNubsConfig','SubscriptionsHandler','URI','XNotificationNubStoryController','ge','ifRequired'],(function a(b,c,d,e,f,g,h,i){'use strict';var j=c('NotificationConstants').PayloadSourceType,k=j.LIVE_SEND,l=j.OTHER_APPLICATION,m=c('ConversationNubVisibilityDedupeUtils').bootloadUFIVisibilityModule,n=c('ConversationNubVisibilityDedupeUtils').isFeedbackTargetVisible,o=1,p=c('ConversationNubTabState'),q=Object.create(null),r=null,s=null,t=null,u=null,v=null,w=null,x=false,y=null,z=null,aa=null,ba=null,ca=Object.create(null);function da(){if(!s)s=c('DOM').scry(c('ge')('pagelet_dock'),"._1mw-")[0];return s;}function ea(){if(!t){var ha=da();if(ha)t=c('DOM').scry(ha,"._1tvj")[0];}return t;}function fa(){if(!u){var ha=da();if(ha)u=c('DOM').scry(ha,"._2ikx .fbNubButton")[0];}return u;}ga.prototype.init=function(){if(x)return;x=true;this.$NotificationConversationController1();var ha='update-notifications',ia=new (c('SubscriptionsHandler'))();ia.addSubscriptions(c('NotificationUpdates').subscribe(ha,function(ja,ka){if(c('PinnedConversationNubsConfig').sharedNotificationsReadStateEnabled&&ka.payloadsource===k&&ka.readState&&Object.keys(ka.readState).length){this.$NotificationConversationController2(ka.readState);}else if(ka.payloadsource===k||ka.payloadsource===l){var la=ka.nodes;if(la&&la.length)this.$NotificationConversationController3(la);}}.bind(this)),c('ConversationNubTabsUpdateEventController').subscribeToTabsUpdated(this.$NotificationConversationController4.bind(this)),c('Arbiter').subscribe(c('ConversationNubUtils').CLOSE_TAB_EVENT,function(ja,ka){var la=ka||{},ma=la.tabID;if(ma)this.$NotificationConversationController5(ma);}.bind(this)));y=ia;if(c('PinnedConversationNubsConfig').markAsReadWhenViewedInFeed)m(function(ja){ia.addSubscriptions(ja.addListener(this.$NotificationConversationController6.bind(this)));}.bind(this));};ga.prototype.$NotificationConversationController1=function(){p.getUnloadedTabs().forEach(function(ha){this.$NotificationConversationController7(ha.tabID,ha.ftID,ha.permalinkURI,'page_refresh');}.bind(this));};ga.prototype.$NotificationConversationController8=function(ha){var ia=r?r.getNumDockTabsToShow(ha):o;p.setMaxDockTabs(ia);};ga.prototype.$NotificationConversationController9=function(ha,ia){this.$NotificationConversationController8(ha);if(ia){var ja=ia.tabToPromote,ka=ia.tabToOpenIfInDock;if(ja&&!p.isTabInDock(ja.getTabID()))p.moveTabToDockLeft(ja.getTabID());if(ka&&p.isTabInDock(ka.getTabID()))ka.popOut();}this.$NotificationConversationController10(ha);};ga.prototype.$NotificationConversationController4=function(ha){r&&r.forceRecalculatePinnedConvoTabs(ha);};ga.prototype.$NotificationConversationController10=function(ha){var ia=p.getTotalTabCount(),ja=p.getNumDockTabs(),ka=r&&r.getCouldFitAtLeastOneDockTab(ha),la=ia>0&&ka,ma=ja<ia&&la,na=da();if(na){c('CSS').conditionClass(na,"_1tvf",la);c('CSS').conditionClass(na,"_1dex",ma);c('CSS').conditionClass(na,"_1tvi",ma);}var oa=c('PinnedConversationNubsConfig').pinnedToLeft?p.getTabsForDockOldestFirst():p.getTabsForDockNewestFirst();oa.forEach(function(qa){if(qa.getIsRaised())qa.clearBadge();});var pa=p.getTabsForMenu();this.$NotificationConversationController11(oa);this.$NotificationConversationController12(pa);};ga.prototype.$NotificationConversationController2=function(ha){p.getUnsortedLoadedTabs().forEach(function(ja){var ka=ja.getNotificationAlertID();if(ha[ka])ja.clearBadge();});p.getUnloadedTabs().forEach(function(ja){if(ha[ja.notifAlertID])p.clearTabNotifications(ja.tabID);});var ia=p.getTabsForMenu();this.$NotificationConversationController12(ia);};ga.prototype.$NotificationConversationController3=function(ha){ha.forEach(function(ia){var ja=ia.alert_id,ka=ia.pinnedConvoConfig,la=ia.tracking;if(!ka)return;var ma=ka.tab_id,na=ka.ft_id,oa=ka.permalink_uri,pa=JSON.parse(la),qa=oa?new (c('URI'))(oa):null;this.$NotificationConversationController13(ma,pa.alert_id,na,ja,qa);}.bind(this));};ga.prototype.$NotificationConversationController13=function(ha,ia,ja,ka,la){var ma=c('XNotificationNubStoryController').getURIBuilder().setString('notif_alert_id',ka).setInt('notif_id',ia);this.$NotificationConversationController14(ja,'notification');this.$NotificationConversationController15(ha,ja,la,ma);};ga.prototype.$NotificationConversationController14=function(ha,ia){if(!ca[ha])ca[ha]=ia;};ga.prototype.$NotificationConversationController7=function(ha,ia,ja,ka){this.$NotificationConversationController14(ia,ka);var la=c('XNotificationNubStoryController').getURIBuilder().setString('ft_id',ia);this.$NotificationConversationController15(ha,ia,ja,la);};ga.prototype.$NotificationConversationController15=function(ha,ia,ja,ka){if(q[ha]||p.getLoadedTab(ha))return;if(c('ConversationNubPermalinkUtils').isOnPermalink(ja)||n(ia))ka.setBool('force_minimized',true);q[ha]=true;new (c('AsyncRequest'))().setURI(ka.getURI()).setAllowCrossPageTransition(true).setFinallyHandler(function(){delete q[ha];}).send();};ga.prototype.$NotificationConversationController6=function(){var ha=false;p.getUnsortedLoadedTabs().forEach(function(ia){if(ia.getBadgeCount()>0&&n(ia.getFeedbackTargetID())){ia.clearBadge();ha=true;}});if(ha)c('ConversationNubTabsUpdateEventController').informTabsUpdated();};ga.prototype.$NotificationConversationController16=function(ha){var ia=true;p.getUnsortedLoadedTabs().forEach(function(ja){var ka=ja.getFeedbackTargetID(),la=ha[ka],ma=la?Object.keys(la):[];if(ma.length){var na=ja.getBadgeCount();if(n(ka)){ja.markCommentsAsSeenWithoutBadging(ma);ja.clearBadge();}else ja.attemptAddNewCommentsToBadge(ma);var oa=ja.getBadgeCount();if(na!==oa)ia=true;}});if(ia)c('ConversationNubTabsUpdateEventController').informTabsUpdated();};ga.prototype.$NotificationConversationController17=function(ha){if(ba)return;c('Bootloader').loadModules(["ConversationNubSurveys"],function(ia){if(!ba)ba=new ia(ha);},'NotificationConversationController');};ga.prototype.$NotificationConversationController18=function(ha,ia,ja){if(aa){aa.addTab(ha,ja);delete ca[ha.getPersistentState().ftID];return;}c('Bootloader').loadModules(["ConversationNubLogger"],function(ka){if(!aa)aa=new ka(ia);aa.addTab(ha,ja);delete ca[ha.getPersistentState().ftID];},'NotificationConversationController');};ga.prototype.$NotificationConversationController19=function(){if(z)return;c('Bootloader').loadModules(["ConversationNubUFICentralUpdateManager"],function(ha){if(z)return;z=new ha(this.$NotificationConversationController16.bind(this));}.bind(this),'NotificationConversationController');};ga.prototype.$NotificationConversationController11=function(ha){var ia=ea();if(!ia)return;c('Bootloader').loadModules(["React","ReactDOM","ConversationNubDockedTabGroup.react"],function(ja,ka,la){w=ka.render(ja.createElement(la,{dockTabs:ha}),ia);},'NotificationConversationController');};ga.prototype.$NotificationConversationController20=function(ha){ha.popOut();c('ConversationNubTabsUpdateEventController').informTabsUpdated({tabToPromote:ha});};ga.prototype.$NotificationConversationController12=function(ha){var ia=fa();if(!ia)return;c('Bootloader').loadModules(["React","ReactDOM","ConversationNubCollapsedSelectorMenu.react"],function(ja,ka,la){v=ka.render(ja.createElement(la,{menuTabs:ha,onTabSelected:this.$NotificationConversationController20.bind(this)}),ia);}.bind(this),'NotificationConversationController');};ga.prototype.$NotificationConversationController21=function(){if(!r){var ha=da();if(ha){var ia={onAvailableWidthChanged:this.$NotificationConversationController9.bind(this)};r=new (c('ConversationNubViewportManager'))(ha,p,ia);}}};ga.prototype.storyFromServer=function(ha,ia){if(!x)return;var ja=ia.tab_id,ka=ia.ft_id,la=ia.notif_alert_id,ma=ia.title,na=ia.permalink_uri,oa=ia.promote_on_init,pa=ia.attempt_open_on_init,qa=ia.init_without_badge,ra=ia.tab_add_source,sa=p.getLoadedTab(ja);if(sa){if(oa||pa)c('ConversationNubTabsUpdateEventController').informTabsUpdated({tabToPromote:oa?sa:null,tabToOpenIfInDock:pa?sa:null});return;}qa=qa||n(ka);var ta=p.getTabStateIfExists(ja);if(ta){qa=null;}else{var ua=c('ConversationNub').createDefaultState(ja,na,ka,la,ma);p.addTabState(ua);}var va=new (c('ConversationNub'))(ha,ja,qa);p.addLoadedTab(ja,va);pa=pa||va.getPersistentState().isTabRaised;this.$NotificationConversationController19();this.$NotificationConversationController21();c('ConversationNubTabsUpdateEventController').informTabsUpdated({tabToPromote:oa?va:null,tabToOpenIfInDock:pa?va:null});this.$NotificationConversationController17(p);var wa=ca[ka]||ra||'unknown';this.$NotificationConversationController18(va,p,wa);};ga.prototype.$NotificationConversationController5=function(ha){var ia=p.deleteTab(ha);if(ia)c('ConversationNubTabsUpdateEventController').informTabsUpdated();};ga.prototype.unsubscribe=function(){y&&y.release();y=null;aa&&aa.destroy();aa=null;ba&&ba.destroy();ba=null;z&&z.destroy();z=null;c('ifRequired')('ReactDOM',function(ha){var ia=fa();if(v&&ia)ha.unmountComponentAtNode(ia);var ja=ea();if(w&&ja)ha.unmountComponentAtNode(ja);});};function ga(){}f.exports=new ga();}),null);